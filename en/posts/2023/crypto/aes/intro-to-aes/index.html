<!doctype html><html lang=en-US><head><meta charset=UTF-8><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="index, follow"><meta name=author content="dilag"><meta name=description content="Introduction au chiffrement AES"><link rel=author type=text/plain href=/humans.txt><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon href=/favicon.ico type=image/x-icon><link rel=icon href=https://dilagluc.github.io/images/favicon.min.svg type=image/svg+xml><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=msapplication-TileImage content="/mstile-144x144.png"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><link rel=mask-icon href=/safari-pinned-tab.svg color=#494f5c><meta itemprop=name content="Chiffrement AES"><meta itemprop=description content="Introduction au chiffrement AES"><meta itemprop=datePublished content="2023-07-09T20:32:54+02:00"><meta itemprop=dateModified content="2023-07-09T20:32:54+02:00"><meta itemprop=wordCount content="6333"><meta itemprop=keywords content="Crypto,Aes"><meta property="og:url" content="https://dilagluc.github.io/en/posts/2023/crypto/aes/intro-to-aes/"><meta property="og:site_name" content="Blog"><meta property="og:title" content="Chiffrement AES"><meta property="og:description" content="Introduction au chiffrement AES"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-09T20:32:54+02:00"><meta property="article:modified_time" content="2023-07-09T20:32:54+02:00"><meta property="article:tag" content="Crypto"><meta property="article:tag" content="Aes"><meta name=twitter:card content="summary"><meta name=twitter:title content="Chiffrement AES"><meta name=twitter:description content="Introduction au chiffrement AES"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Chiffrement AES","name":"Chiffrement AES","description":"Introduction au chiffrement AES","keywords":["crypto","aes"],"articleBody":"AES est un chiffrement par bloc basé sur des opérations matricielles. Il existe plusieurs types d’implémentation, AES-128, AES-256 etc. et également des modes (ECB, CBC, etc.)\nIntroduction AES est un chiffrement par blocs qui peut chiffer et déchiffrer pas moins et pas plus de de 128 bits (16 octets) de message en clair. Le message est donc divisé par bloc de 16 octets. Pour pallier à cette limitation, on utilise un mode d’opération (ECB, CBC, CTR etc.) et du padding. En plus du message en clair de 128 bits, AES utilise également une clé de chiffrement dont la taille peut varier. Ainsi en notant AES-128, on dit indirectement que la clé de chiffrement est de 128 bits. Il existe également AES-192, AES-256 et dont l’implémentation diffère légèrement de l’AES-128. Notre objectif ici sera plutôt de se concentrer sur le cœur du chiffrement AES-128 en lui même et non comment l’utiliser. AES est un chiffrement par blocs qui s’implémente en plusieurs étapes. Bien que nous verront ici comment il fonctionne et comment c’est implémenté, il est fortement déconseillé de faire sa propre implémentation. La raison st toute simple, elle peut être vulnérable. Cela dit, commençons.\n1. Prérequis mathématiques Certaines transformations AES opèrent sur le corps fini \\(GF(2^8)\\). Nous verrons d’abord comment ce corps est construit et quelques une de ces propriétés.\n1.1 Notions d’algèbre Groupes Un ensemble \\(G\\) muni d’une loi interne , notée \\(\\ast\\) par exemple, est appelé un groupe ssi cette loi vérifie les trois axiomes suivants:\n• La loi \\(\\ast\\) est associative sur \\(G\\) i.e. $$ \\forall x, y, z \\in G, x\\ast(y\\ast z) = (x\\ast y)\\ast z$$ • La loi \\(\\ast\\) possède un élément neutre dans \\(G\\) i.e. $$\\exists e \\in G , x\\ast e = e\\ast x = x $$ On dit alors que \\(e\\) est l’élément neutre de \\(G\\)\n• La loi \\(\\ast\\) est symétrique i.e. $$ \\forall x \\in G, \\exists x’ \\in G, x\\ast x’=x’\\ast x=e$$ On dit alors que \\(x'\\) est le symétrique ou l’inverse de \\(x\\) dans \\(G\\).\nUn tel groupe est noté \\((G,\\ast)\\) (on lit \\(G\\) muni de la loi de composition interne \\(\\ast\\) ) ou \\(G\\).\nSi de plus la loi \\(\\ast\\) est commutative c’est-à-dire pour tout \\(x,y \\in G\\) on a \\(x\\ast y = y\\ast x\\) , alors on dit que \\(G\\) est un groupe commutatif ou encore un groupe abélien.\nUn groupe \\(G\\) est dit fini si \\(card(G)\\) est fini où \\(card(G)\\) c’est le nombres d’élements de \\(G\\). Le nombre d’éléments d’un groupe est appelé ordre du groupe.\nUn sous-ensemble \\(H\\) d’un groupe G (\\(H \\subset G\\)) est un sous-groupe s’il est lui-même un groupe pour les opérations de \\(G\\).\nAnneaux Un anneau \\((R,+,\\ast)\\) est un ensemble \\(R\\) munis de deux opérations binaires notées \\(+\\) et \\(\\ast\\) telles que:\n\\((R,+)\\) est un groupe abélien (dont l’identité (ie l’élément neutre) est notée \\(0\\) ou \\(0_R\\)) La loi \\(\\ast\\) est associative sur \\(R\\) Il existe un élément de \\(R\\), noté \\(1\\), ou \\(1_R\\) tel que pour tout \\(a\\) dans R, \\(a\\ast 1=1\\ast a=a\\) La loi \\(\\ast\\) est distributive par rapport à la loi \\(+\\) i.e. \\(a\\ast (b+c) = (a\\ast b)+(a\\ast c) et (b+c)\\ast a = (b\\ast a)+(c\\ast a)\\). L’anneau est commutatif si la loi \\(\\ast\\) est commutative sur \\(R\\). Corps Un corps est un anneau dans lequel tous les éléments non-nuls ont un inverse pour la multiplication.\nAnneaux des polynômes Supposons que \\(R\\) est un anneau commutatif, alors un polynôme en \\(x\\) sur l’anneau \\(R\\) est une expression de la forme: $$ f(x) = a_nx^n + a_{n-1}x^{n-1} + ... + a_1x^1 +a_0$$ Si \\(R\\) est un anneau commutatif, l’anneau des polynômes noté \\(R[x]\\) est l’anneau formé par l’ensemble des polynômes en \\(x\\) à coefficients dans R.\nSoit \\(K\\) un corps et soit \\(f(x)\\) un polynôme dans \\(K[x]\\) de degré au moins 1. On dit que \\(f(x)\\) est irréductible dans \\(K[x]\\) s’il ne peut pas se décomposer en produit de deux polynômes de \\(K[x]\\) dont les degrés sont supérieurs ou égaux à \\(1\\).\nExemple:\nTous les polynômes de degré \\(1\\) sont irréductibles. Par conséquent il y a une infinité de polynômes irréductibles. \\(X^2−1 = (𝑋 − 1)(𝑋 + 1)\\) ∈ \\(\\mathbb{R}[𝑋]\\) est réductible. \\(X^2+1=(X−i)(X+i)\\) est réductible dans \\(\\mathbb{C}[X]\\) mais est irréductible dans \\(\\mathbb{R}[X]\\). \\(𝑋^2−2=(X−\\sqrt{2})(X+\\sqrt{2})\\) est réductible dans \\(\\mathbb{R}[X]\\) mais est irréductible dans \\(\\mathbb{Q}[X]\\) \\(𝐾[𝑥]/𝑓(𝑥)\\) désigne l’ensemble des polynômes de \\(K[x]\\) dont le degré est inférieur ou égal à \\(n=deg(f(x))\\). Les opérations d’addition et de multiplication sont effectuées modulo \\(f(x)\\).\n\\(𝐾[𝑥]/𝑓(𝑥)\\) étant un anneau commutatif, si \\(f(x)\\) est irréductible sur \\(K\\), alors \\(𝐾[𝑥]/𝑓(𝑥)\\) est un corps.\nCorps finis Existence et unicité : si \\(K\\) est un corps fini, alors \\(K\\) contient \\(p^n\\) éléments où \\(p\\) est un nombre premier et \\(n\\) est un entier strictement positif. Pour tout nombre premier \\(p\\) et tout entier \\(n\\), il existe un unique corps fini (à isomorphisme près) de cardinal \\(p^n\\) . Ce corps est noté \\(\\mathbb{F}_{p^n}\\).\n1.2 \\(GF(2^8)\\) \\(GF(2^8)\\) est un corps fini avec 256 éléments, aussi appelé corps de Galois dont les coefficients sont dans \\(F_2\\) et de degré inferieur à 8. Nous pouvons représenter ce corps par l’ensemble:\n$$\\mathbb{F}_{256} \\simeq (\\mathbb{F}_2)^8 \\simeq \\mathbb{F}_2/ (X^8 + X^4 + X^3 + X + 1) $$ $$\\underbrace {(X^8 + X^4 + X^3 + X + 1)}_{m(x)} $$ Le polynôme \\(m(X)\\) est irréductible primitif, ainsi, l’isomorphisme existe bien entre les deux ensembles.\nCet objet mathématique est utilisé pour définir la boîte S ou Sbox dans le chiffrement AES (L’étape ShiftColumns et la matrice utilisé dans l’étape MixColumn) Chaque élément de \\(GF(2^8)\\) est représenté comme: \\(b_7X^7 + b_6X^6 + … + b_1X^1 + b_0\\) Multiplication dans \\(GF(2^8)\\)\nRegardons la multiplication par α. Prenons α, la classe de \\(X\\), on a:\n$$ m(\\alpha) = \\alpha^8 + \\alpha^4 + \\alpha^3 + \\alpha + 1 = 0$$ $$ \\Leftrightarrow$$ $$\\alpha^8 = \\alpha^4 + \\alpha^3 + \\alpha + 1 $$ Ainsi, pour appliquer la multiplication de \\(\\alpha\\) par un polynôme en \\(\\alpha\\), il suffira de\nremplacer le monôme \\(\\alpha^8\\) par \\(\\alpha^4 + \\alpha^3 +\\alpha + 1\\).\n2. AES - Chiffrement 2.1 Etendre la clé (Key Expansion) 2.1.1 Présentation Une des transformations utilisé avec l’AES est de faire un XOR avec des clés. Un algorithme de cadencement de clé calcule à partir de la clé K une suite de sous-clés de tour comportant toutes 16 octets. Avec l’AES-128, on a besoin exactement de générer 11 clés à partir de la clé fourni. Ces clés dérivés de notre clé fournit sont appelées round keys ou subkeys. Le processus de dérivation de clés est appelé key expansion ou key schedule. Le calcul des sous-clés se fait à partir d’une fonction inversible qui prend en entrée une clé \\(K_i\\) et un entier et qui sors une clé \\(K_{i+1}\\) dépendant de \\(K_i\\).\nSoit \\(K_0\\) la clé initiale et \\(K_{i+1}\\) la clé calculée par la fonction avec les paramètres \\(K_i\\) et \\(i\\), \\(K_i;C_j\\) la colonne \\(j\\) de la clé \\(K_i\\) et \\(K'\\_i\\) la copie de la clé \\(K_i\\).\nLa procédure pour calculer \\(K_{i+1}\\) en fonction de \\(K_i\\) est :\nOn effectue une rotation de 1 cran vers le haut de \\(K'_0 ;C_3\\). c’est l’opération RotWord On applique la fonction S-Box (on détaillera dans la suite) sur chaque octets de cette même colonne. C’est l’opération SubWord On calcule un XOR entre la première valeur de la colonne \\(K'_0;C_3\\) et Rcon(i). On détaillera également dans la suite le Rcon(i) On effectue les XOR successifs suivants : \\(K_{i+1};C_0 = K'_i;C_3 \\oplus Ki;C0\\) \\(K_{i+1};C_1 = K'_i;C_0 \\oplus K_i;C_1\\) \\(K_{i+1};C_2 = K'i;C_1 \\oplus K_i;C_2\\) \\(K_{i+1};C_3 = K'_i;C_2 \\oplus K_i;C_3\\)\nEn résumé, 2.1.2 Détails des opérations RotWord Comme son nom l’indique, c’est un décalage circulaire de bas en haut donc il prend une entrée de 4 octets et retourne comme sortie la rotation de ces 4 octets comme ceci.\n$$ \\begin{bmatrix} 00 \\\\\\\\ 01 \\\\\\\\ 02 \\\\\\\\ 03 \\end{bmatrix} \\Leftrightarrow \\begin{bmatrix} 01 \\\\\\\\ 02 \\\\\\\\ 03 \\\\\\\\ 00 \\end{bmatrix}$$ SubWord Cette transformation consiste à associer à chaque octet en entrée, un unique autre byte en utilisant un mapping appelé Sbox.\nCette Sbox s’obtient en :\nPrenant l’inverse multiplicatif de l’octet \\(X\\) dans \\(GF(2^8)\\) Appliquer ensuite une transformation affine sur cet inverse \\(Sbox(X) = Affine(Inverse(X))\\) Cette transformation affine, en forme matricielle s’exprime par: $$ \\begin{bmatrix} b'_0 \\\\\\\\ b'_1 \\\\\\\\ b'_2 \\\\\\\\ b'_3 \\\\\\\\ b'_4 \\\\\\\\ b'_5 \\\\\\\\ b'_6 \\\\\\\\ b'_7 \\end{bmatrix} = \\begin{bmatrix} 1\u00260\u00260\u00260\u00261\u00261\u00261\u00261 \\\\\\\\ 1\u00261\u00260\u00260\u00260\u00261\u00261\u00261 \\\\\\\\ 1\u00261\u00261\u00260\u00260\u00260\u00261\u00261 \\\\\\\\ 1\u00261\u00261\u00261\u00260\u00260\u00260\u00261 \\\\\\\\ 1\u00261\u00261\u00261\u00261\u00260\u00260\u00260 \\\\\\\\ 0\u00261\u00261\u00261\u00261\u00261\u00260\u00260 \\\\\\\\ 0\u00260\u00261\u00261\u00261\u00261\u00261\u00260 \\\\\\\\ 0\u00260\u00260\u00261\u00261\u00261\u00261\u00261 \\end{bmatrix} \\begin{bmatrix} b_0 \\\\\\\\ b_1 \\\\\\\\ b_2 \\\\\\\\ b_3 \\\\\\\\ b_4 \\\\\\\\ b_5 \\\\\\\\ b_6 \\\\\\\\ b_7 \\end{bmatrix} + \\begin{bmatrix} 1 \\\\\\\\ 1 \\\\\\\\ 0 \\\\\\\\ 0 \\\\\\\\ 0 \\\\\\\\ 1 \\\\\\\\ 1 \\\\\\\\ 0 \\end{bmatrix} $$ Voici ce qu’on obtient: Pour lire cette table :\nles 4 bits les plus significatifs représente la ligne les 4 bits moins significatifs représentera la colonne\nPour faire simple il suffit de convertir son octet en hexadécimal, puis: l’octet à gauche représente la ligne le deuxième, l’octet à droite représentera la colonne\nOn a donc par exemple: 0F ——–\u003e76 d5 ——–\u003e 03 Cette opération rend le chiffrement non-linéaire. Si on supprime cette opération ou qu’on l’identité, notre chiffrement devient caduque et vulnérable.\n3. Rcon Rcon (Round Constant) est une transformation défini par \\(Rcon(i) = [X^{i-1}, 0, 0, 0]\\), avec \\(i \u003e 0\\). On a donc les valeurs suivantes pour \\(1 \\leq i \\leq 10\\) :\n\\(X^0 = 1\\)\n\\(X^1 =1\\times X^1 + 0\\times 1 = 10_2 = 2\\)\n\\(X^2 = 1\\times X^2 + 0\\times X^1 + 0\\times 1 = 100_2 = 4\\) …\n\\(X^7 = 10000000_2 = 128\\)\n\\(X^8 = X^4 + X^3 + X + 1 = 11011_2 = 0x1b = 27\\) car on est dans \\(GF(2^8)\\)\n\\(X^9 = X(X^8) = X(X^4 + X^3 + X + 1) = 1\\times X^5 + 1\\times X^4 + 0\\times X^3 + 1\\times X^2 + 1\\times X + 0 \\times 1 = 110110_2 = 0x36 = 54\\)\n2.1.3 Résumé Prenons un exemple pour mieux clarifier les choses. Supposons que la clé est 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F. Ce sera notre premier round_key. Pour obtenir les round_key suivant :\nstocker la clé dans une matrice \\(4 \\times 4\\) $$ K_0 = \\begin{bmatrix} 00\u002601\u002602\u002603 \\\\\\\\ 04\u002605\u002606\u002607 \\\\\\\\ 08\u002609\u00260A\u00260B \\\\\\\\ 0C\u00260D\u00260E\u00260F \\\\\\\\ \\end{bmatrix} $$ On applique la rotation, la Sbox et Rcon sur la dernière colonne de \\(K_0\\)():\n$$\\begin{bmatrix} 03 \\\\\\\\ 07 \\\\\\\\ 0B \\\\\\\\ 0F \\\\\\\\ \\end{bmatrix} \\underset{\\Longrightarrow}{RotW} \\begin{bmatrix} 07 \\\\\\\\ 0B \\\\\\\\ 0F \\\\\\\\ 03 \\\\\\\\ \\end{bmatrix} \\underset{\\Longrightarrow}{SubW} \\begin{bmatrix} C5 \\\\\\\\ 2B \\\\\\\\ 76 \\\\\\\\ 7B \\\\\\\\ \\end{bmatrix} \\oplus \\begin{bmatrix} Rcon(i=1) \\\\\\\\ 00 \\\\\\\\ 00 \\\\\\\\ 00 \\\\\\\\ \\end{bmatrix} \\Rightarrow \\begin{bmatrix} C4 \\\\\\\\ 2B \\\\\\\\ 76 \\\\\\\\ 7B \\\\\\\\ \\end{bmatrix}= C $$ On applique ensuite le XOR successif sur les colonnes :\n\\(C \\oplus \\text{colonne 0 de } K_0 = K'_0\\)\n\\(K'_0 \\oplus \\text{colonne 1 de } K_0 = K'_1\\)\n\\(K'_1 \\oplus \\text{colonne 2 de } K_0 = K'_2\\)\n\\(K'_2 \\oplus \\text{colonne 3 de } K_0 = K'_3\\)\nEt comme ça on a notre premier round_key où les \\(K'_i\\) sont les colonnes de notre nouvelle clé puis on répète les mêmes opérations suur cett nouvelle clé pour obtenir le deuxième round_key et ainsi de suite.\nSi on effectue \\(i\\) tours de l’AES, on a à calculer \\(i\\) round_key, et donc avoir \\(i + 1\\) clés.\nAES-128 à 10 tours \\(\\Longrightarrow\\) \\(11\\) *round_keys * L’extension de la clé \\(K_0\\), est une fonction inversible. Chaque étape peut être inversée grâce aux XOR, à l’inverse de la Sbox et à Rcon qui donne toujours la même image en fonction du tour.\nDonc si l’on trouve \\(K_i\\), c’est-à-dire on trouve une sous clé du \\(i^{ème}\\) tours et que l’on connaît la valeur de \\(i\\), alors on peut remonter jusqu’à la clé \\(K_0\\).\n2.1.4 Implémentation Voici une implémentation simple de chaque étape: aes_key_expension.py RotWord\rdef rotword(word=[]): if len(word) != 4: raise ValueError(f\"Wrong length: {len(word)}\") return return bytes(np.roll(list(word), -1).tolist()) SubWord\rS_BOX = [ [0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76], [0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0], [0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15], [0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75], [0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84], [0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf], [0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8], [0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2], [0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73], [0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb], [0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79], [0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08], [0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a], [0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e], [0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf], [0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16], ] def get_sbox_map(): sbox_map = {} for i in range(0x100): msb = i \u003e\u003e 4 lsb = i \u0026 0x0f sbox_map[i] = S_BOX[msb][lsb] return sbox_map def subword(word=[], sbox_map=get_sbox_map()): if len(word) != 4: raise ValueError(f\"Wrong length: {len(word)}\") return [sbox_map[i] for i in word] Rcon\r# on utilisera directement un mapping comme Sbox def rcon(n=1): if not 0 \u003c= n \u003c 256: raise ValueError(f\"Wrong n: {n}\") return bytes([RCON_TABLE[n], 0, 0, 0]) # D'après le standard NIST le Rcon commence toujours par 1, mais dans certaines implémentations de AES, on trouve Rcon(0) = 0x8d (je ne sais toujours pas comment ça s'obtient), ici je le mets mais faut savoir qu'on l'atteindra jamais car nos i commence à 1 donc voilà RCON_TABLE = [0x8D, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1B, 0x36, 0x6C, 0xD8, 0xAB, 0x4D, 0x9A, 0x2F, 0x5E, 0xBC, 0x63, 0xC6, 0x97, 0x35, 0x6A, 0xD4, 0xB3,0x7D,0xFA, 0xEF, 0xC5, 0x91, 0x39, 0x72, 0xE4, 0xD3, 0xBD, 0x61, 0xC2, 0x9F, 0x25, 0x4A, 0x94, 0x33, 0x66, 0xCC, 0x83, 0x1D, 0x3A, 0x74, 0xE8, 0xCB, 0x8D, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1B, 0x36, 0x6C, 0xD8, 0xAB, 0x4D, 0x9A, 0x2F, 0x5E, 0xBC, 0x63, 0xC6, 0x97, 0x35, 0x6A, 0xD4, 0xB3, 0x7D, 0xFA, 0xEF, 0xC5, 0x91, 0x39, 0x72, 0xE4, 0xD3, 0xBD, 0x61, 0xC2, 0x9F, 0x25, 0x4A, 0x94, 0x33, 0x66, 0xCC, 0x83, 0x1D, 0x3A, 0x74, 0xE8, 0xCB, 0x8D, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1B, 0x36, 0x6C, 0xD8, 0xAB, 0x4D, 0x9A, 0x2F, 0x5E, 0xBC, 0x63, 0xC6, 0x97, 0x35, 0x6A, 0xD4, 0xB3, 0x7D, 0xFA, 0xEF, 0xC5, 0x91, 0x39, 0x72, 0xE4, 0xD3, 0xBD, 0x61, 0xC2, 0x9F, 0x25, 0x4A, 0x94, 0x33, 0x66, 0xCC, 0x83, 0x1D, 0x3A, 0x74, 0xE8, 0xCB, 0x8D, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1B, 0x36, 0x6C, 0xD8, 0xAB, 0x4D, 0x9A, 0x2F, 0x5E, 0xBC, 0x63, 0xC6, 0x97, 0x35, 0x6A, 0xD4, 0xB3, 0x7D, 0xFA, 0xEF, 0xC5, 0x91, 0x39, 0x72, 0xE4, 0xD3, 0xBD, 0x61, 0xC2, 0x9F, 0x25, 0x4A, 0x94, 0x33, 0x66, 0xCC, 0x83, 0x1D, 0x3A, 0x74, 0xE8, 0xCB, 0x8D, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1B, 0x36, 0x6C, 0xD8, 0xAB, 0x4D, 0x9A, 0x2F, 0x5E, 0xBC, 0x63, 0xC6, 0x97, 0x35, 0x6A, 0xD4, 0xB3, 0x7D, 0xFA, 0xEF, 0xC5, 0x91, 0x39, 0x72, 0xE4, 0xD3, 0xBD, 0x61, 0xC2, 0x9F, 0x25, 0x4A, 0x94, 0x33, 0x66, 0xCC, 0x83, 0x1D, 0x3A, 0x74, 0xE8, 0xCB, 0x8D] KeyExpansion\r# code inspiré de https://github.com/thomasperrot/aes-square-attack/ def key_expension(key=b'', rounds=11): if len(key) != 16: raise ValueError(f\"Wrong key length: {len(key)}\") key_mat = [key[i : i + 4] for i in range(0, len(key), 4)] expended_key = key_mat for r in range(1, rounds): rotword = rotword(expended_key[-1]) subword = subword(rot) first_column = xor(sub, expended_key[-4], rcon(r)) expended_key.append(first_column) for _ in range(3): expended_key.append(xor(expended_key[-1], expended_key[-4])) return expended_key def reverse_key_expension(expended_key=b'', rounds=1): for r in reversed(range(1, rounds)): for _ in range(3): expended_key.insert(0, xor(expended_key[2], expended_key[3])) rotword = rotword(expended_key[2]) subword = subword(rot) first_column = xor(expended_key[3], rcon(r), sub) expended_key.insert(0, first_column) return expended_key # get key from known round_keys and round def get_first_key(key=b'', rounds=1): if len(key) != 16: raise ValueError(f\"Wrong key length: {len(key)}\") expended_key = [key[i : i + 4] for i in range(0, len(key), 4)] fully_expended_key = reverse_key_expension(expended_key, rounds) return b\"\".join(fully_expended_key[:4]) 2.2 Chiffrement proprement dit Une fois les round_keys obtenus, on va passer à l’étape du chiffrement du texte en clair. Le texte à chiffrer est découpé en blocs de 16 octets et, pour chaque bloc clair, on effectue des opérations pour produire un bloc chiffré de même longueur. Chaque bloc de 16 octets est représenté en interne par une matrice \\(4 \\times 4\\). Cette représentation est appelé état (state en anglais) et les différentes transformations qu’il subit sont regroupés en tours(round en anglais), chaque tour impliquant à chaque fois un round_key différent. La représentation se fait en colonnes et non en lignes. On va maintenant s’attaquer aux différentes transformations subit.\n2.2.1 Détails des opérations Voici toutes les opérations effectuées sur le state, classées par ordre:\nSubBytes ShiftRows MixColumns AddRoundKey Et c’est toutes ces opérations qui constituent un tour d’AES(round). Chaque tour prend en entrée une sous-clé différente and la sortie du tour précédent. En AES-128, on a au total 10 tours. Notez que le dernier tour n’applique pas le MixColumns. Et aussi avant le premier tour l’opération AddroundKey est effectué. 1. SubBytes SubBytes est une fonction non linéaire qui opère indépendamment sur chacun des 16 octets. Elle utilise une opération sur le corps fini à 256 éléments. C’est aussi une Sbox comme dans l’opération subword. La bonne nouvelle ici, c’est que c’est la même Sbox qui est utilisé.\n2. ShiftRows ShiftRows est une permutation circulaire vers la gauche de \\(i\\) cases pour la ligne numéro \\(i\\) avec \\(0 \\leq i \\leq 3\\). 3. MixColumns MixColumns est un produit matriciel à coefficient dans \\(F_{256}\\). Pour chaque colonne on applique une multiplication par une matrice. Soit la matrice A l’entrée du MixColumns et la matrice B le résultat de la fonction. Alors \\(M × A = B\\) avec $$M = \\begin{bmatrix} \\alpha\u0026\\alpha+1\u00261\u00261 \\\\\\\\ 1\u0026\\alpha\u0026\\alpha+1\u00261 \\\\\\\\ 1\u00261\u0026\\alpha\u0026\\alpha+1 \\\\\\\\ \\alpha+1\u00261\u00261\u0026\\alpha \\\\\\\\ \\end{bmatrix} $$ Or dans \\((F_2)^8\\) chaque élément s’écrit \\({\\displaystyle \\sum_{i=0}^7}b_i\\alpha ^{i}\\) et donc pour avoir alpha tous les \\(b_i\\) à \\(0\\) sauf à \\(i=1\\) ainsi l’octet qui code \\(\\alpha\\) est donc \\((0,0,0,0,0,0,1,0) = 2\\).\nM devient alors $$M = \\begin{bmatrix} 2\u00263\u00261\u00261 \\\\\\\\ 1\u00262\u00263\u00261 \\\\\\\\ 1\u00261\u00262\u00263 \\\\\\\\ 3\u00261\u00261\u00262 \\\\\\\\ \\end{bmatrix} $$ Ces additions et multiplications se font dans le copts fini à 256 éléments. On peut également précalculer une table de mapping pour ces multiplications et l’addition remplacée par un simple XOR.\n4. AddRoundKey AddRoundKey est juste un XOR de la clé de tour \\(K_i\\) avec la matrice, c’est une addition case par case.\n2.2.2 Résumé Pour résumer, voici un aperçu des différentes phases du chiffrement AES:\n1.Key expansion ou Key Schedule\nPour une clé de 128 bits, 11 sous-clés différentes de 128 bit appelées aussi “round keys” sont dérivés. Chacun d’eux sera utilisé à l’étape AddRoundKey.\n2. Première addition de clé\nAddRoundKey - les octets de la première sous-clé sont XORés avec les octets de l’état(state), le state étant un bloc du message en clair écrit sous forme de matrix 4x4. 3. Tours (rounds)\nCette phase s’effectue10 fois, 9 pour les tours principaux et une dernière pour le “dernier tour”:\na) SubBytes - chaque octet du state est subtitué par un octet différent en utilisant le mapping Sbox.\nb) ShiftRows - les 3 dernières lignes du state subissent un décalage circulaire respectivement de 1, 2 et 3 lignes.\nc) MixColumns - une multiplication matricielle est effectué sur chaque colonne du state. Cette opération n’est pas effectué pour le dernier tour. d) AddRoundKey - les octets de la sous-clé actuelle sont XORés avec les octets du state.\n2.2.2 Implémentation Implémentation finale: aes_encrypt.py\nState representation\rdef tostate(plaintext=b''): state = np.array(list(plaintext), dtype=int) state = np.reshape(state, (4, 4), order=\"F\") return state subByte\r# https://github.com/thomasperrot/aes-square-attack def subbytes(state: array, sbox_map=get_sbox_map()): new_state = np.zeros((4, 4), dtype=int) for i in range(4): for j in range(4): new_state[i, j] = sbox_map[state[i, j]] return new_state ShiftRows\r# https://github.com/thomasperrot/aes-square-attack def shiftrows(state: array): new_state = np.array(state, dtype=int) for i in range(4): new_state[i] = np.roll(new_state[i], -i) return new_state MixColumns\r# mapping multiplication par 2 et 3 MULTIPLICATION_BY_2 = { 0: 0, 1: 2, 2: 4, 3: 6, 4: 8, 5: 10, 6: 12, 7: 14, 8: 16, 9: 18, 10: 20, 11: 22, 12: 24, 13: 26, 14: 28, 15: 30, 16: 32, 17: 34, 18: 36, 19: 38, 20: 40, 21: 42, 22: 44, 23: 46, 24: 48, 25: 50, 26: 52, 27: 54, 28: 56, 29: 58, 30: 60, 31: 62, 32: 64, 33: 66, 34: 68, 35: 70, 36: 72, 37: 74, 38: 76, 39: 78, 40: 80, 41: 82, 42: 84, 43: 86, 44: 88, 45: 90, 46: 92, 47: 94, 48: 96, 49: 98, 50: 100, 51: 102, 52: 104, 53: 106, 54: 108, 55: 110, 56: 112, 57: 114, 58: 116, 59: 118, 60: 120, 61: 122, 62: 124, 63: 126, 64: 128, 65: 130, 66: 132, 67: 134, 68: 136, 69: 138, 70: 140, 71: 142, 72: 144, 73: 146, 74: 148, 75: 150, 76: 152, 77: 154, 78: 156, 79: 158, 80: 160, 81: 162, 82: 164, 83: 166, 84: 168, 85: 170, 86: 172, 87: 174, 88: 176, 89: 178, 90: 180, 91: 182, 92: 184, 93: 186, 94: 188, 95: 190, 96: 192, 97: 194, 98: 196, 99: 198, 100: 200, 101: 202, 102: 204, 103: 206, 104: 208, 105: 210, 106: 212, 107: 214, 108: 216, 109: 218, 110: 220, 111: 222, 112: 224, 113: 226, 114: 228, 115: 230, 116: 232, 117: 234, 118: 236, 119: 238, 120: 240, 121: 242, 122: 244, 123: 246, 124: 248, 125: 250, 126: 252, 127: 254, 128: 27, 129: 25, 130: 31, 131: 29, 132: 19, 133: 17, 134: 23, 135: 21, 136: 11, 137: 9, 138: 15, 139: 13, 140: 3, 141: 1, 142: 7, 143: 5, 144: 59, 145: 57, 146: 63, 147: 61, 148: 51, 149: 49, 150: 55, 151: 53, 152: 43, 153: 41, 154: 47, 155: 45, 156: 35, 157: 33, 158: 39, 159: 37, 160: 91, 161: 89, 162: 95, 163: 93, 164: 83, 165: 81, 166: 87, 167: 85, 168: 75, 169: 73, 170: 79, 171: 77, 172: 67, 173: 65, 174: 71, 175: 69, 176: 123, 177: 121, 178: 127, 179: 125, 180: 115, 181: 113, 182: 119, 183: 117, 184: 107, 185: 105, 186: 111, 187: 109, 188: 99, 189: 97, 190: 103, 191: 101, 192: 155, 193: 153, 194: 159, 195: 157, 196: 147, 197: 145, 198: 151, 199: 149, 200: 139, 201: 137, 202: 143, 203: 141, 204: 131, 205: 129, 206: 135, 207: 133, 208: 187, 209: 185, 210: 191, 211: 189, 212: 179, 213: 177, 214: 183, 215: 181, 216: 171, 217: 169, 218: 175, 219: 173, 220: 163, 221: 161, 222: 167, 223: 165, 224: 219, 225: 217, 226: 223, 227: 221, 228: 211, 229: 209, 230: 215, 231: 213, 232: 203, 233: 201, 234: 207, 235: 205, 236: 195, 237: 193, 238: 199, 239: 197, 240: 251, 241: 249, 242: 255, 243: 253, 244: 243, 245: 241, 246: 247, 247: 245, 248: 235, 249: 233, 250: 239, 251: 237, 252: 227, 253: 225, 254: 231, 255: 229} MULTIPLICATION_BY_3 = { 0: 0, 1: 3, 2: 6, 3: 5, 4: 12, 5: 15, 6: 10, 7: 9, 8: 24, 9: 27, 10: 30, 11: 29, 12: 20, 13: 23, 14: 18, 15: 17, 16: 48, 17: 51, 18: 54, 19: 53, 20: 60, 21: 63, 22: 58, 23: 57, 24: 40, 25: 43, 26: 46, 27: 45, 28: 36, 29: 39, 30: 34, 31: 33, 32: 96, 33: 99, 34: 102, 35: 101, 36: 108, 37: 111, 38: 106, 39: 105, 40: 120, 41: 123, 42: 126, 43: 125, 44: 116, 45: 119, 46: 114, 47: 113, 48: 80, 49: 83, 50: 86, 51: 85, 52: 92, 53: 95, 54: 90, 55: 89, 56: 72, 57: 75, 58: 78, 59: 77, 60: 68, 61: 71, 62: 66, 63: 65, 64: 192, 65: 195, 66: 198, 67: 197, 68: 204, 69: 207, 70: 202, 71: 201, 72: 216, 73: 219, 74: 222, 75: 221, 76: 212, 77: 215, 78: 210, 79: 209, 80: 240, 81: 243, 82: 246, 83: 245, 84: 252, 85: 255, 86: 250, 87: 249, 88: 232, 89: 235, 90: 238, 91: 237, 92: 228, 93: 231, 94: 226, 95: 225, 96: 160, 97: 163, 98: 166, 99: 165, 100: 172, 101: 175, 102: 170, 103: 169, 104: 184, 105: 187, 106: 190, 107: 189, 108: 180, 109: 183, 110: 178, 111: 177, 112: 144, 113: 147, 114: 150, 115: 149, 116: 156, 117: 159, 118: 154, 119: 153, 120: 136, 121: 139, 122: 142, 123: 141, 124: 132, 125: 135, 126: 130, 127: 129, 128: 155, 129: 152, 130: 157, 131: 158, 132: 151, 133: 148, 134: 145, 135: 146, 136: 131, 137: 128, 138: 133, 139: 134, 140: 143, 141: 140, 142: 137, 143: 138, 144: 171, 145: 168, 146: 173, 147: 174, 148: 167, 149: 164, 150: 161, 151: 162, 152: 179, 153: 176, 154: 181, 155: 182, 156: 191, 157: 188, 158: 185, 159: 186, 160: 251, 161: 248, 162: 253, 163: 254, 164: 247, 165: 244, 166: 241, 167: 242, 168: 227, 169: 224, 170: 229, 171: 230, 172: 239, 173: 236, 174: 233, 175: 234, 176: 203, 177: 200, 178: 205, 179: 206, 180: 199, 181: 196, 182: 193, 183: 194, 184: 211, 185: 208, 186: 213, 187: 214, 188: 223, 189: 220, 190: 217, 191: 218, 192: 91, 193: 88, 194: 93, 195: 94, 196: 87, 197: 84, 198: 81, 199: 82, 200: 67, 201: 64, 202: 69, 203: 70, 204: 79, 205: 76, 206: 73, 207: 74, 208: 107, 209: 104, 210: 109, 211: 110, 212: 103, 213: 100, 214: 97, 215: 98, 216: 115, 217: 112, 218: 117, 219: 118, 220: 127, 221: 124, 222: 121, 223: 122, 224: 59, 225: 56, 226: 61, 227: 62, 228: 55, 229: 52, 230: 49, 231: 50, 232: 35, 233: 32, 234: 37, 235: 38, 236: 47, 237: 44, 238: 41, 239: 42, 240: 11, 241: 8, 242: 13, 243: 14, 244: 7, 245: 4, 246: 1, 247: 2, 248: 19, 249: 16, 250: 21, 251: 22, 252: 31, 253: 28, 254: 25, 255: 26} # https://github.com/thomasperrot/aes-square-attack def mixcolumns(state: array): new_state = np.array(state, dtype=int) for i in range(4): a0, a1, a2, a3 = state[:, i] new_state[0, i] = MULTIPLICATION_BY_2[a0] ^ MULTIPLICATION_BY_3[a1] ^ a2 ^ a3 new_state[1, i] = a0 ^ MULTIPLICATION_BY_2[a1] ^ MULTIPLICATION_BY_3[a2] ^ a3 new_state[2, i] = a0 ^ a1 ^ MULTIPLICATION_BY_2[a2] ^ MULTIPLICATION_BY_3[a3] new_state[3, i] = MULTIPLICATION_BY_3[a0] ^ a1 ^ a2 ^ MULTIPLICATION_BY_2[a3] return new_state addRoundKey\r# https://github.com/thomasperrot/aes-square-attack def addroundkey(state: array, key=[[], [], [], []]): if len(key) != 4: raise ValueError(f\"Wrong length: {len(key)}\") new_state = np.array(state, dtype=int) for j in range(4): for i in range(4): new_state[i][j] ^= key[j][i] return new_state encrypt\r# https://github.com/thomasperrot/aes-square-attack # ici round = nbre de tous AES-128 ==\u003e 10 rounds def transform_state(plaintext: bytes, key: bytes, rounds: int): key_state = key_expension(key, rounds=rounds + 1) round_key = key_state[0:4] state = tostate (plaintext) state = addroundkey(state, round_key) for i in range(1, rounds): round_key = key_state[4 * i : 4 * (i + 1)] state = subbytes(state) state = shiftrows(state) state = mixcolumns(state) state = addroundkey(state, round_key) round_key = key_state[4 * rounds : 4 * (rounds + 1)] state = subbytes(state) state = shiftrows(state) #no mix colums for last round state = addroundkey(state, round_key) return state 3. AES - Déchiffrement Comme vous le savez c’est l’opération inverse du chiffrement qui avec la clé et le texte chiffré nous permettra de retrouver le message en clair.\n3.1 Procédé de déchiffement Ayant la clé de chiffrement, la première étape serait l’expansion de la clé. Ensuite il va falloir faire les opérations inverses, du SubBytes, ShiftRows, MixColumns. Le addRoundKey demeure inchangé. Notons \\(I\\)SubBytes l’inverse de l’opération SubBytes (inverse de la Sbox), \\(I\\)ShiftRows l’inverse de ShiftRows et \\(I\\)MixColumns l’inverse du MixColumns. Le texte à déchiffrer est découpé en blocs de 16 octets et en matrice 4x4 comme pour obtenir le state, ensuite pour chaque bloc chiffré, on effectue les opérations suivantes pour produire un bloc clair de même longueur\nOn initialise un tableau \\(4 \\times 4\\) avec \\(16\\) octets de texte chiffré On applique successivement les opérations suivantes sur ce tableau: 1. AddRoundKey, \\(I\\)ShiftRows, et \\(I\\)SubBytes dans cet ordre. 2. On effectue “nombre de tours total”-1 tours comportant les 4 étapes AddRoundKey, \\(I\\)MixColumns, \\(I\\)ShiftRows puis \\(I\\)SubBytes. 3. Un dernier tour ne comporte plus qu’une étapes : AddRoundKey Et voilà, on obtient notre message en clair. Attention, pour l’étape AddRoundKey, on commence par la dernières sous-clés dérivés jusqu’à atteindre la clé elle même pour le dernier tour. \\(I\\)SubBytes La fonction permettant d’avoir la Sbox étant bijective, il faut calculer son inverse pour avoir la Sbox inverse. On a donc deux possibilités: soit on précalcule la Sbox inverse ensuite on la lit comme la Sbox, soit on utilise la Sbox mais qu’on lira dans l’autre sens i.e. partir de l’image \\(y\\) et retrouvé le \\(x\\) correspondant. Donc pour faire simple, supposons on cherche la Sbox inverse de \\(5F\\), on va chercher dans le tableau de la Sbox où est localisé \\(5F\\) et ensuite on lira le x correspondant. et donc on trouve \\(84\\). \\(I\\)ShiftRows C’est l’exacte inverse du ShiftRows, décalage à droite de \\(i\\) colonnes de la ligne \\(i\\) , \\(0\\leq i \\leq 3\\) \\(I\\)MixColumns L’opération MixColumns étant défini par \\(B=M\\times A\\), donc inverser MixColumns revient à trouver la matrice \\(A\\) et donc on a:\n$$ A = M^{-1} \\times B$$ Il suffit donc d’inverser la matrice de l’opération MixColumns \\(M\\) dans \\(\\mathbb{F}_{256}\\). On trouve:\n$$M = \\begin{bmatrix} 0E\u00260B\u00260D\u002609 \\\\\\\\ 09\u00260E\u00260B\u00260D \\\\\\\\ 0D\u002609\u00260E\u00260B \\\\\\\\ 0B\u00260D\u002609\u00260E \\\\\\\\ \\end{bmatrix} = \\begin{bmatrix} 14\u002611\u002613\u00269 \\\\\\\\ 9\u002614\u002611\u002613 \\\\\\\\ 13\u00269\u002614\u002611 \\\\\\\\ 11\u002613\u00269\u002614 \\\\\\\\ \\end{bmatrix} $$ On peut donc également pour cette étape précalculer les valeurs pour les multiplications par 14, 13, 11 et 9.\n3.2 Implémentation Implémentation finale: aes_decrypt.py\n\\(I\\)SubBytes\rdef ISubBytes(state: array, sbox_map=ke.get_sbox_map()): new_state = np.zeros((4, 4), dtype=int) for i in range(4): for j in range(4): pos = list(sbox_map.values()).index(state[i, j]) new_state[i, j] = pos return new_state \\(I\\)ShiftRows\rdef IShiftRows(state: array): new_state = np.array(state, dtype=int) for i in range(4): new_state[i] = np.roll(new_state[i], i) return new_state \\(I\\)MixColumns\rMULTIPLICATION_BY_9 = [0x0, 0x9, 0x12, 0x1b, 0x24, 0x2d, 0x36, 0x3f, 0x48, 0x41, 0x5a, 0x53, 0x6c, 0x65, 0x7e, 0x77, 0x90, 0x99, 0x82, 0x8b, 0xb4, 0xbd, 0xa6, 0xaf, 0xd8, 0xd1, 0xca, 0xc3, 0xfc, 0xf5, 0xee, 0xe7, 0x3b, 0x32, 0x29, 0x20, 0x1f, 0x16, 0xd, 0x4, 0x73, 0x7a, 0x61, 0x68, 0x57, 0x5e, 0x45, 0x4c, 0xab, 0xa2, 0xb9, 0xb0, 0x8f, 0x86, 0x9d, 0x94, 0xe3, 0xea, 0xf1, 0xf8, 0xc7, 0xce, 0xd5, 0xdc, 0x76, 0x7f, 0x64, 0x6d, 0x52, 0x5b, 0x40, 0x49, 0x3e, 0x37, 0x2c, 0x25, 0x1a, 0x13, 0x8, 0x1, 0xe6, 0xef, 0xf4, 0xfd, 0xc2, 0xcb, 0xd0, 0xd9, 0xae, 0xa7, 0xbc, 0xb5, 0x8a, 0x83, 0x98, 0x91, 0x4d, 0x44, 0x5f, 0x56, 0x69, 0x60, 0x7b, 0x72, 0x5, 0xc, 0x17, 0x1e, 0x21, 0x28, 0x33, 0x3a, 0xdd, 0xd4, 0xcf, 0xc6, 0xf9, 0xf0, 0xeb, 0xe2, 0x95, 0x9c, 0x87, 0x8e, 0xb1, 0xb8, 0xa3, 0xaa, 0xec, 0xe5, 0xfe, 0xf7, 0xc8, 0xc1, 0xda, 0xd3, 0xa4, 0xad, 0xb6, 0xbf, 0x80, 0x89, 0x92, 0x9b, 0x7c, 0x75, 0x6e, 0x67, 0x58, 0x51, 0x4a, 0x43, 0x34, 0x3d, 0x26, 0x2f, 0x10, 0x19, 0x2, 0xb, 0xd7, 0xde, 0xc5, 0xcc, 0xf3, 0xfa, 0xe1, 0xe8, 0x9f, 0x96, 0x8d, 0x84, 0xbb, 0xb2, 0xa9, 0xa0, 0x47, 0x4e, 0x55, 0x5c, 0x63, 0x6a, 0x71, 0x78, 0xf, 0x6, 0x1d, 0x14, 0x2b, 0x22, 0x39, 0x30, 0x9a, 0x93, 0x88, 0x81, 0xbe, 0xb7, 0xac, 0xa5, 0xd2, 0xdb, 0xc0, 0xc9, 0xf6, 0xff, 0xe4, 0xed, 0xa, 0x3, 0x18, 0x11, 0x2e, 0x27, 0x3c, 0x35, 0x42, 0x4b, 0x50, 0x59, 0x66, 0x6f, 0x74, 0x7d, 0xa1, 0xa8, 0xb3, 0xba, 0x85, 0x8c, 0x97, 0x9e, 0xe9, 0xe0, 0xfb, 0xf2, 0xcd, 0xc4, 0xdf, 0xd6, 0x31, 0x38, 0x23, 0x2a, 0x15, 0x1c, 0x7, 0xe, 0x79, 0x70, 0x6b, 0x62, 0x5d, 0x54, 0x4f, 0x46] MULTIPLICATION_BY_11 = [0x0, 0xb, 0x16, 0x1d, 0x2c, 0x27, 0x3a, 0x31, 0x58, 0x53, 0x4e, 0x45, 0x74, 0x7f, 0x62, 0x69, 0xb0, 0xbb, 0xa6, 0xad, 0x9c, 0x97, 0x8a, 0x81, 0xe8, 0xe3, 0xfe, 0xf5, 0xc4, 0xcf, 0xd2, 0xd9, 0x7b, 0x70, 0x6d, 0x66, 0x57, 0x5c, 0x41, 0x4a, 0x23, 0x28, 0x35, 0x3e, 0xf, 0x4, 0x19, 0x12, 0xcb, 0xc0, 0xdd, 0xd6, 0xe7, 0xec, 0xf1, 0xfa, 0x93, 0x98, 0x85, 0x8e, 0xbf, 0xb4, 0xa9, 0xa2, 0xf6, 0xfd, 0xe0, 0xeb, 0xda, 0xd1, 0xcc, 0xc7, 0xae, 0xa5, 0xb8, 0xb3, 0x82, 0x89, 0x94, 0x9f, 0x46, 0x4d, 0x50, 0x5b, 0x6a, 0x61, 0x7c, 0x77, 0x1e, 0x15, 0x8, 0x3, 0x32, 0x39, 0x24, 0x2f, 0x8d, 0x86, 0x9b, 0x90, 0xa1, 0xaa, 0xb7, 0xbc, 0xd5, 0xde, 0xc3, 0xc8, 0xf9, 0xf2, 0xef, 0xe4, 0x3d, 0x36, 0x2b, 0x20, 0x11, 0x1a, 0x7, 0xc, 0x65, 0x6e, 0x73, 0x78, 0x49, 0x42, 0x5f, 0x54, 0xf7, 0xfc, 0xe1, 0xea, 0xdb, 0xd0, 0xcd, 0xc6, 0xaf, 0xa4, 0xb9, 0xb2, 0x83, 0x88, 0x95, 0x9e, 0x47, 0x4c, 0x51, 0x5a, 0x6b, 0x60, 0x7d, 0x76, 0x1f, 0x14, 0x9, 0x2, 0x33, 0x38, 0x25, 0x2e, 0x8c, 0x87, 0x9a, 0x91, 0xa0, 0xab, 0xb6, 0xbd, 0xd4, 0xdf, 0xc2, 0xc9, 0xf8, 0xf3, 0xee, 0xe5, 0x3c, 0x37, 0x2a, 0x21, 0x10, 0x1b, 0x6, 0xd, 0x64, 0x6f, 0x72, 0x79, 0x48, 0x43, 0x5e, 0x55, 0x1, 0xa, 0x17, 0x1c, 0x2d, 0x26, 0x3b, 0x30, 0x59, 0x52, 0x4f, 0x44, 0x75, 0x7e, 0x63, 0x68, 0xb1, 0xba, 0xa7, 0xac, 0x9d, 0x96, 0x8b, 0x80, 0xe9, 0xe2, 0xff, 0xf4, 0xc5, 0xce, 0xd3, 0xd8, 0x7a, 0x71, 0x6c, 0x67, 0x56, 0x5d, 0x40, 0x4b, 0x22, 0x29, 0x34, 0x3f, 0xe, 0x5, 0x18, 0x13, 0xca, 0xc1, 0xdc, 0xd7, 0xe6, 0xed, 0xf0, 0xfb, 0x92, 0x99, 0x84, 0x8f, 0xbe, 0xb5, 0xa8, 0xa3] MULTIPLICATION_BY_13 = [0x0, 0xd, 0x1a, 0x17, 0x34, 0x39, 0x2e, 0x23, 0x68, 0x65, 0x72, 0x7f, 0x5c, 0x51, 0x46, 0x4b, 0xd0, 0xdd, 0xca, 0xc7, 0xe4, 0xe9, 0xfe, 0xf3, 0xb8, 0xb5, 0xa2, 0xaf, 0x8c, 0x81, 0x96, 0x9b, 0xbb, 0xb6, 0xa1, 0xac, 0x8f, 0x82, 0x95, 0x98, 0xd3, 0xde, 0xc9, 0xc4, 0xe7, 0xea, 0xfd, 0xf0, 0x6b, 0x66, 0x71, 0x7c, 0x5f, 0x52, 0x45, 0x48, 0x3, 0xe, 0x19, 0x14, 0x37, 0x3a, 0x2d, 0x20, 0x6d, 0x60, 0x77, 0x7a, 0x59, 0x54, 0x43, 0x4e, 0x5, 0x8, 0x1f, 0x12, 0x31, 0x3c, 0x2b, 0x26, 0xbd, 0xb0, 0xa7, 0xaa, 0x89, 0x84, 0x93, 0x9e, 0xd5, 0xd8, 0xcf, 0xc2, 0xe1, 0xec, 0xfb, 0xf6, 0xd6, 0xdb, 0xcc, 0xc1, 0xe2, 0xef, 0xf8, 0xf5, 0xbe, 0xb3, 0xa4, 0xa9, 0x8a, 0x87, 0x90, 0x9d, 0x6, 0xb, 0x1c, 0x11, 0x32, 0x3f, 0x28, 0x25, 0x6e, 0x63, 0x74, 0x79, 0x5a, 0x57, 0x40, 0x4d, 0xda, 0xd7, 0xc0, 0xcd, 0xee, 0xe3, 0xf4, 0xf9, 0xb2, 0xbf, 0xa8, 0xa5, 0x86, 0x8b, 0x9c, 0x91, 0xa, 0x7, 0x10, 0x1d, 0x3e, 0x33, 0x24, 0x29, 0x62, 0x6f, 0x78, 0x75, 0x56, 0x5b, 0x4c, 0x41, 0x61, 0x6c, 0x7b, 0x76, 0x55, 0x58, 0x4f, 0x42, 0x9, 0x4, 0x13, 0x1e, 0x3d, 0x30, 0x27, 0x2a, 0xb1, 0xbc, 0xab, 0xa6, 0x85, 0x88, 0x9f, 0x92, 0xd9, 0xd4, 0xc3, 0xce, 0xed, 0xe0, 0xf7, 0xfa, 0xb7, 0xba, 0xad, 0xa0, 0x83, 0x8e, 0x99, 0x94, 0xdf, 0xd2, 0xc5, 0xc8, 0xeb, 0xe6, 0xf1, 0xfc, 0x67, 0x6a, 0x7d, 0x70, 0x53, 0x5e, 0x49, 0x44, 0xf, 0x2, 0x15, 0x18, 0x3b, 0x36, 0x21, 0x2c, 0xc, 0x1, 0x16, 0x1b, 0x38, 0x35, 0x22, 0x2f, 0x64, 0x69, 0x7e, 0x73, 0x50, 0x5d, 0x4a, 0x47, 0xdc, 0xd1, 0xc6, 0xcb, 0xe8, 0xe5, 0xf2, 0xff, 0xb4, 0xb9, 0xae, 0xa3, 0x80, 0x8d, 0x9a, 0x97] MULTIPLICATION_BY_14 = [0x0, 0xe, 0x1c, 0x12, 0x38, 0x36, 0x24, 0x2a, 0x70, 0x7e, 0x6c, 0x62, 0x48, 0x46, 0x54, 0x5a, 0xe0, 0xee, 0xfc, 0xf2, 0xd8, 0xd6, 0xc4, 0xca, 0x90, 0x9e, 0x8c, 0x82, 0xa8, 0xa6, 0xb4, 0xba, 0xdb, 0xd5, 0xc7, 0xc9, 0xe3, 0xed, 0xff, 0xf1, 0xab, 0xa5, 0xb7, 0xb9, 0x93, 0x9d, 0x8f, 0x81, 0x3b, 0x35, 0x27, 0x29, 0x3, 0xd, 0x1f, 0x11, 0x4b, 0x45, 0x57, 0x59, 0x73, 0x7d, 0x6f, 0x61, 0xad, 0xa3, 0xb1, 0xbf, 0x95, 0x9b, 0x89, 0x87, 0xdd, 0xd3, 0xc1, 0xcf, 0xe5, 0xeb, 0xf9, 0xf7, 0x4d, 0x43, 0x51, 0x5f, 0x75, 0x7b, 0x69, 0x67, 0x3d, 0x33, 0x21, 0x2f, 0x5, 0xb, 0x19, 0x17, 0x76, 0x78, 0x6a, 0x64, 0x4e, 0x40, 0x52, 0x5c, 0x6, 0x8, 0x1a, 0x14, 0x3e, 0x30, 0x22, 0x2c, 0x96, 0x98, 0x8a, 0x84, 0xae, 0xa0, 0xb2, 0xbc, 0xe6, 0xe8, 0xfa, 0xf4, 0xde, 0xd0, 0xc2, 0xcc, 0x41, 0x4f, 0x5d, 0x53, 0x79, 0x77, 0x65, 0x6b, 0x31, 0x3f, 0x2d, 0x23, 0x9, 0x7, 0x15, 0x1b, 0xa1, 0xaf, 0xbd, 0xb3, 0x99, 0x97, 0x85, 0x8b, 0xd1, 0xdf, 0xcd, 0xc3, 0xe9, 0xe7, 0xf5, 0xfb, 0x9a, 0x94, 0x86, 0x88, 0xa2, 0xac, 0xbe, 0xb0, 0xea, 0xe4, 0xf6, 0xf8, 0xd2, 0xdc, 0xce, 0xc0, 0x7a, 0x74, 0x66, 0x68, 0x42, 0x4c, 0x5e, 0x50, 0xa, 0x4, 0x16, 0x18, 0x32, 0x3c, 0x2e, 0x20, 0xec, 0xe2, 0xf0, 0xfe, 0xd4, 0xda, 0xc8, 0xc6, 0x9c, 0x92, 0x80, 0x8e, 0xa4, 0xaa, 0xb8, 0xb6, 0xc, 0x2, 0x10, 0x1e, 0x34, 0x3a, 0x28, 0x26, 0x7c, 0x72, 0x60, 0x6e, 0x44, 0x4a, 0x58, 0x56, 0x37, 0x39, 0x2b, 0x25, 0xf, 0x1, 0x13, 0x1d, 0x47, 0x49, 0x5b, 0x55, 0x7f, 0x71, 0x63, 0x6d, 0xd7, 0xd9, 0xcb, 0xc5, 0xef, 0xe1, 0xf3, 0xfd, 0xa7, 0xa9, 0xbb, 0xb5, 0x9f, 0x91, 0x83, 0x8d] def IMixColumns(state: array): new_state = np.array(state, dtype=int) for i in range(4): a0, a1, a2, a3 = state[:, i] new_state[0, i] = MULTIPLICATION_BY_14[a0] ^ MULTIPLICATION_BY_11[a1] ^ MULTIPLICATION_BY_13[a2] ^ MULTIPLICATION_BY_9[a3] new_state[1, i] = MULTIPLICATION_BY_9[a0] ^ MULTIPLICATION_BY_14[a1] ^ MULTIPLICATION_BY_11[a2] ^ MULTIPLICATION_BY_13[a3] new_state[2, i] = MULTIPLICATION_BY_13[a0] ^ MULTIPLICATION_BY_9[a1] ^ MULTIPLICATION_BY_14[a2] ^ MULTIPLICATION_BY_11[a3] new_state[3, i] = MULTIPLICATION_BY_11[a0] ^ MULTIPLICATION_BY_13[a1] ^ MULTIPLICATION_BY_9[a2] ^ MULTIPLICATION_BY_14[a3] return new_state Decrypt\rdef decrypt(ciphertext: bytes, key: bytes, rounds: int): key_state = ke.key_expension(key, rounds=rounds + 1) round_key = key_state[-4:] state = tostate(ciphertext) state = addroundkey(state, round_key) state = IShiftRows(state) state = ISubBytes(state) for i in range(1, rounds): round_key = key_state[len(key_state) - (4 * (i + 1)) : len(key_state)- (4 * i)] state = addroundkey(state, round_key) state = IMixColumns(state) state = IShiftRows(state) state = ISubBytes(state) round_key = key_state[0: 4] state = addroundkey(state, round_key) return state Conclusion On a vu comment fonctionne en interne le chiffrement AES. Cependant ici on a chiffer et déchiffer qu’un bloc de 16 octets. Dans la réalité, on aura des textes bien plus long, ce qui fait donc intervenir l’utilisation de différents modes en AES (modes ECB, modes CBC, modes, CTR etc …). Ceci pose donc les bases du chiffrement AES et nous permettra d’avancer sur les différents types d’attaques auxquels il est confronté.\nMerci, et à très bientôt.\nRéférences Advanced Encryption Standard https://csrc.nist.gov/csrc/media/publications/fips/197/final/documents/fips-197.pdf\nBlock breakers https://www.davidwong.fr/blockbreakers/aes.html\ncoursAES https://www.di.ens.fr/~ferradi/coursAES.pdf\nCryptohack https://cryptohack.org/challenges/aes/\nCryptanalyse de l’AES à 5 tours https://perso.limos.fr/~axdurbet/media/Previous_work/projet_AES_5_tours.pdf\n","wordCount":"6333","inLanguage":"en","datePublished":"2023-07-09T20:32:54+02:00","dateModified":"2023-07-09T20:32:54+02:00","author":{"@type":"Person","name":"dilag","url":"https://dilagluc.github.io/en/about-dilag/"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://dilagluc.github.io/en/posts/2023/crypto/aes/intro-to-aes/"},"publisher":{"@type":"Organization","name":"Blog","description":"Continuing Hermit\u0026#39;s legacy to be minimal and fast theme","logo":{"@type":"ImageObject","url":"https://dilagluc.github.io/favicon.ico"}}}</script><title>Chiffrement AES</title><link rel="stylesheet dns-prefetch preconnect preload prefetch" as=style media=screen href=https://dilagluc.github.io/css/style.min.cbb61c13ffe36e23de11896ce5cb9f37cf539353029dd4d553dddd3403b2d24e.css integrity="sha256-y7YcE//jbiPeEYls5cufN89Tk1MCndTVU93dNAOy0k4=" crossorigin=anonymous></head><body id=page><header id=site-header><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://dilagluc.github.io/>Blog</a></div><nav class="site-nav hide-in-mobile"><a href=https://dilagluc.github.io/en/posts/>Posts</a><a href=https://dilagluc.github.io/en/about-dilag/>About Me</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-links hide-in-mobile"><a href=https://github.com/1bl4z3r/hermit-V2/tree/staging target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://github.com/1bl4z3r/hermit-V2/tree/staging target=_blank rel="noopener me" title=Discord><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M8.82889 11.203C7.86239 11.203 7.09937 12.0508 7.09937 13.0852c0 1.0343.779979999999999 1.8821 1.72952 1.8821C9.79538 14.9673 10.5584 14.1195 10.5584 13.0852 10.5754 12.0508 9.79538 11.203 8.82889 11.203zm6.18891.0c-.9664.0-1.7295.847800000000001-1.7295 1.8822.0 1.0343.780000000000001 1.8821 1.7295 1.8821.9665.0 1.7296-.847799999999999 1.7296-1.8821.0-1.0344-.7631-1.8822-1.7296-1.8822z" fill="currentcolor"/><path d="M14.8477 18.3649C14.8874 18.4483 14.9381 18.5296 15.0005 18.6075 15.3663 19.0644 15.7387 19.5135 15.8832 19.687 16.1242 19.9764 16.4855 20.1329 16.8553 20.117c3.8286-.1648 5.55-2.5107 5.8573-2.9828C22.8526 16.919 22.9029 16.6887 22.9023 16.4867 22.8862 11.0873 20.6126 6.69288 20.3618 6.22299 20.2686 6.04849 20.1448 5.9213 20.0223 5.83024c-2.3899-1.77582-4.6825-1.93766-5.2236-1.95079C14.4248 3.87037 14.1018 4.039 13.8908 4.28019 13.7833 4.40298 13.7069 4.53817 13.659 4.67843 12.4808 4.5498 11.3488 4.5684 10.3271 4.681 10.2848 4.54257 10.2137 4.40813 10.1111 4.28494 9.90289 4.03513 9.58304 3.87239 9.22517 3.87894 8.72884 3.88801 6.40341 4.02781 3.9777 5.83024 3.85516 5.9213 3.73139 6.04849 3.63825 6.22299c-.25083.4699-2.5246 4.86461-2.54051 10.26431C1.09715 16.6871 1.14634 16.9155 1.28416 17.1296 1.58866 17.6027 3.29601 19.9515 7.12649 20.1169 7.50079 20.1331 7.86486 19.9726 8.10512 19.6794 8.2521 19.5 8.63516 19.0311 9.00416 18.5683 9.06865 18.4874 9.12057 18.4028 9.16075 18.316 9.32759 18.3546 9.49869 18.391 9.67405 18.4248L9.68004 18.426C11.0465 18.681 12.6626 18.7747 14.4312 18.4443 14.5698 18.4206 14.7086 18.3942 14.8477 18.3649z" stroke="currentcolor" stroke-width="2"/></svg></a><a href=https://github.com/1bl4z3r/hermit-V2/tree/staging target=_blank rel="noopener me" title=X><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path class="st0" d="m21.3 21.1L9.9 2.9H2.7l11.4 18.2zm-18.6.0 7.2-6.6m4.2-5 7.2-6.6"/></svg></a></span><button id=share-btn class=hdr-btn title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share-2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg></button><div id=share-links class="animated fast"><ul><li><a href="https://twitter.com/intent/tweet?hashtags=hermit2&amp;url=https%3a%2f%2fdilagluc.github.io%2fen%2fposts%2f2023%2fcrypto%2faes%2fintro-to-aes%2f&amp;text=Chiffrement%20AES" target=_blank rel=noopener aria-label="Share on X"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path class="st0" d="m21.3 21.1L9.9 2.9H2.7l11.4 18.2zm-18.6.0 7.2-6.6m4.2-5 7.2-6.6"/></svg></a></li><li><a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fdilagluc.github.io%2fen%2fposts%2f2023%2fcrypto%2faes%2fintro-to-aes%2f" target=_blank rel=noopener aria-label="Share on Facebook"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></a></li><li><a href="mailto:?subject=Chiffrement%20AES&amp;body=https%3a%2f%2fdilagluc.github.io%2fen%2fposts%2f2023%2fcrypto%2faes%2fintro-to-aes%2f" target=_self rel=noopener aria-label="Share on Email"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fdilagluc.github.io%2fen%2fposts%2f2023%2fcrypto%2faes%2fintro-to-aes%2f&amp;source=https%3a%2f%2fdilagluc.github.io%2f&amp;title=Chiffrement%20AES&amp;summary=Chiffrement%20AES%2c%20by%20dilag%0a%0aIntroduction%20au%20chiffrement%20AES%0a" target=_blank rel=noopener aria-label="Share on LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li><li><a href=# onclick='return linkShare("Chiffrement AES","https://dilagluc.github.io/en/posts/2023/crypto/aes/intro-to-aes/",`Chiffrement AES, by dilag

Introduction au chiffrement AES
`),!1' target=_self rel=noopener aria-label="Copy Link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg></a></li></ul></div><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://dilagluc.github.io/en/posts/>Posts</a></li><li><a href=https://dilagluc.github.io/en/about-dilag/>About Me</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-date><span>Jul 9, 2023</span></div><h1>Chiffrement AES</h1></header><div class=post-description><p>Introduction au chiffrement AES</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-feather"><path d="M20.24 12.24a6 6 0 00-8.49-8.49L5 10.5V19h8.5z"/><line x1="16" y1="8" x2="2" y2="22"/><line x1="17.5" y1="15" x2="9" y2="15"/></svg><a href=https://dilagluc.github.io/en/about-dilag/ target=_blank>dilag</a></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://dilagluc.github.io/en/tags/crypto>crypto</a></span><span class=tag><a href=https://dilagluc.github.io/en/tags/aes>aes</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>6333&nbspWords … ⏲ Reading Time:28 Minutes, 47 Seconds</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2023-07-09 18:32 +0000</p></div><hr class=post-end><div class=content><p>AES est un chiffrement par bloc basé sur des opérations matricielles. Il existe plusieurs types d&rsquo;implémentation, AES-128, AES-256 etc. et également des modes (ECB, CBC, etc.)</p><h2 id=introduction>Introduction<a href=#introduction class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>AES est un chiffrement par blocs qui peut chiffer et déchiffrer pas moins et pas plus de de 128 bits (16 octets) de message en clair. Le message est donc divisé par bloc de 16 octets. Pour pallier à cette limitation, on utilise un mode d&rsquo;opération (ECB, CBC, CTR etc.) et du padding.
En plus du message en clair de 128 bits, AES utilise également une clé de chiffrement dont la taille peut varier. Ainsi en notant AES-128, on dit indirectement que la clé de chiffrement est de 128 bits. Il existe également AES-192, AES-256 et dont l&rsquo;implémentation diffère légèrement de l&rsquo;AES-128.
Notre objectif ici sera plutôt de se concentrer sur le cœur du chiffrement AES-128 en lui même et non comment l&rsquo;utiliser.
AES est un chiffrement par blocs qui s&rsquo;implémente en plusieurs étapes. Bien que nous verront ici comment il fonctionne et comment c&rsquo;est implémenté, il est fortement déconseillé de faire sa propre implémentation. La raison st toute simple, elle peut être vulnérable. Cela dit, commençons.</p><h2 id=1-prérequis-mathématiques>1. Prérequis mathématiques<a href=#1-pr%c3%a9requis-math%c3%a9matiques class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Certaines transformations AES opèrent sur le corps fini \(GF(2^8)\). Nous verrons d&rsquo;abord comment ce corps est construit et quelques une de ces propriétés.</p><h3 id=11-notions-dalgèbre>1.1 Notions d&rsquo;algèbre<a href=#11-notions-dalg%c3%a8bre class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><h5 id=groupes>Groupes<a href=#groupes class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>Un ensemble \(G\) muni d’une <a href=https://fr.wikipedia.org/wiki/Loi_de_composition_interne>loi interne</a> , notée \(\ast\) par exemple, est appelé un <strong>groupe</strong> ssi cette
loi vérifie les trois axiomes suivants:<br>• La loi \(\ast\) est associative sur \(G\) i.e.</p>$$ \forall x, y, z \in G, x\ast(y\ast z) = (x\ast y)\ast z$$<p>• La loi \(\ast\) possède un élément neutre dans \(G\) i.e.</p>$$\exists e \in G , x\ast e = e\ast x = x $$<p>On dit alors que \(e\) est l&rsquo;élément neutre de \(G\)</p><p>• La loi \(\ast\) est symétrique i.e.</p>$$ \forall x \in G, \exists x’ \in G, x\ast x’=x’\ast x=e$$<p>On dit alors que \(x'\) est le symétrique ou l&rsquo;inverse de \(x\) dans \(G\).</p><p>Un tel groupe est noté \((G,\ast)\) (on lit \(G\) muni de la loi de composition interne \(\ast\) ) ou \(G\).<br>Si de plus la loi \(\ast\) est commutative c&rsquo;est-à-dire pour tout \(x,y \in G\) on a \(x\ast y = y\ast x\) , alors on dit que \(G\) est un groupe commutatif ou encore un groupe abélien.</p><p>Un groupe \(G\) est dit fini si \(card(G)\) est fini où \(card(G)\) c&rsquo;est le nombres d&rsquo;élements de \(G\). Le nombre d’éléments d’un groupe est appelé <strong>ordre</strong> du groupe.</p><p>Un sous-ensemble \(H\) d’un groupe G (\(H \subset G\)) est un <strong>sous-groupe</strong> s’il est lui-même un groupe pour les opérations de \(G\).</p><h5 id=anneaux>Anneaux<a href=#anneaux class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>Un <strong>anneau</strong> \((R,+,\ast)\) est un ensemble \(R\) munis de deux opérations binaires notées \(+\) et \(\ast\) telles que:</p><ul><li>\((R,+)\) est un groupe abélien (dont l’identité (ie l&rsquo;élément neutre) est notée \(0\) ou \(0_R\))</li><li>La loi \(\ast\) est associative sur \(R\)</li><li>Il existe un élément de \(R\), noté \(1\), ou \(1_R\) tel que pour tout \(a\) dans R, \(a\ast 1=1\ast a=a\)</li><li>La loi \(\ast\) est distributive par rapport à la loi \(+\) i.e. \(a\ast (b+c) = (a\ast b)+(a\ast c) et (b+c)\ast a = (b\ast a)+(c\ast a)\).<br>L’anneau est commutatif si la loi \(\ast\) est commutative sur \(R\).</li></ul><h5 id=corps>Corps<a href=#corps class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>Un <strong>corps</strong> est un anneau dans lequel tous les éléments non-nuls ont un inverse pour la
multiplication.</p><h5 id=anneaux-des-polynômes>Anneaux des polynômes<a href=#anneaux-des-polyn%c3%b4mes class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>Supposons que \(R\) est un anneau commutatif, alors un polynôme en \(x\) sur l&rsquo;anneau \(R\) est une expression de la forme:</p>$$ f(x) = a_nx^n + a_{n-1}x^{n-1} + ... + a_1x^1 +a_0$$<p>Si \(R\) est un anneau commutatif, l’anneau des polynômes noté \(R[x]\) est l’anneau formé par l’ensemble des polynômes en \(x\) à coefficients dans R.</p><p>Soit \(K\) un corps et soit \(f(x)\) un polynôme dans \(K[x]\) de degré au moins 1.
On dit que \(f(x)\) est <strong>irréductible</strong> dans \(K[x]\) s’il ne peut pas se décomposer en produit de deux polynômes de \(K[x]\) dont les degrés sont supérieurs ou égaux à \(1\).<br><strong>Exemple</strong>:</p><ul><li>Tous les polynômes de degré \(1\) sont irréductibles. Par conséquent il y a une infinité de
polynômes irréductibles.</li><li>\(X^2−1 = (𝑋 − 1)(𝑋 + 1)\) ∈ \(\mathbb{R}[𝑋]\) est réductible.</li><li>\(X^2+1=(X−i)(X+i)\) est réductible dans \(\mathbb{C}[X]\) mais est irréductible dans \(\mathbb{R}[X]\).</li><li>\(𝑋^2−2=(X−\sqrt{2})(X+\sqrt{2})\) est réductible dans \(\mathbb{R}[X]\) mais est irréductible dans \(\mathbb{Q}[X]\)</li></ul><p>\(𝐾[𝑥]/𝑓(𝑥)\) désigne l’ensemble des polynômes de \(K[x]\) dont le degré est inférieur ou égal à \(n=deg(f(x))\). Les opérations d’addition et de multiplication sont effectuées modulo \(f(x)\).<br>\(𝐾[𝑥]/𝑓(𝑥)\) étant un anneau commutatif, si \(f(x)\) est irréductible sur \(K\), alors
\(𝐾[𝑥]/𝑓(𝑥)\) est un corps.</p><h5 id=corps-finis>Corps finis<a href=#corps-finis class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p><strong>Existence et unicité</strong> : si \(K\) est un corps fini, alors \(K\) contient \(p^n\) éléments où \(p\) est un nombre
premier et \(n\) est un entier strictement positif. Pour tout nombre premier \(p\) et tout entier \(n\), il existe
un unique corps fini (à isomorphisme près) de cardinal \(p^n\) . Ce corps est noté \(\mathbb{F}_{p^n}\).</p><h3 id=12-gf28>1.2 \(GF(2^8)\)<a href=#12-gf28 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>\(GF(2^8)\) est un corps fini avec 256 éléments, aussi appelé <strong>corps de Galois</strong> dont
les coefficients sont dans \(F_2\) et de degré inferieur à 8.
Nous pouvons représenter ce corps par l’ensemble:</p>$$\mathbb{F}_{256} \simeq (\mathbb{F}_2)^8 \simeq \mathbb{F}_2/ (X^8 + X^4 + X^3 + X + 1) $$
$$\underbrace {(X^8 + X^4 + X^3 + X + 1)}_{m(x)} $$<p>Le polynôme \(m(X)\) est irréductible primitif, ainsi, l’isomorphisme existe bien entre les deux ensembles.</p><ul><li>Cet objet mathématique est utilisé pour définir la boîte S ou Sbox dans le chiffrement AES (L&rsquo;étape ShiftColumns et la matrice utilisé dans l&rsquo;étape MixColumn)</li><li>Chaque élément de \(GF(2^8)\) est représenté comme: \(b_7X^7 + b_6X^6 + … + b_1X^1 + b_0\)</li></ul><p><strong>Multiplication dans \(GF(2^8)\)</strong><br>Regardons la multiplication par α. Prenons α, la classe de \(X\), on a:<br></p>$$ m(\alpha) = \alpha^8 + \alpha^4 + \alpha^3 + \alpha + 1 = 0$$
$$ \Leftrightarrow$$
$$\alpha^8 = \alpha^4 + \alpha^3 + \alpha + 1 $$<p>Ainsi, pour appliquer la multiplication de \(\alpha\) par un polynôme en \(\alpha\), il suffira de<br>remplacer le monôme \(\alpha^8\) par \(\alpha^4 + \alpha^3 +\alpha + 1\).</p><h2 id=2--aes---chiffrement>2. AES - Chiffrement<a href=#2--aes---chiffrement class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><h3 id=21-etendre-la-clé-key-expansion>2.1 Etendre la clé (Key Expansion)<a href=#21-etendre-la-cl%c3%a9-key-expansion class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><h4 id=211-présentation>2.1.1 Présentation<a href=#211-pr%c3%a9sentation class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p>Une des transformations utilisé avec l&rsquo;AES est de faire un XOR avec des clés. Un algorithme de cadencement de clé calcule à partir de la clé K une suite de sous-clés de tour comportant toutes 16 octets. Avec l&rsquo;AES-128, on a besoin exactement de générer 11 clés à partir de la clé fourni. Ces clés dérivés de notre clé fournit sont appelées <em>round keys</em> ou <em>subkeys</em>. Le processus de dérivation de clés est appelé <em>key expansion</em> ou <em>key schedule</em>.
Le calcul des sous-clés se fait à partir d’une fonction inversible qui prend en entrée une clé \(K_i\) et un entier et qui sors une clé \(K_{i+1}\) dépendant de \(K_i\).<br>Soit \(K_0\) la clé initiale et \(K_{i+1}\) la clé calculée par la fonction avec les paramètres \(K_i\) et \(i\), \(K_i;C_j\) la colonne \(j\) de la clé \(K_i\) et \(K'\_i\) la copie de la clé \(K_i\).<br>La procédure pour calculer \(K_{i+1}\) en fonction de \(K_i\) est :</p><ul><li>On effectue une rotation de 1 cran vers le haut de \(K'_0 ;C_3\). c&rsquo;est l&rsquo;opération <strong>RotWord</strong></li><li>On applique la fonction S-Box (on détaillera dans la suite) sur chaque octets de cette même colonne. C&rsquo;est l&rsquo;opération <strong>SubWord</strong></li><li>On calcule un XOR entre la première valeur de la colonne \(K'_0;C_3\) et Rcon(i). On détaillera également dans la suite le <strong>Rcon(i)</strong></li><li>On effectue les XOR successifs suivants :<ul><li>\(K_{i+1};C_0 = K'_i;C_3 \oplus Ki;C0\)</li><li>\(K_{i+1};C_1 = K'_i;C_0 \oplus K_i;C_1\)</li><li>\(K_{i+1};C_2 = K'i;C_1 \oplus K_i;C_2\)</li><li>\(K_{i+1};C_3 = K'_i;C_2 \oplus K_i;C_3\)<br>En résumé,<figure><img src=https://dilagluc.github.io/crypto_aes/key_expansion.png></figure></li></ul></li></ul><h4 id=212-détails-des-opérations>2.1.2 Détails des opérations<a href=#212-d%c3%a9tails-des-op%c3%a9rations class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><h5 id=rotword>RotWord<a href=#rotword class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>Comme son nom l&rsquo;indique, c&rsquo;est un décalage circulaire de bas en haut donc il prend une entrée de 4 octets et retourne comme sortie la rotation de ces 4 octets comme ceci.<br></p>$$ \begin{bmatrix}
00 \\\\
01 \\\\
02 \\\\
03
\end{bmatrix} \Leftrightarrow \begin{bmatrix}
01 \\\\
02 \\\\
03 \\\\
00
\end{bmatrix}$$<h5 id=subword>SubWord<a href=#subword class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>Cette transformation consiste à associer à chaque octet en entrée, un unique autre byte en utilisant un mapping appelé <em>Sbox</em>.<br>Cette <em>Sbox</em> s&rsquo;obtient en :</p><ul><li>Prenant l&rsquo;inverse multiplicatif de l&rsquo;octet \(X\) dans \(GF(2^8)\)</li><li>Appliquer ensuite une transformation affine sur cet inverse
\(Sbox(X) = Affine(Inverse(X))\)
Cette transformation affine, en forme matricielle s&rsquo;exprime par:
$$ \begin{bmatrix}
b'_0 \\\\
b'_1 \\\\
b'_2 \\\\
b'_3 \\\\
b'_4 \\\\
b'_5 \\\\
b'_6 \\\\
b'_7
\end{bmatrix} = \begin{bmatrix}
1&0&0&0&1&1&1&1 \\\\
1&1&0&0&0&1&1&1 \\\\
1&1&1&0&0&0&1&1 \\\\
1&1&1&1&0&0&0&1 \\\\
1&1&1&1&1&0&0&0 \\\\
0&1&1&1&1&1&0&0 \\\\
0&0&1&1&1&1&1&0 \\\\
0&0&0&1&1&1&1&1
\end{bmatrix}
\begin{bmatrix}
b_0 \\\\
b_1 \\\\
b_2 \\\\
b_3 \\\\
b_4 \\\\
b_5 \\\\
b_6 \\\\
b_7
\end{bmatrix} +
\begin{bmatrix}
1 \\\\
1 \\\\
0 \\\\
0 \\\\
0 \\\\
1 \\\\
1 \\\\
0
\end{bmatrix}
$$
Voici ce qu&rsquo;on obtient:</li></ul><figure><img src=https://dilagluc.github.io/crypto_aes/sub.png></figure><p>Pour lire cette table :</p><ul><li>les 4 bits les plus significatifs représente la ligne</li><li>les 4 bits moins significatifs représentera la colonne<br>Pour faire simple il suffit de convertir son octet en hexadécimal, puis:</li><li>l&rsquo;octet à gauche représente la ligne</li><li>le deuxième, l&rsquo;octet à droite représentera la colonne<br>On a donc par exemple:</li><li>0F &mdash;&mdash;&ndash;>76</li><li>d5 &mdash;&mdash;&ndash;> 03</li></ul><p>Cette opération rend le chiffrement non-linéaire.
Si on supprime cette opération ou qu’on l&rsquo;identité, notre chiffrement devient caduque et vulnérable.</p><h5 id=3-rcon>3. Rcon<a href=#3-rcon class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>Rcon (Round Constant) est une transformation défini par \(Rcon(i) = [X^{i-1}, 0, 0, 0]\), avec \(i > 0\).
On a donc les valeurs suivantes pour \(1 \leq i \leq 10\) :<br>\(X^0 = 1\)<br>\(X^1 =1\times X^1 + 0\times 1 = 10_2 = 2\)<br>\(X^2 = 1\times X^2 + 0\times X^1 + 0\times 1 = 100_2 = 4\)
&mldr;<br>\(X^7 = 10000000_2 = 128\)<br>\(X^8 = X^4 + X^3 + X + 1 = 11011_2 = 0x1b = 27\) car on est dans \(GF(2^8)\)<br>\(X^9 = X(X^8) = X(X^4 + X^3 + X + 1) = 1\times X^5 + 1\times X^4 + 0\times X^3 + 1\times X^2 + 1\times X + 0 \times 1 = 110110_2 = 0x36 = 54\)</p><h4 id=213-résumé>2.1.3 Résumé<a href=#213-r%c3%a9sum%c3%a9 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p>Prenons un exemple pour mieux clarifier les choses.
Supposons que la clé est <code>00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F</code>. Ce sera notre premier <em>round_key</em>. Pour obtenir les round_key suivant :</p><ul><li><p>stocker la clé dans une matrice \(4 \times 4\)</p>$$ K_0 = \begin{bmatrix}
00&01&02&03 \\\\
04&05&06&07 \\\\
08&09&0A&0B \\\\
0C&0D&0E&0F \\\\
\end{bmatrix} $$</li><li><p>On applique la rotation, la Sbox et Rcon sur la dernière colonne de \(K_0\)():<br></p>$$\begin{bmatrix}
03 \\\\
07 \\\\
0B \\\\
0F \\\\
\end{bmatrix}
\underset{\Longrightarrow}{RotW}
\begin{bmatrix}
07 \\\\
0B \\\\
0F \\\\
03 \\\\
\end{bmatrix}
\underset{\Longrightarrow}{SubW}
\begin{bmatrix}
C5 \\\\
2B \\\\
76 \\\\
7B \\\\
\end{bmatrix}
\oplus
\begin{bmatrix}
Rcon(i=1) \\\\
00 \\\\
00 \\\\
00 \\\\
\end{bmatrix}
\Rightarrow
\begin{bmatrix}
C4 \\\\
2B \\\\
76 \\\\
7B \\\\
\end{bmatrix}= C
$$</li><li><p>On applique ensuite le XOR successif sur les colonnes :</p></li></ul><p>\(C \oplus \text{colonne 0 de } K_0 = K'_0\)<br>\(K'_0 \oplus \text{colonne 1 de } K_0 = K'_1\)<br>\(K'_1 \oplus \text{colonne 2 de } K_0 = K'_2\)<br>\(K'_2 \oplus \text{colonne 3 de } K_0 = K'_3\)<br>Et comme ça on a notre premier <em>round_key</em> où les \(K'_i\) sont les colonnes de notre nouvelle clé puis on répète les mêmes opérations suur cett nouvelle clé pour obtenir le deuxième <em>round_key</em> et ainsi de suite.<br>Si on effectue \(i\) tours de l’AES, on a à calculer \(i\) <em>round_key</em>, et donc avoir \(i + 1\) clés.<br>AES-128 à 10 tours \(\Longrightarrow\) \(11\) *round_keys *
L&rsquo;extension de la clé \(K_0\), est une fonction inversible. Chaque étape peut être inversée grâce aux XOR, à l’inverse de la Sbox et à Rcon qui donne toujours la même image en fonction du tour.<br>Donc si l’on trouve \(K_i\), c&rsquo;est-à-dire on trouve une sous clé du \(i^{ème}\) tours et que l’on connaît la valeur de \(i\), alors on peut remonter jusqu’à la clé \(K_0\).</p><h4 id=214-implémentation>2.1.4 Implémentation<a href=#214-impl%c3%a9mentation class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p>Voici une implémentation simple de chaque étape:
<a href=/crypto_aes/key_expansion.py>aes_key_expension.py</a><div class="tabs tabs-left"><style>.tabs input#tab-0-0:checked~.tab-content-0-0{display:block}</style><input type=radio class=tab-input name=tab-select-0 id=tab-0-0 checked>
<label for=tab-0-0 class=tab-label>RotWord</label><div class="tab-content tab-content-0-0"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rotword</span>(word<span style=color:#f92672>=</span>[]):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(word) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>4</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Wrong length: </span><span style=color:#e6db74>{</span>len(word)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>return</span> bytes(np<span style=color:#f92672>.</span>roll(list(word), <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>tolist())
</span></span></code></pre></div></div><style>.tabs input#tab-0-1:checked~.tab-content-0-1{display:block}</style><input type=radio class=tab-input name=tab-select-0 id=tab-0-1>
<label for=tab-0-1 class=tab-label>SubWord</label><div class="tab-content tab-content-0-1"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>S_BOX <span style=color:#f92672>=</span> [  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0x7c</span>, <span style=color:#ae81ff>0x77</span>, <span style=color:#ae81ff>0x7b</span>, <span style=color:#ae81ff>0xf2</span>, <span style=color:#ae81ff>0x6b</span>, <span style=color:#ae81ff>0x6f</span>, <span style=color:#ae81ff>0xc5</span>, <span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x67</span>, <span style=color:#ae81ff>0x2b</span>, <span style=color:#ae81ff>0xfe</span>, <span style=color:#ae81ff>0xd7</span>, <span style=color:#ae81ff>0xab</span>, <span style=color:#ae81ff>0x76</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0xca</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0xc9</span>, <span style=color:#ae81ff>0x7d</span>, <span style=color:#ae81ff>0xfa</span>, <span style=color:#ae81ff>0x59</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0xf0</span>, <span style=color:#ae81ff>0xad</span>, <span style=color:#ae81ff>0xd4</span>, <span style=color:#ae81ff>0xa2</span>, <span style=color:#ae81ff>0xaf</span>, <span style=color:#ae81ff>0x9c</span>, <span style=color:#ae81ff>0xa4</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0xc0</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0xb7</span>, <span style=color:#ae81ff>0xfd</span>, <span style=color:#ae81ff>0x93</span>, <span style=color:#ae81ff>0x26</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x3f</span>, <span style=color:#ae81ff>0xf7</span>, <span style=color:#ae81ff>0xcc</span>, <span style=color:#ae81ff>0x34</span>, <span style=color:#ae81ff>0xa5</span>, <span style=color:#ae81ff>0xe5</span>, <span style=color:#ae81ff>0xf1</span>, <span style=color:#ae81ff>0x71</span>, <span style=color:#ae81ff>0xd8</span>, <span style=color:#ae81ff>0x31</span>, <span style=color:#ae81ff>0x15</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0xc7</span>, <span style=color:#ae81ff>0x23</span>, <span style=color:#ae81ff>0xc3</span>, <span style=color:#ae81ff>0x18</span>, <span style=color:#ae81ff>0x96</span>, <span style=color:#ae81ff>0x05</span>, <span style=color:#ae81ff>0x9a</span>, <span style=color:#ae81ff>0x07</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0xe2</span>, <span style=color:#ae81ff>0xeb</span>, <span style=color:#ae81ff>0x27</span>, <span style=color:#ae81ff>0xb2</span>, <span style=color:#ae81ff>0x75</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0x09</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x2c</span>, <span style=color:#ae81ff>0x1a</span>, <span style=color:#ae81ff>0x1b</span>, <span style=color:#ae81ff>0x6e</span>, <span style=color:#ae81ff>0x5a</span>, <span style=color:#ae81ff>0xa0</span>, <span style=color:#ae81ff>0x52</span>, <span style=color:#ae81ff>0x3b</span>, <span style=color:#ae81ff>0xd6</span>, <span style=color:#ae81ff>0xb3</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0xe3</span>, <span style=color:#ae81ff>0x2f</span>, <span style=color:#ae81ff>0x84</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0xd1</span>, <span style=color:#ae81ff>0x00</span>, <span style=color:#ae81ff>0xed</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0xfc</span>, <span style=color:#ae81ff>0xb1</span>, <span style=color:#ae81ff>0x5b</span>, <span style=color:#ae81ff>0x6a</span>, <span style=color:#ae81ff>0xcb</span>, <span style=color:#ae81ff>0xbe</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x4a</span>, <span style=color:#ae81ff>0x4c</span>, <span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0xcf</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0xd0</span>, <span style=color:#ae81ff>0xef</span>, <span style=color:#ae81ff>0xaa</span>, <span style=color:#ae81ff>0xfb</span>, <span style=color:#ae81ff>0x43</span>, <span style=color:#ae81ff>0x4d</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x85</span>, <span style=color:#ae81ff>0x45</span>, <span style=color:#ae81ff>0xf9</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x7f</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#ae81ff>0x3c</span>, <span style=color:#ae81ff>0x9f</span>, <span style=color:#ae81ff>0xa8</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0x51</span>, <span style=color:#ae81ff>0xa3</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x8f</span>, <span style=color:#ae81ff>0x92</span>, <span style=color:#ae81ff>0x9d</span>, <span style=color:#ae81ff>0x38</span>, <span style=color:#ae81ff>0xf5</span>, <span style=color:#ae81ff>0xbc</span>, <span style=color:#ae81ff>0xb6</span>, <span style=color:#ae81ff>0xda</span>, <span style=color:#ae81ff>0x21</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0xff</span>, <span style=color:#ae81ff>0xf3</span>, <span style=color:#ae81ff>0xd2</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0xcd</span>, <span style=color:#ae81ff>0x0c</span>, <span style=color:#ae81ff>0x13</span>, <span style=color:#ae81ff>0xec</span>, <span style=color:#ae81ff>0x5f</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x44</span>, <span style=color:#ae81ff>0x17</span>, <span style=color:#ae81ff>0xc4</span>, <span style=color:#ae81ff>0xa7</span>, <span style=color:#ae81ff>0x7e</span>, <span style=color:#ae81ff>0x3d</span>, <span style=color:#ae81ff>0x64</span>, <span style=color:#ae81ff>0x5d</span>, <span style=color:#ae81ff>0x19</span>, <span style=color:#ae81ff>0x73</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0x60</span>, <span style=color:#ae81ff>0x81</span>, <span style=color:#ae81ff>0x4f</span>, <span style=color:#ae81ff>0xdc</span>, <span style=color:#ae81ff>0x22</span>, <span style=color:#ae81ff>0x2a</span>, <span style=color:#ae81ff>0x90</span>, <span style=color:#ae81ff>0x88</span>, <span style=color:#ae81ff>0x46</span>, <span style=color:#ae81ff>0xee</span>, <span style=color:#ae81ff>0xb8</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0xde</span>, <span style=color:#ae81ff>0x5e</span>, <span style=color:#ae81ff>0x0b</span>, <span style=color:#ae81ff>0xdb</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0xe0</span>, <span style=color:#ae81ff>0x32</span>, <span style=color:#ae81ff>0x3a</span>, <span style=color:#ae81ff>0x0a</span>, <span style=color:#ae81ff>0x49</span>, <span style=color:#ae81ff>0x06</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x5c</span>, <span style=color:#ae81ff>0xc2</span>, <span style=color:#ae81ff>0xd3</span>, <span style=color:#ae81ff>0xac</span>, <span style=color:#ae81ff>0x62</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x95</span>, <span style=color:#ae81ff>0xe4</span>, <span style=color:#ae81ff>0x79</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0xe7</span>, <span style=color:#ae81ff>0xc8</span>, <span style=color:#ae81ff>0x37</span>, <span style=color:#ae81ff>0x6d</span>, <span style=color:#ae81ff>0x8d</span>, <span style=color:#ae81ff>0xd5</span>, <span style=color:#ae81ff>0x4e</span>, <span style=color:#ae81ff>0xa9</span>, <span style=color:#ae81ff>0x6c</span>, <span style=color:#ae81ff>0x56</span>, <span style=color:#ae81ff>0xf4</span>, <span style=color:#ae81ff>0xea</span>, <span style=color:#ae81ff>0x65</span>, <span style=color:#ae81ff>0x7a</span>, <span style=color:#ae81ff>0xae</span>, <span style=color:#ae81ff>0x08</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0xba</span>, <span style=color:#ae81ff>0x78</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x2e</span>, <span style=color:#ae81ff>0x1c</span>, <span style=color:#ae81ff>0xa6</span>, <span style=color:#ae81ff>0xb4</span>, <span style=color:#ae81ff>0xc6</span>, <span style=color:#ae81ff>0xe8</span>, <span style=color:#ae81ff>0xdd</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0x1f</span>, <span style=color:#ae81ff>0x4b</span>, <span style=color:#ae81ff>0xbd</span>, <span style=color:#ae81ff>0x8b</span>, <span style=color:#ae81ff>0x8a</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0x70</span>, <span style=color:#ae81ff>0x3e</span>, <span style=color:#ae81ff>0xb5</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0x48</span>, <span style=color:#ae81ff>0x03</span>, <span style=color:#ae81ff>0xf6</span>, <span style=color:#ae81ff>0x0e</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x57</span>, <span style=color:#ae81ff>0xb9</span>, <span style=color:#ae81ff>0x86</span>, <span style=color:#ae81ff>0xc1</span>, <span style=color:#ae81ff>0x1d</span>, <span style=color:#ae81ff>0x9e</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0xe1</span>, <span style=color:#ae81ff>0xf8</span>, <span style=color:#ae81ff>0x98</span>, <span style=color:#ae81ff>0x11</span>, <span style=color:#ae81ff>0x69</span>, <span style=color:#ae81ff>0xd9</span>, <span style=color:#ae81ff>0x8e</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x9b</span>, <span style=color:#ae81ff>0x1e</span>, <span style=color:#ae81ff>0x87</span>, <span style=color:#ae81ff>0xe9</span>, <span style=color:#ae81ff>0xce</span>, <span style=color:#ae81ff>0x55</span>, <span style=color:#ae81ff>0x28</span>, <span style=color:#ae81ff>0xdf</span>],  
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>0x8c</span>, <span style=color:#ae81ff>0xa1</span>, <span style=color:#ae81ff>0x89</span>, <span style=color:#ae81ff>0x0d</span>, <span style=color:#ae81ff>0xbf</span>, <span style=color:#ae81ff>0xe6</span>, <span style=color:#ae81ff>0x42</span>, <span style=color:#ae81ff>0x68</span>, <span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x99</span>, <span style=color:#ae81ff>0x2d</span>, <span style=color:#ae81ff>0x0f</span>, <span style=color:#ae81ff>0xb0</span>, <span style=color:#ae81ff>0x54</span>, <span style=color:#ae81ff>0xbb</span>, <span style=color:#ae81ff>0x16</span>],  
</span></span><span style=display:flex><span>]  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_sbox_map</span>():  
</span></span><span style=display:flex><span>    sbox_map <span style=color:#f92672>=</span> {}  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0x100</span>):  
</span></span><span style=display:flex><span>        msb <span style=color:#f92672>=</span> i <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>4</span>  
</span></span><span style=display:flex><span>        lsb <span style=color:#f92672>=</span> i <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x0f</span>  
</span></span><span style=display:flex><span>        sbox_map[i] <span style=color:#f92672>=</span> S_BOX[msb][lsb]  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sbox_map  
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>subword</span>(word<span style=color:#f92672>=</span>[], sbox_map<span style=color:#f92672>=</span>get_sbox_map()):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(word) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>4</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Wrong length: </span><span style=color:#e6db74>{</span>len(word)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [sbox_map[i] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> word]
</span></span></code></pre></div></div><style>.tabs input#tab-0-2:checked~.tab-content-0-2{display:block}</style><input type=radio class=tab-input name=tab-select-0 id=tab-0-2>
<label for=tab-0-2 class=tab-label>Rcon</label><div class="tab-content tab-content-0-2"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># on utilisera directement un mapping comme Sbox</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rcon</span>(n<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;=</span> n <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>256</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Wrong n: </span><span style=color:#e6db74>{</span>n<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> bytes([RCON_TABLE[n], <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># D&#39;après le standard NIST le Rcon commence toujours par 1, mais dans certaines implémentations de AES, on trouve Rcon(0) = 0x8d (je ne sais toujours pas comment ça s&#39;obtient), ici je le mets mais faut savoir qu&#39;on l&#39;atteindra jamais car nos i commence à 1 donc voilà</span>
</span></span><span style=display:flex><span>RCON_TABLE <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x8D</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x1B</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x6C</span>, <span style=color:#ae81ff>0xD8</span>, <span style=color:#ae81ff>0xAB</span>, <span style=color:#ae81ff>0x4D</span>, <span style=color:#ae81ff>0x9A</span>, <span style=color:#ae81ff>0x2F</span>, <span style=color:#ae81ff>0x5E</span>, <span style=color:#ae81ff>0xBC</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0xC6</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x6A</span>, <span style=color:#ae81ff>0xD4</span>, <span style=color:#ae81ff>0xB3</span>,<span style=color:#ae81ff>0x7D</span>,<span style=color:#ae81ff>0xFA</span>, <span style=color:#ae81ff>0xEF</span>, <span style=color:#ae81ff>0xC5</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0xE4</span>, <span style=color:#ae81ff>0xD3</span>, <span style=color:#ae81ff>0xBD</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0xC2</span>, <span style=color:#ae81ff>0x9F</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x4A</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0xCC</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x1D</span>, <span style=color:#ae81ff>0x3A</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0xE8</span>, <span style=color:#ae81ff>0xCB</span>, <span style=color:#ae81ff>0x8D</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x1B</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x6C</span>, <span style=color:#ae81ff>0xD8</span>, <span style=color:#ae81ff>0xAB</span>, <span style=color:#ae81ff>0x4D</span>, <span style=color:#ae81ff>0x9A</span>, <span style=color:#ae81ff>0x2F</span>, <span style=color:#ae81ff>0x5E</span>, <span style=color:#ae81ff>0xBC</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0xC6</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x6A</span>, <span style=color:#ae81ff>0xD4</span>, <span style=color:#ae81ff>0xB3</span>, <span style=color:#ae81ff>0x7D</span>, <span style=color:#ae81ff>0xFA</span>, <span style=color:#ae81ff>0xEF</span>, <span style=color:#ae81ff>0xC5</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0xE4</span>, <span style=color:#ae81ff>0xD3</span>, <span style=color:#ae81ff>0xBD</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0xC2</span>, <span style=color:#ae81ff>0x9F</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x4A</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0xCC</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x1D</span>, <span style=color:#ae81ff>0x3A</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0xE8</span>, <span style=color:#ae81ff>0xCB</span>, <span style=color:#ae81ff>0x8D</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x1B</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x6C</span>, <span style=color:#ae81ff>0xD8</span>, <span style=color:#ae81ff>0xAB</span>, <span style=color:#ae81ff>0x4D</span>, <span style=color:#ae81ff>0x9A</span>, <span style=color:#ae81ff>0x2F</span>, <span style=color:#ae81ff>0x5E</span>, <span style=color:#ae81ff>0xBC</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0xC6</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x6A</span>, <span style=color:#ae81ff>0xD4</span>, <span style=color:#ae81ff>0xB3</span>, <span style=color:#ae81ff>0x7D</span>, <span style=color:#ae81ff>0xFA</span>, <span style=color:#ae81ff>0xEF</span>, <span style=color:#ae81ff>0xC5</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0xE4</span>, <span style=color:#ae81ff>0xD3</span>, <span style=color:#ae81ff>0xBD</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0xC2</span>, <span style=color:#ae81ff>0x9F</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x4A</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0xCC</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x1D</span>, <span style=color:#ae81ff>0x3A</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0xE8</span>, <span style=color:#ae81ff>0xCB</span>, <span style=color:#ae81ff>0x8D</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x1B</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x6C</span>, <span style=color:#ae81ff>0xD8</span>, <span style=color:#ae81ff>0xAB</span>, <span style=color:#ae81ff>0x4D</span>, <span style=color:#ae81ff>0x9A</span>, <span style=color:#ae81ff>0x2F</span>, <span style=color:#ae81ff>0x5E</span>, <span style=color:#ae81ff>0xBC</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0xC6</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x6A</span>, <span style=color:#ae81ff>0xD4</span>, <span style=color:#ae81ff>0xB3</span>, <span style=color:#ae81ff>0x7D</span>, <span style=color:#ae81ff>0xFA</span>, <span style=color:#ae81ff>0xEF</span>, <span style=color:#ae81ff>0xC5</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0xE4</span>, <span style=color:#ae81ff>0xD3</span>, <span style=color:#ae81ff>0xBD</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0xC2</span>, <span style=color:#ae81ff>0x9F</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x4A</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0xCC</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x1D</span>, <span style=color:#ae81ff>0x3A</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0xE8</span>, <span style=color:#ae81ff>0xCB</span>, <span style=color:#ae81ff>0x8D</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x1B</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x6C</span>, <span style=color:#ae81ff>0xD8</span>, <span style=color:#ae81ff>0xAB</span>, <span style=color:#ae81ff>0x4D</span>, <span style=color:#ae81ff>0x9A</span>, <span style=color:#ae81ff>0x2F</span>, <span style=color:#ae81ff>0x5E</span>, <span style=color:#ae81ff>0xBC</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0xC6</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x6A</span>, <span style=color:#ae81ff>0xD4</span>, <span style=color:#ae81ff>0xB3</span>, <span style=color:#ae81ff>0x7D</span>, <span style=color:#ae81ff>0xFA</span>, <span style=color:#ae81ff>0xEF</span>, <span style=color:#ae81ff>0xC5</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0xE4</span>, <span style=color:#ae81ff>0xD3</span>, <span style=color:#ae81ff>0xBD</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0xC2</span>, <span style=color:#ae81ff>0x9F</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x4A</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0xCC</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x1D</span>, <span style=color:#ae81ff>0x3A</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0xE8</span>, <span style=color:#ae81ff>0xCB</span>, <span style=color:#ae81ff>0x8D</span>]
</span></span></code></pre></div></div><style>.tabs input#tab-0-3:checked~.tab-content-0-3{display:block}</style><input type=radio class=tab-input name=tab-select-0 id=tab-0-3>
<label for=tab-0-3 class=tab-label>KeyExpansion</label><div class="tab-content tab-content-0-3"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># code inspiré de https://github.com/thomasperrot/aes-square-attack/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>key_expension</span>(key<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;&#39;</span>, rounds<span style=color:#f92672>=</span><span style=color:#ae81ff>11</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(key) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>16</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Wrong key length: </span><span style=color:#e6db74>{</span>len(key)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    key_mat <span style=color:#f92672>=</span> [key[i : i <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(key), <span style=color:#ae81ff>4</span>)]
</span></span><span style=display:flex><span>    expended_key <span style=color:#f92672>=</span> key_mat
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> r <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, rounds):
</span></span><span style=display:flex><span>        rotword <span style=color:#f92672>=</span> rotword(expended_key[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>        subword <span style=color:#f92672>=</span> subword(rot)
</span></span><span style=display:flex><span>        first_column <span style=color:#f92672>=</span> xor(sub, expended_key[<span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>], rcon(r))
</span></span><span style=display:flex><span>        expended_key<span style=color:#f92672>.</span>append(first_column)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>3</span>):
</span></span><span style=display:flex><span>            expended_key<span style=color:#f92672>.</span>append(xor(expended_key[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>], expended_key[<span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>]))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> expended_key
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>reverse_key_expension</span>(expended_key<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;&#39;</span>, rounds<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> r <span style=color:#f92672>in</span> reversed(range(<span style=color:#ae81ff>1</span>, rounds)):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>3</span>):
</span></span><span style=display:flex><span>            expended_key<span style=color:#f92672>.</span>insert(<span style=color:#ae81ff>0</span>, xor(expended_key[<span style=color:#ae81ff>2</span>], expended_key[<span style=color:#ae81ff>3</span>]))
</span></span><span style=display:flex><span>        rotword <span style=color:#f92672>=</span> rotword(expended_key[<span style=color:#ae81ff>2</span>])
</span></span><span style=display:flex><span>        subword <span style=color:#f92672>=</span> subword(rot)
</span></span><span style=display:flex><span>        first_column <span style=color:#f92672>=</span> xor(expended_key[<span style=color:#ae81ff>3</span>], rcon(r), sub)
</span></span><span style=display:flex><span>        expended_key<span style=color:#f92672>.</span>insert(<span style=color:#ae81ff>0</span>, first_column)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> expended_key
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#75715e># get key from known round_keys and round</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_first_key</span>(key<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;&#39;</span>, rounds<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(key) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>16</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Wrong key length: </span><span style=color:#e6db74>{</span>len(key)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    expended_key <span style=color:#f92672>=</span> [key[i : i <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(key), <span style=color:#ae81ff>4</span>)]
</span></span><span style=display:flex><span>    fully_expended_key <span style=color:#f92672>=</span> reverse_key_expension(expended_key, rounds)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>.</span>join(fully_expended_key[:<span style=color:#ae81ff>4</span>])
</span></span></code></pre></div></div></div></p><h3 id=22-chiffrement-proprement-dit>2.2 Chiffrement proprement dit<a href=#22-chiffrement-proprement-dit class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Une fois les <em>round_keys</em> obtenus, on va passer à l&rsquo;étape du chiffrement du texte en clair.
Le texte à chiffrer est découpé en blocs de 16 octets et, pour chaque bloc clair, on effectue des opérations pour produire un bloc chiffré de même longueur.
Chaque bloc de 16 octets est représenté en interne par une matrice \(4 \times 4\). Cette représentation est appelé <strong>état (state en anglais)</strong> et les différentes transformations qu&rsquo;il subit sont regroupés en <strong>tours(round en anglais)</strong>, chaque tour impliquant à chaque fois un round_key différent. La représentation se fait en colonnes et non en lignes. On va maintenant s&rsquo;attaquer aux différentes transformations subit.</p><h4 id=221-détails-des-opérations>2.2.1 Détails des opérations<a href=#221-d%c3%a9tails-des-op%c3%a9rations class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p>Voici toutes les opérations effectuées sur le <em>state</em>, classées par ordre:</p><ul><li>SubBytes</li><li>ShiftRows</li><li>MixColumns</li><li>AddRoundKey
Et c&rsquo;est toutes ces opérations qui constituent un tour d&rsquo;AES(round). Chaque tour prend en entrée une sous-clé différente and la sortie du tour précédent. En AES-128, on a au total 10 tours. Notez que le dernier tour n&rsquo;applique pas le <em>MixColumns</em>. Et aussi avant le premier tour l&rsquo;opération <em>AddroundKey</em> est effectué.</li></ul><h5 id=1-subbytes>1. SubBytes<a href=#1-subbytes class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p><strong>SubBytes</strong> est une fonction non linéaire qui opère indépendamment sur chacun des 16 octets. Elle utilise une opération sur le corps fini à 256 éléments. C&rsquo;est aussi une <em>Sbox</em> comme dans l&rsquo;opération <em>subword</em>. La bonne nouvelle ici, c&rsquo;est que c&rsquo;est la même <em>Sbox</em> qui est utilisé.</p><h5 id=2-shiftrows>2. ShiftRows<a href=#2-shiftrows class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p><strong>ShiftRows</strong> est une permutation circulaire vers la gauche de \(i\) cases pour la ligne numéro \(i\) avec \(0 \leq i \leq 3\).<figure><img src=https://dilagluc.github.io/crypto_aes/shiftrows.png></figure></p><h5 id=3-mixcolumns>3. MixColumns<a href=#3-mixcolumns class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p><strong>MixColumns</strong> est un produit matriciel à coefficient dans \(F_{256}\). Pour chaque colonne on applique une multiplication par une matrice. Soit la matrice A l’entrée du MixColumns et la matrice B le résultat de la fonction. Alors \(M × A = B\) avec</p>$$M = \begin{bmatrix}
\alpha&\alpha+1&1&1 \\\\
1&\alpha&\alpha+1&1 \\\\
1&1&\alpha&\alpha+1 \\\\
\alpha+1&1&1&\alpha \\\\
\end{bmatrix} $$<p>Or dans \((F_2)^8\) chaque élément s&rsquo;écrit \({\displaystyle \sum_{i=0}^7}b_i\alpha ^{i}\)
et donc pour avoir alpha tous les \(b_i\) à \(0\) sauf à \(i=1\) ainsi l&rsquo;octet qui code \(\alpha\) est donc \((0,0,0,0,0,0,1,0) = 2\).<br>M devient alors</p>$$M = \begin{bmatrix}
2&3&1&1 \\\\
1&2&3&1 \\\\
1&1&2&3 \\\\
3&1&1&2 \\\\
\end{bmatrix} $$<p>Ces additions et multiplications se font dans le copts fini à 256 éléments. On peut également précalculer une table de mapping pour ces multiplications et l&rsquo;addition remplacée par un simple XOR.</p><h5 id=4-addroundkey>4. AddRoundKey<a href=#4-addroundkey class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p><strong>AddRoundKey</strong> est juste un XOR de la clé de tour \(K_i\) avec la matrice, c&rsquo;est une addition case par case.</p><h4 id=222-résumé>2.2.2 Résumé<a href=#222-r%c3%a9sum%c3%a9 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p>Pour résumer, voici un aperçu des différentes phases du chiffrement AES:<br>1.Key expansion ou Key Schedule<br>Pour une clé de 128 bits, 11 <em>sous-clés</em> différentes de 128 bit appelées aussi &ldquo;round keys&rdquo; sont dérivés. Chacun d&rsquo;eux sera utilisé à l&rsquo;étape AddRoundKey.<br>2. Première addition de clé<br><em>AddRoundKey</em> - les octets de la première sous-clé sont XORés avec les octets de <em>l&rsquo;état(state)</em>, le state étant un bloc du message en clair écrit sous forme de matrix 4x4.<br>3. Tours (rounds)<br>Cette phase s&rsquo;effectue10 fois, 9 pour les tours principaux et une dernière pour le &ldquo;dernier tour&rdquo;:<br>  a) <em>SubBytes</em> - chaque octet du <em>state</em> est subtitué par un octet différent en utilisant le mapping Sbox.<br>  b) <em>ShiftRows</em> - les 3 dernières lignes du <em>state</em> subissent un décalage circulaire respectivement de 1, 2 et 3 lignes.<br>  c) <em>MixColumns</em> - une multiplication matricielle est effectué sur chaque colonne du <em>state</em>. Cette opération n&rsquo;est pas effectué pour le dernier tour.<br>  d) <em>AddRoundKey</em> - les octets de la sous-clé actuelle sont XORés avec les octets du <em>state</em>.</p><h4 id=222-implémentation>2.2.2 Implémentation<a href=#222-impl%c3%a9mentation class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p>Implémentation finale:
<a href=/crypto_aes/aes_encrypt.py>aes_encrypt.py</a></p><div class="tabs tabs-left"><style>.tabs input#tab-1-0:checked~.tab-content-1-0{display:block}</style><input type=radio class=tab-input name=tab-select-1 id=tab-1-0 checked>
<label for=tab-1-0 class=tab-label>State representation</label><div class="tab-content tab-content-1-0"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>tostate</span>(plaintext<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;&#39;</span>):
</span></span><span style=display:flex><span>	state <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array(list(plaintext), dtype<span style=color:#f92672>=</span>int)
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>reshape(state, (<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>), order<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;F&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> state
</span></span></code></pre></div></div><style>.tabs input#tab-1-1:checked~.tab-content-1-1{display:block}</style><input type=radio class=tab-input name=tab-select-1 id=tab-1-1>
<label for=tab-1-1 class=tab-label>subByte</label><div class="tab-content tab-content-1-1"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># https://github.com/thomasperrot/aes-square-attack</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>subbytes</span>(state: array, sbox_map<span style=color:#f92672>=</span>get_sbox_map()):
</span></span><span style=display:flex><span>    new_state <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>zeros((<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>), dtype<span style=color:#f92672>=</span>int)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>            new_state[i, j] <span style=color:#f92672>=</span> sbox_map[state[i, j]]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new_state
</span></span></code></pre></div></div><style>.tabs input#tab-1-2:checked~.tab-content-1-2{display:block}</style><input type=radio class=tab-input name=tab-select-1 id=tab-1-2>
<label for=tab-1-2 class=tab-label>ShiftRows</label><div class="tab-content tab-content-1-2"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># https://github.com/thomasperrot/aes-square-attack</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>shiftrows</span>(state: array):
</span></span><span style=display:flex><span>    new_state <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array(state, dtype<span style=color:#f92672>=</span>int)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        new_state[i] <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>roll(new_state[i], <span style=color:#f92672>-</span>i)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new_state
</span></span></code></pre></div></div><style>.tabs input#tab-1-3:checked~.tab-content-1-3{display:block}</style><input type=radio class=tab-input name=tab-select-1 id=tab-1-3>
<label for=tab-1-3 class=tab-label>MixColumns</label><div class="tab-content tab-content-1-3"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># mapping multiplication par 2 et 3</span>
</span></span><span style=display:flex><span>MULTIPLICATION_BY_2 <span style=color:#f92672>=</span> { <span style=color:#ae81ff>0</span>: <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>: <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>: <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>3</span>: <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>4</span>: <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>5</span>: <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>6</span>: <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>7</span>: <span style=color:#ae81ff>14</span>, <span style=color:#ae81ff>8</span>: <span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>9</span>: <span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>10</span>: <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>11</span>: <span style=color:#ae81ff>22</span>, <span style=color:#ae81ff>12</span>: <span style=color:#ae81ff>24</span>, <span style=color:#ae81ff>13</span>: <span style=color:#ae81ff>26</span>, <span style=color:#ae81ff>14</span>: <span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>15</span>: <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>16</span>: <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>17</span>: <span style=color:#ae81ff>34</span>, <span style=color:#ae81ff>18</span>: <span style=color:#ae81ff>36</span>, <span style=color:#ae81ff>19</span>: <span style=color:#ae81ff>38</span>, <span style=color:#ae81ff>20</span>: <span style=color:#ae81ff>40</span>, <span style=color:#ae81ff>21</span>: <span style=color:#ae81ff>42</span>, <span style=color:#ae81ff>22</span>: <span style=color:#ae81ff>44</span>, <span style=color:#ae81ff>23</span>: <span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>24</span>: <span style=color:#ae81ff>48</span>, <span style=color:#ae81ff>25</span>: <span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>26</span>: <span style=color:#ae81ff>52</span>, <span style=color:#ae81ff>27</span>: <span style=color:#ae81ff>54</span>, <span style=color:#ae81ff>28</span>: <span style=color:#ae81ff>56</span>, <span style=color:#ae81ff>29</span>: <span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>30</span>: <span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>31</span>: <span style=color:#ae81ff>62</span>, <span style=color:#ae81ff>32</span>: <span style=color:#ae81ff>64</span>, <span style=color:#ae81ff>33</span>: <span style=color:#ae81ff>66</span>, <span style=color:#ae81ff>34</span>: <span style=color:#ae81ff>68</span>, <span style=color:#ae81ff>35</span>: <span style=color:#ae81ff>70</span>, <span style=color:#ae81ff>36</span>: <span style=color:#ae81ff>72</span>, <span style=color:#ae81ff>37</span>: <span style=color:#ae81ff>74</span>, <span style=color:#ae81ff>38</span>: <span style=color:#ae81ff>76</span>, <span style=color:#ae81ff>39</span>: <span style=color:#ae81ff>78</span>, <span style=color:#ae81ff>40</span>: <span style=color:#ae81ff>80</span>, <span style=color:#ae81ff>41</span>: <span style=color:#ae81ff>82</span>, <span style=color:#ae81ff>42</span>: <span style=color:#ae81ff>84</span>, <span style=color:#ae81ff>43</span>: <span style=color:#ae81ff>86</span>, <span style=color:#ae81ff>44</span>: <span style=color:#ae81ff>88</span>, <span style=color:#ae81ff>45</span>: <span style=color:#ae81ff>90</span>, <span style=color:#ae81ff>46</span>: <span style=color:#ae81ff>92</span>, <span style=color:#ae81ff>47</span>: <span style=color:#ae81ff>94</span>, <span style=color:#ae81ff>48</span>: <span style=color:#ae81ff>96</span>, <span style=color:#ae81ff>49</span>: <span style=color:#ae81ff>98</span>, <span style=color:#ae81ff>50</span>: <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>51</span>: <span style=color:#ae81ff>102</span>, <span style=color:#ae81ff>52</span>: <span style=color:#ae81ff>104</span>, <span style=color:#ae81ff>53</span>: <span style=color:#ae81ff>106</span>, <span style=color:#ae81ff>54</span>: <span style=color:#ae81ff>108</span>, <span style=color:#ae81ff>55</span>: <span style=color:#ae81ff>110</span>, <span style=color:#ae81ff>56</span>: <span style=color:#ae81ff>112</span>, <span style=color:#ae81ff>57</span>: <span style=color:#ae81ff>114</span>, <span style=color:#ae81ff>58</span>: <span style=color:#ae81ff>116</span>, <span style=color:#ae81ff>59</span>: <span style=color:#ae81ff>118</span>, <span style=color:#ae81ff>60</span>: <span style=color:#ae81ff>120</span>, <span style=color:#ae81ff>61</span>: <span style=color:#ae81ff>122</span>, <span style=color:#ae81ff>62</span>: <span style=color:#ae81ff>124</span>, <span style=color:#ae81ff>63</span>: <span style=color:#ae81ff>126</span>, <span style=color:#ae81ff>64</span>: <span style=color:#ae81ff>128</span>, <span style=color:#ae81ff>65</span>: <span style=color:#ae81ff>130</span>, <span style=color:#ae81ff>66</span>: <span style=color:#ae81ff>132</span>, <span style=color:#ae81ff>67</span>: <span style=color:#ae81ff>134</span>, <span style=color:#ae81ff>68</span>: <span style=color:#ae81ff>136</span>, <span style=color:#ae81ff>69</span>: <span style=color:#ae81ff>138</span>, <span style=color:#ae81ff>70</span>: <span style=color:#ae81ff>140</span>, <span style=color:#ae81ff>71</span>: <span style=color:#ae81ff>142</span>, <span style=color:#ae81ff>72</span>: <span style=color:#ae81ff>144</span>, <span style=color:#ae81ff>73</span>: <span style=color:#ae81ff>146</span>, <span style=color:#ae81ff>74</span>: <span style=color:#ae81ff>148</span>, <span style=color:#ae81ff>75</span>: <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>76</span>: <span style=color:#ae81ff>152</span>, <span style=color:#ae81ff>77</span>: <span style=color:#ae81ff>154</span>, <span style=color:#ae81ff>78</span>: <span style=color:#ae81ff>156</span>, <span style=color:#ae81ff>79</span>: <span style=color:#ae81ff>158</span>, <span style=color:#ae81ff>80</span>: <span style=color:#ae81ff>160</span>, <span style=color:#ae81ff>81</span>: <span style=color:#ae81ff>162</span>, <span style=color:#ae81ff>82</span>: <span style=color:#ae81ff>164</span>, <span style=color:#ae81ff>83</span>: <span style=color:#ae81ff>166</span>, <span style=color:#ae81ff>84</span>: <span style=color:#ae81ff>168</span>, <span style=color:#ae81ff>85</span>: <span style=color:#ae81ff>170</span>, <span style=color:#ae81ff>86</span>: <span style=color:#ae81ff>172</span>, <span style=color:#ae81ff>87</span>: <span style=color:#ae81ff>174</span>, <span style=color:#ae81ff>88</span>: <span style=color:#ae81ff>176</span>, <span style=color:#ae81ff>89</span>: <span style=color:#ae81ff>178</span>, <span style=color:#ae81ff>90</span>: <span style=color:#ae81ff>180</span>, <span style=color:#ae81ff>91</span>: <span style=color:#ae81ff>182</span>, <span style=color:#ae81ff>92</span>: <span style=color:#ae81ff>184</span>, <span style=color:#ae81ff>93</span>: <span style=color:#ae81ff>186</span>, <span style=color:#ae81ff>94</span>: <span style=color:#ae81ff>188</span>, <span style=color:#ae81ff>95</span>: <span style=color:#ae81ff>190</span>, <span style=color:#ae81ff>96</span>: <span style=color:#ae81ff>192</span>, <span style=color:#ae81ff>97</span>: <span style=color:#ae81ff>194</span>, <span style=color:#ae81ff>98</span>: <span style=color:#ae81ff>196</span>, <span style=color:#ae81ff>99</span>: <span style=color:#ae81ff>198</span>, <span style=color:#ae81ff>100</span>: <span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>101</span>: <span style=color:#ae81ff>202</span>, <span style=color:#ae81ff>102</span>: <span style=color:#ae81ff>204</span>, <span style=color:#ae81ff>103</span>: <span style=color:#ae81ff>206</span>, <span style=color:#ae81ff>104</span>: <span style=color:#ae81ff>208</span>, <span style=color:#ae81ff>105</span>: <span style=color:#ae81ff>210</span>, <span style=color:#ae81ff>106</span>: <span style=color:#ae81ff>212</span>, <span style=color:#ae81ff>107</span>: <span style=color:#ae81ff>214</span>, <span style=color:#ae81ff>108</span>: <span style=color:#ae81ff>216</span>, <span style=color:#ae81ff>109</span>: <span style=color:#ae81ff>218</span>, <span style=color:#ae81ff>110</span>: <span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>111</span>: <span style=color:#ae81ff>222</span>, <span style=color:#ae81ff>112</span>: <span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>113</span>: <span style=color:#ae81ff>226</span>, <span style=color:#ae81ff>114</span>: <span style=color:#ae81ff>228</span>, <span style=color:#ae81ff>115</span>: <span style=color:#ae81ff>230</span>, <span style=color:#ae81ff>116</span>: <span style=color:#ae81ff>232</span>, <span style=color:#ae81ff>117</span>: <span style=color:#ae81ff>234</span>, <span style=color:#ae81ff>118</span>: <span style=color:#ae81ff>236</span>, <span style=color:#ae81ff>119</span>: <span style=color:#ae81ff>238</span>, <span style=color:#ae81ff>120</span>: <span style=color:#ae81ff>240</span>, <span style=color:#ae81ff>121</span>: <span style=color:#ae81ff>242</span>, <span style=color:#ae81ff>122</span>: <span style=color:#ae81ff>244</span>, <span style=color:#ae81ff>123</span>: <span style=color:#ae81ff>246</span>, <span style=color:#ae81ff>124</span>: <span style=color:#ae81ff>248</span>, <span style=color:#ae81ff>125</span>: <span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>126</span>: <span style=color:#ae81ff>252</span>, <span style=color:#ae81ff>127</span>: <span style=color:#ae81ff>254</span>, <span style=color:#ae81ff>128</span>: <span style=color:#ae81ff>27</span>, <span style=color:#ae81ff>129</span>: <span style=color:#ae81ff>25</span>, <span style=color:#ae81ff>130</span>: <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>131</span>: <span style=color:#ae81ff>29</span>, <span style=color:#ae81ff>132</span>: <span style=color:#ae81ff>19</span>, <span style=color:#ae81ff>133</span>: <span style=color:#ae81ff>17</span>, <span style=color:#ae81ff>134</span>: <span style=color:#ae81ff>23</span>, <span style=color:#ae81ff>135</span>: <span style=color:#ae81ff>21</span>, <span style=color:#ae81ff>136</span>: <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>137</span>: <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>138</span>: <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>139</span>: <span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>140</span>: <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>141</span>: <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>142</span>: <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>143</span>: <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>144</span>: <span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>145</span>: <span style=color:#ae81ff>57</span>, <span style=color:#ae81ff>146</span>: <span style=color:#ae81ff>63</span>, <span style=color:#ae81ff>147</span>: <span style=color:#ae81ff>61</span>, <span style=color:#ae81ff>148</span>: <span style=color:#ae81ff>51</span>, <span style=color:#ae81ff>149</span>: <span style=color:#ae81ff>49</span>, <span style=color:#ae81ff>150</span>: <span style=color:#ae81ff>55</span>, <span style=color:#ae81ff>151</span>: <span style=color:#ae81ff>53</span>, <span style=color:#ae81ff>152</span>: <span style=color:#ae81ff>43</span>, <span style=color:#ae81ff>153</span>: <span style=color:#ae81ff>41</span>, <span style=color:#ae81ff>154</span>: <span style=color:#ae81ff>47</span>, <span style=color:#ae81ff>155</span>: <span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>156</span>: <span style=color:#ae81ff>35</span>, <span style=color:#ae81ff>157</span>: <span style=color:#ae81ff>33</span>, <span style=color:#ae81ff>158</span>: <span style=color:#ae81ff>39</span>, <span style=color:#ae81ff>159</span>: <span style=color:#ae81ff>37</span>, <span style=color:#ae81ff>160</span>: <span style=color:#ae81ff>91</span>, <span style=color:#ae81ff>161</span>: <span style=color:#ae81ff>89</span>, <span style=color:#ae81ff>162</span>: <span style=color:#ae81ff>95</span>, <span style=color:#ae81ff>163</span>: <span style=color:#ae81ff>93</span>, <span style=color:#ae81ff>164</span>: <span style=color:#ae81ff>83</span>, <span style=color:#ae81ff>165</span>: <span style=color:#ae81ff>81</span>, <span style=color:#ae81ff>166</span>: <span style=color:#ae81ff>87</span>, <span style=color:#ae81ff>167</span>: <span style=color:#ae81ff>85</span>, <span style=color:#ae81ff>168</span>: <span style=color:#ae81ff>75</span>, <span style=color:#ae81ff>169</span>: <span style=color:#ae81ff>73</span>, <span style=color:#ae81ff>170</span>: <span style=color:#ae81ff>79</span>, <span style=color:#ae81ff>171</span>: <span style=color:#ae81ff>77</span>, <span style=color:#ae81ff>172</span>: <span style=color:#ae81ff>67</span>, <span style=color:#ae81ff>173</span>: <span style=color:#ae81ff>65</span>, <span style=color:#ae81ff>174</span>: <span style=color:#ae81ff>71</span>, <span style=color:#ae81ff>175</span>: <span style=color:#ae81ff>69</span>, <span style=color:#ae81ff>176</span>: <span style=color:#ae81ff>123</span>, <span style=color:#ae81ff>177</span>: <span style=color:#ae81ff>121</span>, <span style=color:#ae81ff>178</span>: <span style=color:#ae81ff>127</span>, <span style=color:#ae81ff>179</span>: <span style=color:#ae81ff>125</span>, <span style=color:#ae81ff>180</span>: <span style=color:#ae81ff>115</span>, <span style=color:#ae81ff>181</span>: <span style=color:#ae81ff>113</span>, <span style=color:#ae81ff>182</span>: <span style=color:#ae81ff>119</span>, <span style=color:#ae81ff>183</span>: <span style=color:#ae81ff>117</span>, <span style=color:#ae81ff>184</span>: <span style=color:#ae81ff>107</span>, <span style=color:#ae81ff>185</span>: <span style=color:#ae81ff>105</span>, <span style=color:#ae81ff>186</span>: <span style=color:#ae81ff>111</span>, <span style=color:#ae81ff>187</span>: <span style=color:#ae81ff>109</span>, <span style=color:#ae81ff>188</span>: <span style=color:#ae81ff>99</span>, <span style=color:#ae81ff>189</span>: <span style=color:#ae81ff>97</span>, <span style=color:#ae81ff>190</span>: <span style=color:#ae81ff>103</span>, <span style=color:#ae81ff>191</span>: <span style=color:#ae81ff>101</span>, <span style=color:#ae81ff>192</span>: <span style=color:#ae81ff>155</span>, <span style=color:#ae81ff>193</span>: <span style=color:#ae81ff>153</span>, <span style=color:#ae81ff>194</span>: <span style=color:#ae81ff>159</span>, <span style=color:#ae81ff>195</span>: <span style=color:#ae81ff>157</span>, <span style=color:#ae81ff>196</span>: <span style=color:#ae81ff>147</span>, <span style=color:#ae81ff>197</span>: <span style=color:#ae81ff>145</span>, <span style=color:#ae81ff>198</span>: <span style=color:#ae81ff>151</span>, <span style=color:#ae81ff>199</span>: <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>200</span>: <span style=color:#ae81ff>139</span>, <span style=color:#ae81ff>201</span>: <span style=color:#ae81ff>137</span>, <span style=color:#ae81ff>202</span>: <span style=color:#ae81ff>143</span>, <span style=color:#ae81ff>203</span>: <span style=color:#ae81ff>141</span>, <span style=color:#ae81ff>204</span>: <span style=color:#ae81ff>131</span>, <span style=color:#ae81ff>205</span>: <span style=color:#ae81ff>129</span>, <span style=color:#ae81ff>206</span>: <span style=color:#ae81ff>135</span>, <span style=color:#ae81ff>207</span>: <span style=color:#ae81ff>133</span>, <span style=color:#ae81ff>208</span>: <span style=color:#ae81ff>187</span>, <span style=color:#ae81ff>209</span>: <span style=color:#ae81ff>185</span>, <span style=color:#ae81ff>210</span>: <span style=color:#ae81ff>191</span>, <span style=color:#ae81ff>211</span>: <span style=color:#ae81ff>189</span>, <span style=color:#ae81ff>212</span>: <span style=color:#ae81ff>179</span>, <span style=color:#ae81ff>213</span>: <span style=color:#ae81ff>177</span>, <span style=color:#ae81ff>214</span>: <span style=color:#ae81ff>183</span>, <span style=color:#ae81ff>215</span>: <span style=color:#ae81ff>181</span>, <span style=color:#ae81ff>216</span>: <span style=color:#ae81ff>171</span>, <span style=color:#ae81ff>217</span>: <span style=color:#ae81ff>169</span>, <span style=color:#ae81ff>218</span>: <span style=color:#ae81ff>175</span>, <span style=color:#ae81ff>219</span>: <span style=color:#ae81ff>173</span>, <span style=color:#ae81ff>220</span>: <span style=color:#ae81ff>163</span>, <span style=color:#ae81ff>221</span>: <span style=color:#ae81ff>161</span>, <span style=color:#ae81ff>222</span>: <span style=color:#ae81ff>167</span>, <span style=color:#ae81ff>223</span>: <span style=color:#ae81ff>165</span>, <span style=color:#ae81ff>224</span>: <span style=color:#ae81ff>219</span>, <span style=color:#ae81ff>225</span>: <span style=color:#ae81ff>217</span>, <span style=color:#ae81ff>226</span>: <span style=color:#ae81ff>223</span>, <span style=color:#ae81ff>227</span>: <span style=color:#ae81ff>221</span>, <span style=color:#ae81ff>228</span>: <span style=color:#ae81ff>211</span>, <span style=color:#ae81ff>229</span>: <span style=color:#ae81ff>209</span>, <span style=color:#ae81ff>230</span>: <span style=color:#ae81ff>215</span>, <span style=color:#ae81ff>231</span>: <span style=color:#ae81ff>213</span>, <span style=color:#ae81ff>232</span>: <span style=color:#ae81ff>203</span>, <span style=color:#ae81ff>233</span>: <span style=color:#ae81ff>201</span>, <span style=color:#ae81ff>234</span>: <span style=color:#ae81ff>207</span>, <span style=color:#ae81ff>235</span>: <span style=color:#ae81ff>205</span>, <span style=color:#ae81ff>236</span>: <span style=color:#ae81ff>195</span>, <span style=color:#ae81ff>237</span>: <span style=color:#ae81ff>193</span>, <span style=color:#ae81ff>238</span>: <span style=color:#ae81ff>199</span>, <span style=color:#ae81ff>239</span>: <span style=color:#ae81ff>197</span>, <span style=color:#ae81ff>240</span>: <span style=color:#ae81ff>251</span>, <span style=color:#ae81ff>241</span>: <span style=color:#ae81ff>249</span>, <span style=color:#ae81ff>242</span>: <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>243</span>: <span style=color:#ae81ff>253</span>, <span style=color:#ae81ff>244</span>: <span style=color:#ae81ff>243</span>, <span style=color:#ae81ff>245</span>: <span style=color:#ae81ff>241</span>, <span style=color:#ae81ff>246</span>: <span style=color:#ae81ff>247</span>, <span style=color:#ae81ff>247</span>: <span style=color:#ae81ff>245</span>, <span style=color:#ae81ff>248</span>: <span style=color:#ae81ff>235</span>, <span style=color:#ae81ff>249</span>: <span style=color:#ae81ff>233</span>, <span style=color:#ae81ff>250</span>: <span style=color:#ae81ff>239</span>, <span style=color:#ae81ff>251</span>: <span style=color:#ae81ff>237</span>, <span style=color:#ae81ff>252</span>: <span style=color:#ae81ff>227</span>, <span style=color:#ae81ff>253</span>: <span style=color:#ae81ff>225</span>, <span style=color:#ae81ff>254</span>: <span style=color:#ae81ff>231</span>, <span style=color:#ae81ff>255</span>: <span style=color:#ae81ff>229</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>MULTIPLICATION_BY_3 <span style=color:#f92672>=</span> { <span style=color:#ae81ff>0</span>: <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>: <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>: <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>: <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>: <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>5</span>: <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>6</span>: <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>7</span>: <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>8</span>: <span style=color:#ae81ff>24</span>, <span style=color:#ae81ff>9</span>: <span style=color:#ae81ff>27</span>, <span style=color:#ae81ff>10</span>: <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>11</span>: <span style=color:#ae81ff>29</span>, <span style=color:#ae81ff>12</span>: <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>13</span>: <span style=color:#ae81ff>23</span>, <span style=color:#ae81ff>14</span>: <span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>15</span>: <span style=color:#ae81ff>17</span>, <span style=color:#ae81ff>16</span>: <span style=color:#ae81ff>48</span>, <span style=color:#ae81ff>17</span>: <span style=color:#ae81ff>51</span>, <span style=color:#ae81ff>18</span>: <span style=color:#ae81ff>54</span>, <span style=color:#ae81ff>19</span>: <span style=color:#ae81ff>53</span>, <span style=color:#ae81ff>20</span>: <span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>21</span>: <span style=color:#ae81ff>63</span>, <span style=color:#ae81ff>22</span>: <span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>23</span>: <span style=color:#ae81ff>57</span>, <span style=color:#ae81ff>24</span>: <span style=color:#ae81ff>40</span>, <span style=color:#ae81ff>25</span>: <span style=color:#ae81ff>43</span>, <span style=color:#ae81ff>26</span>: <span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>27</span>: <span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>28</span>: <span style=color:#ae81ff>36</span>, <span style=color:#ae81ff>29</span>: <span style=color:#ae81ff>39</span>, <span style=color:#ae81ff>30</span>: <span style=color:#ae81ff>34</span>, <span style=color:#ae81ff>31</span>: <span style=color:#ae81ff>33</span>, <span style=color:#ae81ff>32</span>: <span style=color:#ae81ff>96</span>, <span style=color:#ae81ff>33</span>: <span style=color:#ae81ff>99</span>, <span style=color:#ae81ff>34</span>: <span style=color:#ae81ff>102</span>, <span style=color:#ae81ff>35</span>: <span style=color:#ae81ff>101</span>, <span style=color:#ae81ff>36</span>: <span style=color:#ae81ff>108</span>, <span style=color:#ae81ff>37</span>: <span style=color:#ae81ff>111</span>, <span style=color:#ae81ff>38</span>: <span style=color:#ae81ff>106</span>, <span style=color:#ae81ff>39</span>: <span style=color:#ae81ff>105</span>, <span style=color:#ae81ff>40</span>: <span style=color:#ae81ff>120</span>, <span style=color:#ae81ff>41</span>: <span style=color:#ae81ff>123</span>, <span style=color:#ae81ff>42</span>: <span style=color:#ae81ff>126</span>, <span style=color:#ae81ff>43</span>: <span style=color:#ae81ff>125</span>, <span style=color:#ae81ff>44</span>: <span style=color:#ae81ff>116</span>, <span style=color:#ae81ff>45</span>: <span style=color:#ae81ff>119</span>, <span style=color:#ae81ff>46</span>: <span style=color:#ae81ff>114</span>, <span style=color:#ae81ff>47</span>: <span style=color:#ae81ff>113</span>, <span style=color:#ae81ff>48</span>: <span style=color:#ae81ff>80</span>, <span style=color:#ae81ff>49</span>: <span style=color:#ae81ff>83</span>, <span style=color:#ae81ff>50</span>: <span style=color:#ae81ff>86</span>, <span style=color:#ae81ff>51</span>: <span style=color:#ae81ff>85</span>, <span style=color:#ae81ff>52</span>: <span style=color:#ae81ff>92</span>, <span style=color:#ae81ff>53</span>: <span style=color:#ae81ff>95</span>, <span style=color:#ae81ff>54</span>: <span style=color:#ae81ff>90</span>, <span style=color:#ae81ff>55</span>: <span style=color:#ae81ff>89</span>, <span style=color:#ae81ff>56</span>: <span style=color:#ae81ff>72</span>, <span style=color:#ae81ff>57</span>: <span style=color:#ae81ff>75</span>, <span style=color:#ae81ff>58</span>: <span style=color:#ae81ff>78</span>, <span style=color:#ae81ff>59</span>: <span style=color:#ae81ff>77</span>, <span style=color:#ae81ff>60</span>: <span style=color:#ae81ff>68</span>, <span style=color:#ae81ff>61</span>: <span style=color:#ae81ff>71</span>, <span style=color:#ae81ff>62</span>: <span style=color:#ae81ff>66</span>, <span style=color:#ae81ff>63</span>: <span style=color:#ae81ff>65</span>, <span style=color:#ae81ff>64</span>: <span style=color:#ae81ff>192</span>, <span style=color:#ae81ff>65</span>: <span style=color:#ae81ff>195</span>, <span style=color:#ae81ff>66</span>: <span style=color:#ae81ff>198</span>, <span style=color:#ae81ff>67</span>: <span style=color:#ae81ff>197</span>, <span style=color:#ae81ff>68</span>: <span style=color:#ae81ff>204</span>, <span style=color:#ae81ff>69</span>: <span style=color:#ae81ff>207</span>, <span style=color:#ae81ff>70</span>: <span style=color:#ae81ff>202</span>, <span style=color:#ae81ff>71</span>: <span style=color:#ae81ff>201</span>, <span style=color:#ae81ff>72</span>: <span style=color:#ae81ff>216</span>, <span style=color:#ae81ff>73</span>: <span style=color:#ae81ff>219</span>, <span style=color:#ae81ff>74</span>: <span style=color:#ae81ff>222</span>, <span style=color:#ae81ff>75</span>: <span style=color:#ae81ff>221</span>, <span style=color:#ae81ff>76</span>: <span style=color:#ae81ff>212</span>, <span style=color:#ae81ff>77</span>: <span style=color:#ae81ff>215</span>, <span style=color:#ae81ff>78</span>: <span style=color:#ae81ff>210</span>, <span style=color:#ae81ff>79</span>: <span style=color:#ae81ff>209</span>, <span style=color:#ae81ff>80</span>: <span style=color:#ae81ff>240</span>, <span style=color:#ae81ff>81</span>: <span style=color:#ae81ff>243</span>, <span style=color:#ae81ff>82</span>: <span style=color:#ae81ff>246</span>, <span style=color:#ae81ff>83</span>: <span style=color:#ae81ff>245</span>, <span style=color:#ae81ff>84</span>: <span style=color:#ae81ff>252</span>, <span style=color:#ae81ff>85</span>: <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>86</span>: <span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>87</span>: <span style=color:#ae81ff>249</span>, <span style=color:#ae81ff>88</span>: <span style=color:#ae81ff>232</span>, <span style=color:#ae81ff>89</span>: <span style=color:#ae81ff>235</span>, <span style=color:#ae81ff>90</span>: <span style=color:#ae81ff>238</span>, <span style=color:#ae81ff>91</span>: <span style=color:#ae81ff>237</span>, <span style=color:#ae81ff>92</span>: <span style=color:#ae81ff>228</span>, <span style=color:#ae81ff>93</span>: <span style=color:#ae81ff>231</span>, <span style=color:#ae81ff>94</span>: <span style=color:#ae81ff>226</span>, <span style=color:#ae81ff>95</span>: <span style=color:#ae81ff>225</span>, <span style=color:#ae81ff>96</span>: <span style=color:#ae81ff>160</span>, <span style=color:#ae81ff>97</span>: <span style=color:#ae81ff>163</span>, <span style=color:#ae81ff>98</span>: <span style=color:#ae81ff>166</span>, <span style=color:#ae81ff>99</span>: <span style=color:#ae81ff>165</span>, <span style=color:#ae81ff>100</span>: <span style=color:#ae81ff>172</span>, <span style=color:#ae81ff>101</span>: <span style=color:#ae81ff>175</span>, <span style=color:#ae81ff>102</span>: <span style=color:#ae81ff>170</span>, <span style=color:#ae81ff>103</span>: <span style=color:#ae81ff>169</span>, <span style=color:#ae81ff>104</span>: <span style=color:#ae81ff>184</span>, <span style=color:#ae81ff>105</span>: <span style=color:#ae81ff>187</span>, <span style=color:#ae81ff>106</span>: <span style=color:#ae81ff>190</span>, <span style=color:#ae81ff>107</span>: <span style=color:#ae81ff>189</span>, <span style=color:#ae81ff>108</span>: <span style=color:#ae81ff>180</span>, <span style=color:#ae81ff>109</span>: <span style=color:#ae81ff>183</span>, <span style=color:#ae81ff>110</span>: <span style=color:#ae81ff>178</span>, <span style=color:#ae81ff>111</span>: <span style=color:#ae81ff>177</span>, <span style=color:#ae81ff>112</span>: <span style=color:#ae81ff>144</span>, <span style=color:#ae81ff>113</span>: <span style=color:#ae81ff>147</span>, <span style=color:#ae81ff>114</span>: <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>115</span>: <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>116</span>: <span style=color:#ae81ff>156</span>, <span style=color:#ae81ff>117</span>: <span style=color:#ae81ff>159</span>, <span style=color:#ae81ff>118</span>: <span style=color:#ae81ff>154</span>, <span style=color:#ae81ff>119</span>: <span style=color:#ae81ff>153</span>, <span style=color:#ae81ff>120</span>: <span style=color:#ae81ff>136</span>, <span style=color:#ae81ff>121</span>: <span style=color:#ae81ff>139</span>, <span style=color:#ae81ff>122</span>: <span style=color:#ae81ff>142</span>, <span style=color:#ae81ff>123</span>: <span style=color:#ae81ff>141</span>, <span style=color:#ae81ff>124</span>: <span style=color:#ae81ff>132</span>, <span style=color:#ae81ff>125</span>: <span style=color:#ae81ff>135</span>, <span style=color:#ae81ff>126</span>: <span style=color:#ae81ff>130</span>, <span style=color:#ae81ff>127</span>: <span style=color:#ae81ff>129</span>, <span style=color:#ae81ff>128</span>: <span style=color:#ae81ff>155</span>, <span style=color:#ae81ff>129</span>: <span style=color:#ae81ff>152</span>, <span style=color:#ae81ff>130</span>: <span style=color:#ae81ff>157</span>, <span style=color:#ae81ff>131</span>: <span style=color:#ae81ff>158</span>, <span style=color:#ae81ff>132</span>: <span style=color:#ae81ff>151</span>, <span style=color:#ae81ff>133</span>: <span style=color:#ae81ff>148</span>, <span style=color:#ae81ff>134</span>: <span style=color:#ae81ff>145</span>, <span style=color:#ae81ff>135</span>: <span style=color:#ae81ff>146</span>, <span style=color:#ae81ff>136</span>: <span style=color:#ae81ff>131</span>, <span style=color:#ae81ff>137</span>: <span style=color:#ae81ff>128</span>, <span style=color:#ae81ff>138</span>: <span style=color:#ae81ff>133</span>, <span style=color:#ae81ff>139</span>: <span style=color:#ae81ff>134</span>, <span style=color:#ae81ff>140</span>: <span style=color:#ae81ff>143</span>, <span style=color:#ae81ff>141</span>: <span style=color:#ae81ff>140</span>, <span style=color:#ae81ff>142</span>: <span style=color:#ae81ff>137</span>, <span style=color:#ae81ff>143</span>: <span style=color:#ae81ff>138</span>, <span style=color:#ae81ff>144</span>: <span style=color:#ae81ff>171</span>, <span style=color:#ae81ff>145</span>: <span style=color:#ae81ff>168</span>, <span style=color:#ae81ff>146</span>: <span style=color:#ae81ff>173</span>, <span style=color:#ae81ff>147</span>: <span style=color:#ae81ff>174</span>, <span style=color:#ae81ff>148</span>: <span style=color:#ae81ff>167</span>, <span style=color:#ae81ff>149</span>: <span style=color:#ae81ff>164</span>, <span style=color:#ae81ff>150</span>: <span style=color:#ae81ff>161</span>, <span style=color:#ae81ff>151</span>: <span style=color:#ae81ff>162</span>, <span style=color:#ae81ff>152</span>: <span style=color:#ae81ff>179</span>, <span style=color:#ae81ff>153</span>: <span style=color:#ae81ff>176</span>, <span style=color:#ae81ff>154</span>: <span style=color:#ae81ff>181</span>, <span style=color:#ae81ff>155</span>: <span style=color:#ae81ff>182</span>, <span style=color:#ae81ff>156</span>: <span style=color:#ae81ff>191</span>, <span style=color:#ae81ff>157</span>: <span style=color:#ae81ff>188</span>, <span style=color:#ae81ff>158</span>: <span style=color:#ae81ff>185</span>, <span style=color:#ae81ff>159</span>: <span style=color:#ae81ff>186</span>, <span style=color:#ae81ff>160</span>: <span style=color:#ae81ff>251</span>, <span style=color:#ae81ff>161</span>: <span style=color:#ae81ff>248</span>, <span style=color:#ae81ff>162</span>: <span style=color:#ae81ff>253</span>, <span style=color:#ae81ff>163</span>: <span style=color:#ae81ff>254</span>, <span style=color:#ae81ff>164</span>: <span style=color:#ae81ff>247</span>, <span style=color:#ae81ff>165</span>: <span style=color:#ae81ff>244</span>, <span style=color:#ae81ff>166</span>: <span style=color:#ae81ff>241</span>, <span style=color:#ae81ff>167</span>: <span style=color:#ae81ff>242</span>, <span style=color:#ae81ff>168</span>: <span style=color:#ae81ff>227</span>, <span style=color:#ae81ff>169</span>: <span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>170</span>: <span style=color:#ae81ff>229</span>, <span style=color:#ae81ff>171</span>: <span style=color:#ae81ff>230</span>, <span style=color:#ae81ff>172</span>: <span style=color:#ae81ff>239</span>, <span style=color:#ae81ff>173</span>: <span style=color:#ae81ff>236</span>, <span style=color:#ae81ff>174</span>: <span style=color:#ae81ff>233</span>, <span style=color:#ae81ff>175</span>: <span style=color:#ae81ff>234</span>, <span style=color:#ae81ff>176</span>: <span style=color:#ae81ff>203</span>, <span style=color:#ae81ff>177</span>: <span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>178</span>: <span style=color:#ae81ff>205</span>, <span style=color:#ae81ff>179</span>: <span style=color:#ae81ff>206</span>, <span style=color:#ae81ff>180</span>: <span style=color:#ae81ff>199</span>, <span style=color:#ae81ff>181</span>: <span style=color:#ae81ff>196</span>, <span style=color:#ae81ff>182</span>: <span style=color:#ae81ff>193</span>, <span style=color:#ae81ff>183</span>: <span style=color:#ae81ff>194</span>, <span style=color:#ae81ff>184</span>: <span style=color:#ae81ff>211</span>, <span style=color:#ae81ff>185</span>: <span style=color:#ae81ff>208</span>, <span style=color:#ae81ff>186</span>: <span style=color:#ae81ff>213</span>, <span style=color:#ae81ff>187</span>: <span style=color:#ae81ff>214</span>, <span style=color:#ae81ff>188</span>: <span style=color:#ae81ff>223</span>, <span style=color:#ae81ff>189</span>: <span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>190</span>: <span style=color:#ae81ff>217</span>, <span style=color:#ae81ff>191</span>: <span style=color:#ae81ff>218</span>, <span style=color:#ae81ff>192</span>: <span style=color:#ae81ff>91</span>, <span style=color:#ae81ff>193</span>: <span style=color:#ae81ff>88</span>, <span style=color:#ae81ff>194</span>: <span style=color:#ae81ff>93</span>, <span style=color:#ae81ff>195</span>: <span style=color:#ae81ff>94</span>, <span style=color:#ae81ff>196</span>: <span style=color:#ae81ff>87</span>, <span style=color:#ae81ff>197</span>: <span style=color:#ae81ff>84</span>, <span style=color:#ae81ff>198</span>: <span style=color:#ae81ff>81</span>, <span style=color:#ae81ff>199</span>: <span style=color:#ae81ff>82</span>, <span style=color:#ae81ff>200</span>: <span style=color:#ae81ff>67</span>, <span style=color:#ae81ff>201</span>: <span style=color:#ae81ff>64</span>, <span style=color:#ae81ff>202</span>: <span style=color:#ae81ff>69</span>, <span style=color:#ae81ff>203</span>: <span style=color:#ae81ff>70</span>, <span style=color:#ae81ff>204</span>: <span style=color:#ae81ff>79</span>, <span style=color:#ae81ff>205</span>: <span style=color:#ae81ff>76</span>, <span style=color:#ae81ff>206</span>: <span style=color:#ae81ff>73</span>, <span style=color:#ae81ff>207</span>: <span style=color:#ae81ff>74</span>, <span style=color:#ae81ff>208</span>: <span style=color:#ae81ff>107</span>, <span style=color:#ae81ff>209</span>: <span style=color:#ae81ff>104</span>, <span style=color:#ae81ff>210</span>: <span style=color:#ae81ff>109</span>, <span style=color:#ae81ff>211</span>: <span style=color:#ae81ff>110</span>, <span style=color:#ae81ff>212</span>: <span style=color:#ae81ff>103</span>, <span style=color:#ae81ff>213</span>: <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>214</span>: <span style=color:#ae81ff>97</span>, <span style=color:#ae81ff>215</span>: <span style=color:#ae81ff>98</span>, <span style=color:#ae81ff>216</span>: <span style=color:#ae81ff>115</span>, <span style=color:#ae81ff>217</span>: <span style=color:#ae81ff>112</span>, <span style=color:#ae81ff>218</span>: <span style=color:#ae81ff>117</span>, <span style=color:#ae81ff>219</span>: <span style=color:#ae81ff>118</span>, <span style=color:#ae81ff>220</span>: <span style=color:#ae81ff>127</span>, <span style=color:#ae81ff>221</span>: <span style=color:#ae81ff>124</span>, <span style=color:#ae81ff>222</span>: <span style=color:#ae81ff>121</span>, <span style=color:#ae81ff>223</span>: <span style=color:#ae81ff>122</span>, <span style=color:#ae81ff>224</span>: <span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>225</span>: <span style=color:#ae81ff>56</span>, <span style=color:#ae81ff>226</span>: <span style=color:#ae81ff>61</span>, <span style=color:#ae81ff>227</span>: <span style=color:#ae81ff>62</span>, <span style=color:#ae81ff>228</span>: <span style=color:#ae81ff>55</span>, <span style=color:#ae81ff>229</span>: <span style=color:#ae81ff>52</span>, <span style=color:#ae81ff>230</span>: <span style=color:#ae81ff>49</span>, <span style=color:#ae81ff>231</span>: <span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>232</span>: <span style=color:#ae81ff>35</span>, <span style=color:#ae81ff>233</span>: <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>234</span>: <span style=color:#ae81ff>37</span>, <span style=color:#ae81ff>235</span>: <span style=color:#ae81ff>38</span>, <span style=color:#ae81ff>236</span>: <span style=color:#ae81ff>47</span>, <span style=color:#ae81ff>237</span>: <span style=color:#ae81ff>44</span>, <span style=color:#ae81ff>238</span>: <span style=color:#ae81ff>41</span>, <span style=color:#ae81ff>239</span>: <span style=color:#ae81ff>42</span>, <span style=color:#ae81ff>240</span>: <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>241</span>: <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>242</span>: <span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>243</span>: <span style=color:#ae81ff>14</span>, <span style=color:#ae81ff>244</span>: <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>245</span>: <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>246</span>: <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>247</span>: <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>248</span>: <span style=color:#ae81ff>19</span>, <span style=color:#ae81ff>249</span>: <span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>250</span>: <span style=color:#ae81ff>21</span>, <span style=color:#ae81ff>251</span>: <span style=color:#ae81ff>22</span>, <span style=color:#ae81ff>252</span>: <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>253</span>: <span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>254</span>: <span style=color:#ae81ff>25</span>, <span style=color:#ae81ff>255</span>: <span style=color:#ae81ff>26</span>}
</span></span><span style=display:flex><span><span style=color:#75715e># https://github.com/thomasperrot/aes-square-attack</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>mixcolumns</span>(state: array):
</span></span><span style=display:flex><span>    new_state <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array(state, dtype<span style=color:#f92672>=</span>int)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        a0, a1, a2, a3 <span style=color:#f92672>=</span> state[:, i]
</span></span><span style=display:flex><span>        new_state[<span style=color:#ae81ff>0</span>, i] <span style=color:#f92672>=</span> MULTIPLICATION_BY_2[a0] <span style=color:#f92672>^</span> MULTIPLICATION_BY_3[a1] <span style=color:#f92672>^</span> a2 <span style=color:#f92672>^</span> a3
</span></span><span style=display:flex><span>        new_state[<span style=color:#ae81ff>1</span>, i] <span style=color:#f92672>=</span> a0 <span style=color:#f92672>^</span> MULTIPLICATION_BY_2[a1] <span style=color:#f92672>^</span> MULTIPLICATION_BY_3[a2] <span style=color:#f92672>^</span> a3
</span></span><span style=display:flex><span>        new_state[<span style=color:#ae81ff>2</span>, i] <span style=color:#f92672>=</span> a0 <span style=color:#f92672>^</span> a1 <span style=color:#f92672>^</span> MULTIPLICATION_BY_2[a2] <span style=color:#f92672>^</span> MULTIPLICATION_BY_3[a3]
</span></span><span style=display:flex><span>        new_state[<span style=color:#ae81ff>3</span>, i] <span style=color:#f92672>=</span> MULTIPLICATION_BY_3[a0] <span style=color:#f92672>^</span> a1 <span style=color:#f92672>^</span> a2 <span style=color:#f92672>^</span> MULTIPLICATION_BY_2[a3]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new_state
</span></span></code></pre></div></div><style>.tabs input#tab-1-4:checked~.tab-content-1-4{display:block}</style><input type=radio class=tab-input name=tab-select-1 id=tab-1-4>
<label for=tab-1-4 class=tab-label>addRoundKey</label><div class="tab-content tab-content-1-4"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># https://github.com/thomasperrot/aes-square-attack</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>addroundkey</span>(state: array, key<span style=color:#f92672>=</span>[[], [], [], []]):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(key) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>4</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Wrong length: </span><span style=color:#e6db74>{</span>len(key)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    new_state <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array(state, dtype<span style=color:#f92672>=</span>int)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>            new_state[i][j] <span style=color:#f92672>^=</span> key[j][i]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new_state
</span></span></code></pre></div></div><style>.tabs input#tab-1-5:checked~.tab-content-1-5{display:block}</style><input type=radio class=tab-input name=tab-select-1 id=tab-1-5>
<label for=tab-1-5 class=tab-label>encrypt</label><div class="tab-content tab-content-1-5"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># https://github.com/thomasperrot/aes-square-attack</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ici round = nbre de tous AES-128 ==&gt; 10 rounds</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>transform_state</span>(plaintext: bytes, key: bytes, rounds: int):
</span></span><span style=display:flex><span>    key_state <span style=color:#f92672>=</span> key_expension(key, rounds<span style=color:#f92672>=</span>rounds <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    round_key <span style=color:#f92672>=</span> key_state[<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> tostate (plaintext)
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> addroundkey(state, round_key)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, rounds):
</span></span><span style=display:flex><span>        round_key <span style=color:#f92672>=</span> key_state[<span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> i : <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)]
</span></span><span style=display:flex><span>        state <span style=color:#f92672>=</span> subbytes(state)
</span></span><span style=display:flex><span>        state <span style=color:#f92672>=</span> shiftrows(state)
</span></span><span style=display:flex><span>        state <span style=color:#f92672>=</span> mixcolumns(state)
</span></span><span style=display:flex><span>        state <span style=color:#f92672>=</span> addroundkey(state, round_key)
</span></span><span style=display:flex><span>    round_key <span style=color:#f92672>=</span> key_state[<span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> rounds : <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> (rounds <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)]
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> subbytes(state)
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> shiftrows(state)
</span></span><span style=display:flex><span>    <span style=color:#75715e>#no mix colums for last round</span>
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> addroundkey(state, round_key)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> state
</span></span></code></pre></div></div></div><h2 id=3--aes---déchiffrement>3. AES - Déchiffrement<a href=#3--aes---d%c3%a9chiffrement class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Comme vous le savez c&rsquo;est l&rsquo;opération inverse du chiffrement qui avec la clé et le texte chiffré nous permettra de retrouver le message en clair.</p><h3 id=31-procédé-de-déchiffement>3.1 Procédé de déchiffement<a href=#31-proc%c3%a9d%c3%a9-de-d%c3%a9chiffement class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Ayant la clé de chiffrement, la première étape serait l&rsquo;expansion de la clé. Ensuite il va falloir faire les opérations inverses, du SubBytes, ShiftRows, MixColumns. Le addRoundKey demeure inchangé.
Notons <strong>\(I\)SubBytes</strong> l&rsquo;inverse de l&rsquo;opération SubBytes (inverse de la Sbox), <strong>\(I\)ShiftRows</strong> l&rsquo;inverse de ShiftRows et <strong>\(I\)MixColumns</strong> l&rsquo;inverse du MixColumns.
Le texte à déchiffrer est découpé en blocs de 16 octets et en matrice 4x4 comme pour obtenir le state, ensuite pour chaque bloc chiffré, on effectue les opérations suivantes pour produire un bloc clair de même longueur</p><ul><li>On initialise un tableau \(4 \times 4\) avec \(16\) octets de texte chiffré</li><li>On applique successivement les opérations suivantes sur ce tableau:
1. AddRoundKey, \(I\)ShiftRows, et \(I\)SubBytes dans cet ordre.
2. On effectue &ldquo;nombre de tours total&rdquo;-1 tours comportant les 4 étapes AddRoundKey, \(I\)MixColumns, \(I\)ShiftRows puis \(I\)SubBytes.
3. Un dernier tour ne comporte plus qu’une étapes : AddRoundKey
Et voilà, on obtient notre message en clair.
Attention, pour l&rsquo;étape AddRoundKey, on commence par la dernières sous-clés dérivés jusqu&rsquo;à atteindre la clé elle même pour le dernier tour.</li></ul><h5 id=isubbytes>\(I\)SubBytes<a href=#isubbytes class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>La fonction permettant d&rsquo;avoir la Sbox étant bijective, il faut calculer son inverse pour avoir la Sbox inverse.
On a donc deux possibilités: soit on précalcule la Sbox inverse ensuite on la lit comme la Sbox, soit on utilise la Sbox mais qu&rsquo;on lira dans l&rsquo;autre sens i.e. partir de l&rsquo;image \(y\) et retrouvé le \(x\) correspondant. Donc pour faire simple, supposons on cherche la Sbox inverse de \(5F\), on va chercher dans le tableau de la Sbox où est localisé \(5F\) et ensuite on lira le x correspondant.
et donc on trouve \(84\).<figure><img src=https://dilagluc.github.io/crypto_aes/Isubbytes.png></figure></p><h5 id=ishiftrows>\(I\)ShiftRows<a href=#ishiftrows class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>C&rsquo;est l&rsquo;exacte inverse du ShiftRows, décalage à droite de \(i\) colonnes de la ligne \(i\) , \(0\leq i \leq 3\)<figure><img src=https://dilagluc.github.io/crypto_aes/Ishiftrows.png></figure></p><h5 id=imixcolumns>\(I\)MixColumns<a href=#imixcolumns class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h5><p>L&rsquo;opération MixColumns étant défini par \(B=M\times A\), donc inverser MixColumns revient à trouver la matrice \(A\) et donc on a:<br></p>$$ A = M^{-1} \times B$$<p>Il suffit donc d&rsquo;inverser la matrice de l&rsquo;opération MixColumns \(M\) dans \(\mathbb{F}_{256}\). On trouve:</p>$$M = \begin{bmatrix}
0E&0B&0D&09 \\\\
09&0E&0B&0D \\\\
0D&09&0E&0B \\\\
0B&0D&09&0E \\\\
\end{bmatrix} =
\begin{bmatrix}
14&11&13&9 \\\\
9&14&11&13 \\\\
13&9&14&11 \\\\
11&13&9&14 \\\\
\end{bmatrix}
$$<p>On peut donc également pour cette étape précalculer les valeurs pour les multiplications par 14, 13, 11 et 9.</p><h4 id=32-implémentation>3.2 Implémentation<a href=#32-impl%c3%a9mentation class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p>Implémentation finale:
<a href=/crypto_aes/aes_decrypt.py>aes_decrypt.py</a></p><div class="tabs tabs-left"><style>.tabs input#tab-2-0:checked~.tab-content-2-0{display:block}</style><input type=radio class=tab-input name=tab-select-2 id=tab-2-0 checked>
<label for=tab-2-0 class=tab-label>\(I\)SubBytes</label><div class="tab-content tab-content-2-0"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ISubBytes</span>(state: array, sbox_map<span style=color:#f92672>=</span>ke<span style=color:#f92672>.</span>get_sbox_map()):
</span></span><span style=display:flex><span>    new_state <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>zeros((<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>), dtype<span style=color:#f92672>=</span>int)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>            pos <span style=color:#f92672>=</span> list(sbox_map<span style=color:#f92672>.</span>values())<span style=color:#f92672>.</span>index(state[i, j])
</span></span><span style=display:flex><span>            new_state[i, j] <span style=color:#f92672>=</span> pos
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new_state
</span></span></code></pre></div></div><style>.tabs input#tab-2-1:checked~.tab-content-2-1{display:block}</style><input type=radio class=tab-input name=tab-select-2 id=tab-2-1>
<label for=tab-2-1 class=tab-label>\(I\)ShiftRows</label><div class="tab-content tab-content-2-1"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>IShiftRows</span>(state: array):
</span></span><span style=display:flex><span>    new_state <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array(state, dtype<span style=color:#f92672>=</span>int)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        new_state[i] <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>roll(new_state[i], i)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new_state
</span></span></code></pre></div></div><style>.tabs input#tab-2-2:checked~.tab-content-2-2{display:block}</style><input type=radio class=tab-input name=tab-select-2 id=tab-2-2>
<label for=tab-2-2 class=tab-label>\(I\)MixColumns</label><div class="tab-content tab-content-2-2"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>MULTIPLICATION_BY_9 <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x0</span>, <span style=color:#ae81ff>0x9</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0x1b</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x2d</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x3f</span>, <span style=color:#ae81ff>0x48</span>, <span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x5a</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0x6c</span>, <span style=color:#ae81ff>0x65</span>, <span style=color:#ae81ff>0x7e</span>, <span style=color:#ae81ff>0x77</span>, <span style=color:#ae81ff>0x90</span>, <span style=color:#ae81ff>0x99</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0x8b</span>, <span style=color:#ae81ff>0xb4</span>, <span style=color:#ae81ff>0xbd</span>, <span style=color:#ae81ff>0xa6</span>, <span style=color:#ae81ff>0xaf</span>, <span style=color:#ae81ff>0xd8</span>, <span style=color:#ae81ff>0xd1</span>, <span style=color:#ae81ff>0xca</span>, <span style=color:#ae81ff>0xc3</span>, <span style=color:#ae81ff>0xfc</span>, <span style=color:#ae81ff>0xf5</span>, <span style=color:#ae81ff>0xee</span>, <span style=color:#ae81ff>0xe7</span>, <span style=color:#ae81ff>0x3b</span>, <span style=color:#ae81ff>0x32</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x1f</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0xd</span>, <span style=color:#ae81ff>0x4</span>, <span style=color:#ae81ff>0x73</span>, <span style=color:#ae81ff>0x7a</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0x68</span>, <span style=color:#ae81ff>0x57</span>, <span style=color:#ae81ff>0x5e</span>, <span style=color:#ae81ff>0x45</span>, <span style=color:#ae81ff>0x4c</span>, <span style=color:#ae81ff>0xab</span>, <span style=color:#ae81ff>0xa2</span>, <span style=color:#ae81ff>0xb9</span>, <span style=color:#ae81ff>0xb0</span>, <span style=color:#ae81ff>0x8f</span>, <span style=color:#ae81ff>0x86</span>, <span style=color:#ae81ff>0x9d</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0xe3</span>, <span style=color:#ae81ff>0xea</span>, <span style=color:#ae81ff>0xf1</span>, <span style=color:#ae81ff>0xf8</span>, <span style=color:#ae81ff>0xc7</span>, <span style=color:#ae81ff>0xce</span>, <span style=color:#ae81ff>0xd5</span>, <span style=color:#ae81ff>0xdc</span>, <span style=color:#ae81ff>0x76</span>, <span style=color:#ae81ff>0x7f</span>, <span style=color:#ae81ff>0x64</span>, <span style=color:#ae81ff>0x6d</span>, <span style=color:#ae81ff>0x52</span>, <span style=color:#ae81ff>0x5b</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x49</span>, <span style=color:#ae81ff>0x3e</span>, <span style=color:#ae81ff>0x37</span>, <span style=color:#ae81ff>0x2c</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x1a</span>, <span style=color:#ae81ff>0x13</span>, <span style=color:#ae81ff>0x8</span>, <span style=color:#ae81ff>0x1</span>, <span style=color:#ae81ff>0xe6</span>, <span style=color:#ae81ff>0xef</span>, <span style=color:#ae81ff>0xf4</span>, <span style=color:#ae81ff>0xfd</span>, <span style=color:#ae81ff>0xc2</span>, <span style=color:#ae81ff>0xcb</span>, <span style=color:#ae81ff>0xd0</span>, <span style=color:#ae81ff>0xd9</span>, <span style=color:#ae81ff>0xae</span>, <span style=color:#ae81ff>0xa7</span>, <span style=color:#ae81ff>0xbc</span>, <span style=color:#ae81ff>0xb5</span>, <span style=color:#ae81ff>0x8a</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x98</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x4d</span>, <span style=color:#ae81ff>0x44</span>, <span style=color:#ae81ff>0x5f</span>, <span style=color:#ae81ff>0x56</span>, <span style=color:#ae81ff>0x69</span>, <span style=color:#ae81ff>0x60</span>, <span style=color:#ae81ff>0x7b</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0x5</span>, <span style=color:#ae81ff>0xc</span>, <span style=color:#ae81ff>0x17</span>, <span style=color:#ae81ff>0x1e</span>, <span style=color:#ae81ff>0x21</span>, <span style=color:#ae81ff>0x28</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x3a</span>, <span style=color:#ae81ff>0xdd</span>, <span style=color:#ae81ff>0xd4</span>, <span style=color:#ae81ff>0xcf</span>, <span style=color:#ae81ff>0xc6</span>, <span style=color:#ae81ff>0xf9</span>, <span style=color:#ae81ff>0xf0</span>, <span style=color:#ae81ff>0xeb</span>, <span style=color:#ae81ff>0xe2</span>, <span style=color:#ae81ff>0x95</span>, <span style=color:#ae81ff>0x9c</span>, <span style=color:#ae81ff>0x87</span>, <span style=color:#ae81ff>0x8e</span>, <span style=color:#ae81ff>0xb1</span>, <span style=color:#ae81ff>0xb8</span>, <span style=color:#ae81ff>0xa3</span>, <span style=color:#ae81ff>0xaa</span>, <span style=color:#ae81ff>0xec</span>, <span style=color:#ae81ff>0xe5</span>, <span style=color:#ae81ff>0xfe</span>, <span style=color:#ae81ff>0xf7</span>, <span style=color:#ae81ff>0xc8</span>, <span style=color:#ae81ff>0xc1</span>, <span style=color:#ae81ff>0xda</span>, <span style=color:#ae81ff>0xd3</span>, <span style=color:#ae81ff>0xa4</span>, <span style=color:#ae81ff>0xad</span>, <span style=color:#ae81ff>0xb6</span>, <span style=color:#ae81ff>0xbf</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x89</span>, <span style=color:#ae81ff>0x92</span>, <span style=color:#ae81ff>0x9b</span>, <span style=color:#ae81ff>0x7c</span>, <span style=color:#ae81ff>0x75</span>, <span style=color:#ae81ff>0x6e</span>, <span style=color:#ae81ff>0x67</span>, <span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0x51</span>, <span style=color:#ae81ff>0x4a</span>, <span style=color:#ae81ff>0x43</span>, <span style=color:#ae81ff>0x34</span>, <span style=color:#ae81ff>0x3d</span>, <span style=color:#ae81ff>0x26</span>, <span style=color:#ae81ff>0x2f</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x19</span>, <span style=color:#ae81ff>0x2</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0xd7</span>, <span style=color:#ae81ff>0xde</span>, <span style=color:#ae81ff>0xc5</span>, <span style=color:#ae81ff>0xcc</span>, <span style=color:#ae81ff>0xf3</span>, <span style=color:#ae81ff>0xfa</span>, <span style=color:#ae81ff>0xe1</span>, <span style=color:#ae81ff>0xe8</span>, <span style=color:#ae81ff>0x9f</span>, <span style=color:#ae81ff>0x96</span>, <span style=color:#ae81ff>0x8d</span>, <span style=color:#ae81ff>0x84</span>, <span style=color:#ae81ff>0xbb</span>, <span style=color:#ae81ff>0xb2</span>, <span style=color:#ae81ff>0xa9</span>, <span style=color:#ae81ff>0xa0</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0x4e</span>, <span style=color:#ae81ff>0x55</span>, <span style=color:#ae81ff>0x5c</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0x6a</span>, <span style=color:#ae81ff>0x71</span>, <span style=color:#ae81ff>0x78</span>, <span style=color:#ae81ff>0xf</span>, <span style=color:#ae81ff>0x6</span>, <span style=color:#ae81ff>0x1d</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x2b</span>, <span style=color:#ae81ff>0x22</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x9a</span>, <span style=color:#ae81ff>0x93</span>, <span style=color:#ae81ff>0x88</span>, <span style=color:#ae81ff>0x81</span>, <span style=color:#ae81ff>0xbe</span>, <span style=color:#ae81ff>0xb7</span>, <span style=color:#ae81ff>0xac</span>, <span style=color:#ae81ff>0xa5</span>, <span style=color:#ae81ff>0xd2</span>, <span style=color:#ae81ff>0xdb</span>, <span style=color:#ae81ff>0xc0</span>, <span style=color:#ae81ff>0xc9</span>, <span style=color:#ae81ff>0xf6</span>, <span style=color:#ae81ff>0xff</span>, <span style=color:#ae81ff>0xe4</span>, <span style=color:#ae81ff>0xed</span>, <span style=color:#ae81ff>0xa</span>, <span style=color:#ae81ff>0x3</span>, <span style=color:#ae81ff>0x18</span>, <span style=color:#ae81ff>0x11</span>, <span style=color:#ae81ff>0x2e</span>, <span style=color:#ae81ff>0x27</span>, <span style=color:#ae81ff>0x3c</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x42</span>, <span style=color:#ae81ff>0x4b</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#ae81ff>0x59</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0x6f</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0x7d</span>, <span style=color:#ae81ff>0xa1</span>, <span style=color:#ae81ff>0xa8</span>, <span style=color:#ae81ff>0xb3</span>, <span style=color:#ae81ff>0xba</span>, <span style=color:#ae81ff>0x85</span>, <span style=color:#ae81ff>0x8c</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x9e</span>, <span style=color:#ae81ff>0xe9</span>, <span style=color:#ae81ff>0xe0</span>, <span style=color:#ae81ff>0xfb</span>, <span style=color:#ae81ff>0xf2</span>, <span style=color:#ae81ff>0xcd</span>, <span style=color:#ae81ff>0xc4</span>, <span style=color:#ae81ff>0xdf</span>, <span style=color:#ae81ff>0xd6</span>, <span style=color:#ae81ff>0x31</span>, <span style=color:#ae81ff>0x38</span>, <span style=color:#ae81ff>0x23</span>, <span style=color:#ae81ff>0x2a</span>, <span style=color:#ae81ff>0x15</span>, <span style=color:#ae81ff>0x1c</span>, <span style=color:#ae81ff>0x7</span>, <span style=color:#ae81ff>0xe</span>, <span style=color:#ae81ff>0x79</span>, <span style=color:#ae81ff>0x70</span>, <span style=color:#ae81ff>0x6b</span>, <span style=color:#ae81ff>0x62</span>, <span style=color:#ae81ff>0x5d</span>, <span style=color:#ae81ff>0x54</span>, <span style=color:#ae81ff>0x4f</span>, <span style=color:#ae81ff>0x46</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>MULTIPLICATION_BY_11 <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x1d</span>, <span style=color:#ae81ff>0x2c</span>, <span style=color:#ae81ff>0x27</span>, <span style=color:#ae81ff>0x3a</span>, <span style=color:#ae81ff>0x31</span>, <span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0x4e</span>, <span style=color:#ae81ff>0x45</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0x7f</span>, <span style=color:#ae81ff>0x62</span>, <span style=color:#ae81ff>0x69</span>, <span style=color:#ae81ff>0xb0</span>, <span style=color:#ae81ff>0xbb</span>, <span style=color:#ae81ff>0xa6</span>, <span style=color:#ae81ff>0xad</span>, <span style=color:#ae81ff>0x9c</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x8a</span>, <span style=color:#ae81ff>0x81</span>, <span style=color:#ae81ff>0xe8</span>, <span style=color:#ae81ff>0xe3</span>, <span style=color:#ae81ff>0xfe</span>, <span style=color:#ae81ff>0xf5</span>, <span style=color:#ae81ff>0xc4</span>, <span style=color:#ae81ff>0xcf</span>, <span style=color:#ae81ff>0xd2</span>, <span style=color:#ae81ff>0xd9</span>, <span style=color:#ae81ff>0x7b</span>, <span style=color:#ae81ff>0x70</span>, <span style=color:#ae81ff>0x6d</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0x57</span>, <span style=color:#ae81ff>0x5c</span>, <span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x4a</span>, <span style=color:#ae81ff>0x23</span>, <span style=color:#ae81ff>0x28</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x3e</span>, <span style=color:#ae81ff>0xf</span>, <span style=color:#ae81ff>0x4</span>, <span style=color:#ae81ff>0x19</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0xcb</span>, <span style=color:#ae81ff>0xc0</span>, <span style=color:#ae81ff>0xdd</span>, <span style=color:#ae81ff>0xd6</span>, <span style=color:#ae81ff>0xe7</span>, <span style=color:#ae81ff>0xec</span>, <span style=color:#ae81ff>0xf1</span>, <span style=color:#ae81ff>0xfa</span>, <span style=color:#ae81ff>0x93</span>, <span style=color:#ae81ff>0x98</span>, <span style=color:#ae81ff>0x85</span>, <span style=color:#ae81ff>0x8e</span>, <span style=color:#ae81ff>0xbf</span>, <span style=color:#ae81ff>0xb4</span>, <span style=color:#ae81ff>0xa9</span>, <span style=color:#ae81ff>0xa2</span>, <span style=color:#ae81ff>0xf6</span>, <span style=color:#ae81ff>0xfd</span>, <span style=color:#ae81ff>0xe0</span>, <span style=color:#ae81ff>0xeb</span>, <span style=color:#ae81ff>0xda</span>, <span style=color:#ae81ff>0xd1</span>, <span style=color:#ae81ff>0xcc</span>, <span style=color:#ae81ff>0xc7</span>, <span style=color:#ae81ff>0xae</span>, <span style=color:#ae81ff>0xa5</span>, <span style=color:#ae81ff>0xb8</span>, <span style=color:#ae81ff>0xb3</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0x89</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x9f</span>, <span style=color:#ae81ff>0x46</span>, <span style=color:#ae81ff>0x4d</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#ae81ff>0x5b</span>, <span style=color:#ae81ff>0x6a</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0x7c</span>, <span style=color:#ae81ff>0x77</span>, <span style=color:#ae81ff>0x1e</span>, <span style=color:#ae81ff>0x15</span>, <span style=color:#ae81ff>0x8</span>, <span style=color:#ae81ff>0x3</span>, <span style=color:#ae81ff>0x32</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x2f</span>, <span style=color:#ae81ff>0x8d</span>, <span style=color:#ae81ff>0x86</span>, <span style=color:#ae81ff>0x9b</span>, <span style=color:#ae81ff>0x90</span>, <span style=color:#ae81ff>0xa1</span>, <span style=color:#ae81ff>0xaa</span>, <span style=color:#ae81ff>0xb7</span>, <span style=color:#ae81ff>0xbc</span>, <span style=color:#ae81ff>0xd5</span>, <span style=color:#ae81ff>0xde</span>, <span style=color:#ae81ff>0xc3</span>, <span style=color:#ae81ff>0xc8</span>, <span style=color:#ae81ff>0xf9</span>, <span style=color:#ae81ff>0xf2</span>, <span style=color:#ae81ff>0xef</span>, <span style=color:#ae81ff>0xe4</span>, <span style=color:#ae81ff>0x3d</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x2b</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x11</span>, <span style=color:#ae81ff>0x1a</span>, <span style=color:#ae81ff>0x7</span>, <span style=color:#ae81ff>0xc</span>, <span style=color:#ae81ff>0x65</span>, <span style=color:#ae81ff>0x6e</span>, <span style=color:#ae81ff>0x73</span>, <span style=color:#ae81ff>0x78</span>, <span style=color:#ae81ff>0x49</span>, <span style=color:#ae81ff>0x42</span>, <span style=color:#ae81ff>0x5f</span>, <span style=color:#ae81ff>0x54</span>, <span style=color:#ae81ff>0xf7</span>, <span style=color:#ae81ff>0xfc</span>, <span style=color:#ae81ff>0xe1</span>, <span style=color:#ae81ff>0xea</span>, <span style=color:#ae81ff>0xdb</span>, <span style=color:#ae81ff>0xd0</span>, <span style=color:#ae81ff>0xcd</span>, <span style=color:#ae81ff>0xc6</span>, <span style=color:#ae81ff>0xaf</span>, <span style=color:#ae81ff>0xa4</span>, <span style=color:#ae81ff>0xb9</span>, <span style=color:#ae81ff>0xb2</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x88</span>, <span style=color:#ae81ff>0x95</span>, <span style=color:#ae81ff>0x9e</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0x4c</span>, <span style=color:#ae81ff>0x51</span>, <span style=color:#ae81ff>0x5a</span>, <span style=color:#ae81ff>0x6b</span>, <span style=color:#ae81ff>0x60</span>, <span style=color:#ae81ff>0x7d</span>, <span style=color:#ae81ff>0x76</span>, <span style=color:#ae81ff>0x1f</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x9</span>, <span style=color:#ae81ff>0x2</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x38</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x2e</span>, <span style=color:#ae81ff>0x8c</span>, <span style=color:#ae81ff>0x87</span>, <span style=color:#ae81ff>0x9a</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0xa0</span>, <span style=color:#ae81ff>0xab</span>, <span style=color:#ae81ff>0xb6</span>, <span style=color:#ae81ff>0xbd</span>, <span style=color:#ae81ff>0xd4</span>, <span style=color:#ae81ff>0xdf</span>, <span style=color:#ae81ff>0xc2</span>, <span style=color:#ae81ff>0xc9</span>, <span style=color:#ae81ff>0xf8</span>, <span style=color:#ae81ff>0xf3</span>, <span style=color:#ae81ff>0xee</span>, <span style=color:#ae81ff>0xe5</span>, <span style=color:#ae81ff>0x3c</span>, <span style=color:#ae81ff>0x37</span>, <span style=color:#ae81ff>0x2a</span>, <span style=color:#ae81ff>0x21</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x1b</span>, <span style=color:#ae81ff>0x6</span>, <span style=color:#ae81ff>0xd</span>, <span style=color:#ae81ff>0x64</span>, <span style=color:#ae81ff>0x6f</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0x79</span>, <span style=color:#ae81ff>0x48</span>, <span style=color:#ae81ff>0x43</span>, <span style=color:#ae81ff>0x5e</span>, <span style=color:#ae81ff>0x55</span>, <span style=color:#ae81ff>0x1</span>, <span style=color:#ae81ff>0xa</span>, <span style=color:#ae81ff>0x17</span>, <span style=color:#ae81ff>0x1c</span>, <span style=color:#ae81ff>0x2d</span>, <span style=color:#ae81ff>0x26</span>, <span style=color:#ae81ff>0x3b</span>, <span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x59</span>, <span style=color:#ae81ff>0x52</span>, <span style=color:#ae81ff>0x4f</span>, <span style=color:#ae81ff>0x44</span>, <span style=color:#ae81ff>0x75</span>, <span style=color:#ae81ff>0x7e</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0x68</span>, <span style=color:#ae81ff>0xb1</span>, <span style=color:#ae81ff>0xba</span>, <span style=color:#ae81ff>0xa7</span>, <span style=color:#ae81ff>0xac</span>, <span style=color:#ae81ff>0x9d</span>, <span style=color:#ae81ff>0x96</span>, <span style=color:#ae81ff>0x8b</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0xe9</span>, <span style=color:#ae81ff>0xe2</span>, <span style=color:#ae81ff>0xff</span>, <span style=color:#ae81ff>0xf4</span>, <span style=color:#ae81ff>0xc5</span>, <span style=color:#ae81ff>0xce</span>, <span style=color:#ae81ff>0xd3</span>, <span style=color:#ae81ff>0xd8</span>, <span style=color:#ae81ff>0x7a</span>, <span style=color:#ae81ff>0x71</span>, <span style=color:#ae81ff>0x6c</span>, <span style=color:#ae81ff>0x67</span>, <span style=color:#ae81ff>0x56</span>, <span style=color:#ae81ff>0x5d</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x4b</span>, <span style=color:#ae81ff>0x22</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0x34</span>, <span style=color:#ae81ff>0x3f</span>, <span style=color:#ae81ff>0xe</span>, <span style=color:#ae81ff>0x5</span>, <span style=color:#ae81ff>0x18</span>, <span style=color:#ae81ff>0x13</span>, <span style=color:#ae81ff>0xca</span>, <span style=color:#ae81ff>0xc1</span>, <span style=color:#ae81ff>0xdc</span>, <span style=color:#ae81ff>0xd7</span>, <span style=color:#ae81ff>0xe6</span>, <span style=color:#ae81ff>0xed</span>, <span style=color:#ae81ff>0xf0</span>, <span style=color:#ae81ff>0xfb</span>, <span style=color:#ae81ff>0x92</span>, <span style=color:#ae81ff>0x99</span>, <span style=color:#ae81ff>0x84</span>, <span style=color:#ae81ff>0x8f</span>, <span style=color:#ae81ff>0xbe</span>, <span style=color:#ae81ff>0xb5</span>, <span style=color:#ae81ff>0xa8</span>, <span style=color:#ae81ff>0xa3</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>MULTIPLICATION_BY_13 <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x0</span>, <span style=color:#ae81ff>0xd</span>, <span style=color:#ae81ff>0x1a</span>, <span style=color:#ae81ff>0x17</span>, <span style=color:#ae81ff>0x34</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x2e</span>, <span style=color:#ae81ff>0x23</span>, <span style=color:#ae81ff>0x68</span>, <span style=color:#ae81ff>0x65</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0x7f</span>, <span style=color:#ae81ff>0x5c</span>, <span style=color:#ae81ff>0x51</span>, <span style=color:#ae81ff>0x46</span>, <span style=color:#ae81ff>0x4b</span>, <span style=color:#ae81ff>0xd0</span>, <span style=color:#ae81ff>0xdd</span>, <span style=color:#ae81ff>0xca</span>, <span style=color:#ae81ff>0xc7</span>, <span style=color:#ae81ff>0xe4</span>, <span style=color:#ae81ff>0xe9</span>, <span style=color:#ae81ff>0xfe</span>, <span style=color:#ae81ff>0xf3</span>, <span style=color:#ae81ff>0xb8</span>, <span style=color:#ae81ff>0xb5</span>, <span style=color:#ae81ff>0xa2</span>, <span style=color:#ae81ff>0xaf</span>, <span style=color:#ae81ff>0x8c</span>, <span style=color:#ae81ff>0x81</span>, <span style=color:#ae81ff>0x96</span>, <span style=color:#ae81ff>0x9b</span>, <span style=color:#ae81ff>0xbb</span>, <span style=color:#ae81ff>0xb6</span>, <span style=color:#ae81ff>0xa1</span>, <span style=color:#ae81ff>0xac</span>, <span style=color:#ae81ff>0x8f</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0x95</span>, <span style=color:#ae81ff>0x98</span>, <span style=color:#ae81ff>0xd3</span>, <span style=color:#ae81ff>0xde</span>, <span style=color:#ae81ff>0xc9</span>, <span style=color:#ae81ff>0xc4</span>, <span style=color:#ae81ff>0xe7</span>, <span style=color:#ae81ff>0xea</span>, <span style=color:#ae81ff>0xfd</span>, <span style=color:#ae81ff>0xf0</span>, <span style=color:#ae81ff>0x6b</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0x71</span>, <span style=color:#ae81ff>0x7c</span>, <span style=color:#ae81ff>0x5f</span>, <span style=color:#ae81ff>0x52</span>, <span style=color:#ae81ff>0x45</span>, <span style=color:#ae81ff>0x48</span>, <span style=color:#ae81ff>0x3</span>, <span style=color:#ae81ff>0xe</span>, <span style=color:#ae81ff>0x19</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x37</span>, <span style=color:#ae81ff>0x3a</span>, <span style=color:#ae81ff>0x2d</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x6d</span>, <span style=color:#ae81ff>0x60</span>, <span style=color:#ae81ff>0x77</span>, <span style=color:#ae81ff>0x7a</span>, <span style=color:#ae81ff>0x59</span>, <span style=color:#ae81ff>0x54</span>, <span style=color:#ae81ff>0x43</span>, <span style=color:#ae81ff>0x4e</span>, <span style=color:#ae81ff>0x5</span>, <span style=color:#ae81ff>0x8</span>, <span style=color:#ae81ff>0x1f</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0x31</span>, <span style=color:#ae81ff>0x3c</span>, <span style=color:#ae81ff>0x2b</span>, <span style=color:#ae81ff>0x26</span>, <span style=color:#ae81ff>0xbd</span>, <span style=color:#ae81ff>0xb0</span>, <span style=color:#ae81ff>0xa7</span>, <span style=color:#ae81ff>0xaa</span>, <span style=color:#ae81ff>0x89</span>, <span style=color:#ae81ff>0x84</span>, <span style=color:#ae81ff>0x93</span>, <span style=color:#ae81ff>0x9e</span>, <span style=color:#ae81ff>0xd5</span>, <span style=color:#ae81ff>0xd8</span>, <span style=color:#ae81ff>0xcf</span>, <span style=color:#ae81ff>0xc2</span>, <span style=color:#ae81ff>0xe1</span>, <span style=color:#ae81ff>0xec</span>, <span style=color:#ae81ff>0xfb</span>, <span style=color:#ae81ff>0xf6</span>, <span style=color:#ae81ff>0xd6</span>, <span style=color:#ae81ff>0xdb</span>, <span style=color:#ae81ff>0xcc</span>, <span style=color:#ae81ff>0xc1</span>, <span style=color:#ae81ff>0xe2</span>, <span style=color:#ae81ff>0xef</span>, <span style=color:#ae81ff>0xf8</span>, <span style=color:#ae81ff>0xf5</span>, <span style=color:#ae81ff>0xbe</span>, <span style=color:#ae81ff>0xb3</span>, <span style=color:#ae81ff>0xa4</span>, <span style=color:#ae81ff>0xa9</span>, <span style=color:#ae81ff>0x8a</span>, <span style=color:#ae81ff>0x87</span>, <span style=color:#ae81ff>0x90</span>, <span style=color:#ae81ff>0x9d</span>, <span style=color:#ae81ff>0x6</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x1c</span>, <span style=color:#ae81ff>0x11</span>, <span style=color:#ae81ff>0x32</span>, <span style=color:#ae81ff>0x3f</span>, <span style=color:#ae81ff>0x28</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x6e</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0x79</span>, <span style=color:#ae81ff>0x5a</span>, <span style=color:#ae81ff>0x57</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x4d</span>, <span style=color:#ae81ff>0xda</span>, <span style=color:#ae81ff>0xd7</span>, <span style=color:#ae81ff>0xc0</span>, <span style=color:#ae81ff>0xcd</span>, <span style=color:#ae81ff>0xee</span>, <span style=color:#ae81ff>0xe3</span>, <span style=color:#ae81ff>0xf4</span>, <span style=color:#ae81ff>0xf9</span>, <span style=color:#ae81ff>0xb2</span>, <span style=color:#ae81ff>0xbf</span>, <span style=color:#ae81ff>0xa8</span>, <span style=color:#ae81ff>0xa5</span>, <span style=color:#ae81ff>0x86</span>, <span style=color:#ae81ff>0x8b</span>, <span style=color:#ae81ff>0x9c</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0xa</span>, <span style=color:#ae81ff>0x7</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x1d</span>, <span style=color:#ae81ff>0x3e</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0x62</span>, <span style=color:#ae81ff>0x6f</span>, <span style=color:#ae81ff>0x78</span>, <span style=color:#ae81ff>0x75</span>, <span style=color:#ae81ff>0x56</span>, <span style=color:#ae81ff>0x5b</span>, <span style=color:#ae81ff>0x4c</span>, <span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0x6c</span>, <span style=color:#ae81ff>0x7b</span>, <span style=color:#ae81ff>0x76</span>, <span style=color:#ae81ff>0x55</span>, <span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0x4f</span>, <span style=color:#ae81ff>0x42</span>, <span style=color:#ae81ff>0x9</span>, <span style=color:#ae81ff>0x4</span>, <span style=color:#ae81ff>0x13</span>, <span style=color:#ae81ff>0x1e</span>, <span style=color:#ae81ff>0x3d</span>, <span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x27</span>, <span style=color:#ae81ff>0x2a</span>, <span style=color:#ae81ff>0xb1</span>, <span style=color:#ae81ff>0xbc</span>, <span style=color:#ae81ff>0xab</span>, <span style=color:#ae81ff>0xa6</span>, <span style=color:#ae81ff>0x85</span>, <span style=color:#ae81ff>0x88</span>, <span style=color:#ae81ff>0x9f</span>, <span style=color:#ae81ff>0x92</span>, <span style=color:#ae81ff>0xd9</span>, <span style=color:#ae81ff>0xd4</span>, <span style=color:#ae81ff>0xc3</span>, <span style=color:#ae81ff>0xce</span>, <span style=color:#ae81ff>0xed</span>, <span style=color:#ae81ff>0xe0</span>, <span style=color:#ae81ff>0xf7</span>, <span style=color:#ae81ff>0xfa</span>, <span style=color:#ae81ff>0xb7</span>, <span style=color:#ae81ff>0xba</span>, <span style=color:#ae81ff>0xad</span>, <span style=color:#ae81ff>0xa0</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x8e</span>, <span style=color:#ae81ff>0x99</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0xdf</span>, <span style=color:#ae81ff>0xd2</span>, <span style=color:#ae81ff>0xc5</span>, <span style=color:#ae81ff>0xc8</span>, <span style=color:#ae81ff>0xeb</span>, <span style=color:#ae81ff>0xe6</span>, <span style=color:#ae81ff>0xf1</span>, <span style=color:#ae81ff>0xfc</span>, <span style=color:#ae81ff>0x67</span>, <span style=color:#ae81ff>0x6a</span>, <span style=color:#ae81ff>0x7d</span>, <span style=color:#ae81ff>0x70</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0x5e</span>, <span style=color:#ae81ff>0x49</span>, <span style=color:#ae81ff>0x44</span>, <span style=color:#ae81ff>0xf</span>, <span style=color:#ae81ff>0x2</span>, <span style=color:#ae81ff>0x15</span>, <span style=color:#ae81ff>0x18</span>, <span style=color:#ae81ff>0x3b</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x21</span>, <span style=color:#ae81ff>0x2c</span>, <span style=color:#ae81ff>0xc</span>, <span style=color:#ae81ff>0x1</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x1b</span>, <span style=color:#ae81ff>0x38</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x22</span>, <span style=color:#ae81ff>0x2f</span>, <span style=color:#ae81ff>0x64</span>, <span style=color:#ae81ff>0x69</span>, <span style=color:#ae81ff>0x7e</span>, <span style=color:#ae81ff>0x73</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#ae81ff>0x5d</span>, <span style=color:#ae81ff>0x4a</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0xdc</span>, <span style=color:#ae81ff>0xd1</span>, <span style=color:#ae81ff>0xc6</span>, <span style=color:#ae81ff>0xcb</span>, <span style=color:#ae81ff>0xe8</span>, <span style=color:#ae81ff>0xe5</span>, <span style=color:#ae81ff>0xf2</span>, <span style=color:#ae81ff>0xff</span>, <span style=color:#ae81ff>0xb4</span>, <span style=color:#ae81ff>0xb9</span>, <span style=color:#ae81ff>0xae</span>, <span style=color:#ae81ff>0xa3</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x8d</span>, <span style=color:#ae81ff>0x9a</span>, <span style=color:#ae81ff>0x97</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>MULTIPLICATION_BY_14 <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x0</span>, <span style=color:#ae81ff>0xe</span>, <span style=color:#ae81ff>0x1c</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0x38</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x2a</span>, <span style=color:#ae81ff>0x70</span>, <span style=color:#ae81ff>0x7e</span>, <span style=color:#ae81ff>0x6c</span>, <span style=color:#ae81ff>0x62</span>, <span style=color:#ae81ff>0x48</span>, <span style=color:#ae81ff>0x46</span>, <span style=color:#ae81ff>0x54</span>, <span style=color:#ae81ff>0x5a</span>, <span style=color:#ae81ff>0xe0</span>, <span style=color:#ae81ff>0xee</span>, <span style=color:#ae81ff>0xfc</span>, <span style=color:#ae81ff>0xf2</span>, <span style=color:#ae81ff>0xd8</span>, <span style=color:#ae81ff>0xd6</span>, <span style=color:#ae81ff>0xc4</span>, <span style=color:#ae81ff>0xca</span>, <span style=color:#ae81ff>0x90</span>, <span style=color:#ae81ff>0x9e</span>, <span style=color:#ae81ff>0x8c</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0xa8</span>, <span style=color:#ae81ff>0xa6</span>, <span style=color:#ae81ff>0xb4</span>, <span style=color:#ae81ff>0xba</span>, <span style=color:#ae81ff>0xdb</span>, <span style=color:#ae81ff>0xd5</span>, <span style=color:#ae81ff>0xc7</span>, <span style=color:#ae81ff>0xc9</span>, <span style=color:#ae81ff>0xe3</span>, <span style=color:#ae81ff>0xed</span>, <span style=color:#ae81ff>0xff</span>, <span style=color:#ae81ff>0xf1</span>, <span style=color:#ae81ff>0xab</span>, <span style=color:#ae81ff>0xa5</span>, <span style=color:#ae81ff>0xb7</span>, <span style=color:#ae81ff>0xb9</span>, <span style=color:#ae81ff>0x93</span>, <span style=color:#ae81ff>0x9d</span>, <span style=color:#ae81ff>0x8f</span>, <span style=color:#ae81ff>0x81</span>, <span style=color:#ae81ff>0x3b</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x27</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0x3</span>, <span style=color:#ae81ff>0xd</span>, <span style=color:#ae81ff>0x1f</span>, <span style=color:#ae81ff>0x11</span>, <span style=color:#ae81ff>0x4b</span>, <span style=color:#ae81ff>0x45</span>, <span style=color:#ae81ff>0x57</span>, <span style=color:#ae81ff>0x59</span>, <span style=color:#ae81ff>0x73</span>, <span style=color:#ae81ff>0x7d</span>, <span style=color:#ae81ff>0x6f</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0xad</span>, <span style=color:#ae81ff>0xa3</span>, <span style=color:#ae81ff>0xb1</span>, <span style=color:#ae81ff>0xbf</span>, <span style=color:#ae81ff>0x95</span>, <span style=color:#ae81ff>0x9b</span>, <span style=color:#ae81ff>0x89</span>, <span style=color:#ae81ff>0x87</span>, <span style=color:#ae81ff>0xdd</span>, <span style=color:#ae81ff>0xd3</span>, <span style=color:#ae81ff>0xc1</span>, <span style=color:#ae81ff>0xcf</span>, <span style=color:#ae81ff>0xe5</span>, <span style=color:#ae81ff>0xeb</span>, <span style=color:#ae81ff>0xf9</span>, <span style=color:#ae81ff>0xf7</span>, <span style=color:#ae81ff>0x4d</span>, <span style=color:#ae81ff>0x43</span>, <span style=color:#ae81ff>0x51</span>, <span style=color:#ae81ff>0x5f</span>, <span style=color:#ae81ff>0x75</span>, <span style=color:#ae81ff>0x7b</span>, <span style=color:#ae81ff>0x69</span>, <span style=color:#ae81ff>0x67</span>, <span style=color:#ae81ff>0x3d</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x21</span>, <span style=color:#ae81ff>0x2f</span>, <span style=color:#ae81ff>0x5</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x19</span>, <span style=color:#ae81ff>0x17</span>, <span style=color:#ae81ff>0x76</span>, <span style=color:#ae81ff>0x78</span>, <span style=color:#ae81ff>0x6a</span>, <span style=color:#ae81ff>0x64</span>, <span style=color:#ae81ff>0x4e</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x52</span>, <span style=color:#ae81ff>0x5c</span>, <span style=color:#ae81ff>0x6</span>, <span style=color:#ae81ff>0x8</span>, <span style=color:#ae81ff>0x1a</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x3e</span>, <span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x22</span>, <span style=color:#ae81ff>0x2c</span>, <span style=color:#ae81ff>0x96</span>, <span style=color:#ae81ff>0x98</span>, <span style=color:#ae81ff>0x8a</span>, <span style=color:#ae81ff>0x84</span>, <span style=color:#ae81ff>0xae</span>, <span style=color:#ae81ff>0xa0</span>, <span style=color:#ae81ff>0xb2</span>, <span style=color:#ae81ff>0xbc</span>, <span style=color:#ae81ff>0xe6</span>, <span style=color:#ae81ff>0xe8</span>, <span style=color:#ae81ff>0xfa</span>, <span style=color:#ae81ff>0xf4</span>, <span style=color:#ae81ff>0xde</span>, <span style=color:#ae81ff>0xd0</span>, <span style=color:#ae81ff>0xc2</span>, <span style=color:#ae81ff>0xcc</span>, <span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x4f</span>, <span style=color:#ae81ff>0x5d</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0x79</span>, <span style=color:#ae81ff>0x77</span>, <span style=color:#ae81ff>0x65</span>, <span style=color:#ae81ff>0x6b</span>, <span style=color:#ae81ff>0x31</span>, <span style=color:#ae81ff>0x3f</span>, <span style=color:#ae81ff>0x2d</span>, <span style=color:#ae81ff>0x23</span>, <span style=color:#ae81ff>0x9</span>, <span style=color:#ae81ff>0x7</span>, <span style=color:#ae81ff>0x15</span>, <span style=color:#ae81ff>0x1b</span>, <span style=color:#ae81ff>0xa1</span>, <span style=color:#ae81ff>0xaf</span>, <span style=color:#ae81ff>0xbd</span>, <span style=color:#ae81ff>0xb3</span>, <span style=color:#ae81ff>0x99</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x85</span>, <span style=color:#ae81ff>0x8b</span>, <span style=color:#ae81ff>0xd1</span>, <span style=color:#ae81ff>0xdf</span>, <span style=color:#ae81ff>0xcd</span>, <span style=color:#ae81ff>0xc3</span>, <span style=color:#ae81ff>0xe9</span>, <span style=color:#ae81ff>0xe7</span>, <span style=color:#ae81ff>0xf5</span>, <span style=color:#ae81ff>0xfb</span>, <span style=color:#ae81ff>0x9a</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x86</span>, <span style=color:#ae81ff>0x88</span>, <span style=color:#ae81ff>0xa2</span>, <span style=color:#ae81ff>0xac</span>, <span style=color:#ae81ff>0xbe</span>, <span style=color:#ae81ff>0xb0</span>, <span style=color:#ae81ff>0xea</span>, <span style=color:#ae81ff>0xe4</span>, <span style=color:#ae81ff>0xf6</span>, <span style=color:#ae81ff>0xf8</span>, <span style=color:#ae81ff>0xd2</span>, <span style=color:#ae81ff>0xdc</span>, <span style=color:#ae81ff>0xce</span>, <span style=color:#ae81ff>0xc0</span>, <span style=color:#ae81ff>0x7a</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0x68</span>, <span style=color:#ae81ff>0x42</span>, <span style=color:#ae81ff>0x4c</span>, <span style=color:#ae81ff>0x5e</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#ae81ff>0xa</span>, <span style=color:#ae81ff>0x4</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x18</span>, <span style=color:#ae81ff>0x32</span>, <span style=color:#ae81ff>0x3c</span>, <span style=color:#ae81ff>0x2e</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0xec</span>, <span style=color:#ae81ff>0xe2</span>, <span style=color:#ae81ff>0xf0</span>, <span style=color:#ae81ff>0xfe</span>, <span style=color:#ae81ff>0xd4</span>, <span style=color:#ae81ff>0xda</span>, <span style=color:#ae81ff>0xc8</span>, <span style=color:#ae81ff>0xc6</span>, <span style=color:#ae81ff>0x9c</span>, <span style=color:#ae81ff>0x92</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x8e</span>, <span style=color:#ae81ff>0xa4</span>, <span style=color:#ae81ff>0xaa</span>, <span style=color:#ae81ff>0xb8</span>, <span style=color:#ae81ff>0xb6</span>, <span style=color:#ae81ff>0xc</span>, <span style=color:#ae81ff>0x2</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x1e</span>, <span style=color:#ae81ff>0x34</span>, <span style=color:#ae81ff>0x3a</span>, <span style=color:#ae81ff>0x28</span>, <span style=color:#ae81ff>0x26</span>, <span style=color:#ae81ff>0x7c</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0x60</span>, <span style=color:#ae81ff>0x6e</span>, <span style=color:#ae81ff>0x44</span>, <span style=color:#ae81ff>0x4a</span>, <span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0x56</span>, <span style=color:#ae81ff>0x37</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x2b</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0xf</span>, <span style=color:#ae81ff>0x1</span>, <span style=color:#ae81ff>0x13</span>, <span style=color:#ae81ff>0x1d</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0x49</span>, <span style=color:#ae81ff>0x5b</span>, <span style=color:#ae81ff>0x55</span>, <span style=color:#ae81ff>0x7f</span>, <span style=color:#ae81ff>0x71</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0x6d</span>, <span style=color:#ae81ff>0xd7</span>, <span style=color:#ae81ff>0xd9</span>, <span style=color:#ae81ff>0xcb</span>, <span style=color:#ae81ff>0xc5</span>, <span style=color:#ae81ff>0xef</span>, <span style=color:#ae81ff>0xe1</span>, <span style=color:#ae81ff>0xf3</span>, <span style=color:#ae81ff>0xfd</span>, <span style=color:#ae81ff>0xa7</span>, <span style=color:#ae81ff>0xa9</span>, <span style=color:#ae81ff>0xbb</span>, <span style=color:#ae81ff>0xb5</span>, <span style=color:#ae81ff>0x9f</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x8d</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>IMixColumns</span>(state: array):
</span></span><span style=display:flex><span>    new_state <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array(state, dtype<span style=color:#f92672>=</span>int)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        a0, a1, a2, a3 <span style=color:#f92672>=</span> state[:, i]
</span></span><span style=display:flex><span>        new_state[<span style=color:#ae81ff>0</span>, i] <span style=color:#f92672>=</span> MULTIPLICATION_BY_14[a0] <span style=color:#f92672>^</span> MULTIPLICATION_BY_11[a1] <span style=color:#f92672>^</span> MULTIPLICATION_BY_13[a2] <span style=color:#f92672>^</span> MULTIPLICATION_BY_9[a3]
</span></span><span style=display:flex><span>        new_state[<span style=color:#ae81ff>1</span>, i] <span style=color:#f92672>=</span> MULTIPLICATION_BY_9[a0] <span style=color:#f92672>^</span> MULTIPLICATION_BY_14[a1] <span style=color:#f92672>^</span> MULTIPLICATION_BY_11[a2] <span style=color:#f92672>^</span> MULTIPLICATION_BY_13[a3]
</span></span><span style=display:flex><span>        new_state[<span style=color:#ae81ff>2</span>, i] <span style=color:#f92672>=</span> MULTIPLICATION_BY_13[a0] <span style=color:#f92672>^</span> MULTIPLICATION_BY_9[a1] <span style=color:#f92672>^</span> MULTIPLICATION_BY_14[a2] <span style=color:#f92672>^</span> MULTIPLICATION_BY_11[a3]
</span></span><span style=display:flex><span>        new_state[<span style=color:#ae81ff>3</span>, i] <span style=color:#f92672>=</span> MULTIPLICATION_BY_11[a0] <span style=color:#f92672>^</span> MULTIPLICATION_BY_13[a1] <span style=color:#f92672>^</span> MULTIPLICATION_BY_9[a2] <span style=color:#f92672>^</span> MULTIPLICATION_BY_14[a3]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new_state
</span></span></code></pre></div></div><style>.tabs input#tab-2-3:checked~.tab-content-2-3{display:block}</style><input type=radio class=tab-input name=tab-select-2 id=tab-2-3>
<label for=tab-2-3 class=tab-label>Decrypt</label><div class="tab-content tab-content-2-3"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt</span>(ciphertext: bytes, key: bytes, rounds: int):
</span></span><span style=display:flex><span>    key_state <span style=color:#f92672>=</span> ke<span style=color:#f92672>.</span>key_expension(key, rounds<span style=color:#f92672>=</span>rounds <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    round_key <span style=color:#f92672>=</span> key_state[<span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>:]
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> tostate(ciphertext)
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> addroundkey(state, round_key)
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> IShiftRows(state)
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> ISubBytes(state)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, rounds):
</span></span><span style=display:flex><span>        round_key <span style=color:#f92672>=</span> key_state[len(key_state) <span style=color:#f92672>-</span> (<span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) : len(key_state)<span style=color:#f92672>-</span> (<span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> i)]
</span></span><span style=display:flex><span>        state <span style=color:#f92672>=</span> addroundkey(state, round_key)
</span></span><span style=display:flex><span>        state <span style=color:#f92672>=</span> IMixColumns(state)
</span></span><span style=display:flex><span>        state <span style=color:#f92672>=</span> IShiftRows(state)
</span></span><span style=display:flex><span>        state <span style=color:#f92672>=</span> ISubBytes(state)
</span></span><span style=display:flex><span>    round_key <span style=color:#f92672>=</span> key_state[<span style=color:#ae81ff>0</span>: <span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> addroundkey(state, round_key)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> state
</span></span></code></pre></div></div></div><h2 id=conclusion>Conclusion<a href=#conclusion class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>On a vu comment fonctionne en interne le chiffrement AES. Cependant ici on a chiffer et déchiffer qu&rsquo;un bloc de 16 octets. Dans la réalité, on aura des textes bien plus long, ce qui fait donc intervenir l&rsquo;utilisation de différents modes en AES (modes ECB, modes CBC, modes, CTR etc &mldr;).
Ceci pose donc les bases du chiffrement AES et nous permettra d&rsquo;avancer sur les différents types d&rsquo;attaques auxquels il est confronté.</p><p>Merci, et à très bientôt.</p><h4 id=références>Références<a href=#r%c3%a9f%c3%a9rences class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p><cite>Advanced Encryption Standard</cite> <a href=https://csrc.nist.gov/csrc/media/publications/fips/197/final/documents/fips-197.pdf>https://csrc.nist.gov/csrc/media/publications/fips/197/final/documents/fips-197.pdf</a><br><cite>Block breakers </cite><a href=https://www.davidwong.fr/blockbreakers/aes.html>https://www.davidwong.fr/blockbreakers/aes.html</a><br><cite>coursAES</cite> <a href=https://www.di.ens.fr/~ferradi/coursAES.pdf>https://www.di.ens.fr/~ferradi/coursAES.pdf</a><br><cite>Cryptohack</cite> <a href=https://cryptohack.org/challenges/aes/>https://cryptohack.org/challenges/aes/</a><br><cite>Cryptanalyse de l&rsquo;AES à 5 tours</cite> <a href=https://perso.limos.fr/~axdurbet/media/Previous_work/projet_AES_5_tours.pdf>https://perso.limos.fr/~axdurbet/media/Previous_work/projet_AES_5_tours.pdf</a></p></div></article><div class="post-nav thin"><a class=next-post href=https://dilagluc.github.io/en/posts/2023/crypto/aes/square-attack-aes/><span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;Newer</span><br><span>Cryptanalyse intégrale sur AES à tours réduits: l'attaque dite carrée</span>
</a><a class=prev-post href=https://dilagluc.github.io/en/posts/2022/pwnyracing/pwnyracing/><span class=post-nav-label>Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>Pwnyracing: Chall01</span></a></div><div id=comments class=thin></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2025 <a href=https://dilagluc.github.io/>Blog</a>
&#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>dilag</a>&#183; Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>
&#183; Theme <a href=https://github.com/1bl4z3r/hermit-V2 target=_blank rel=noopener>Hermit-V2</a></p></footer><script async src=https://dilagluc.github.io/js/bundle.min.c7c384e4d29d192bbac6811ae4660bb01767194a5bea56baca77e8260f93ea16.js integrity="sha256-x8OE5NKdGSu6xoEa5GYLsBdnGUpb6la6ynfoJg+T6hY=" crossorigin=anonymous></script><script async src=https://dilagluc.github.io/js/link-share.min.24409a4f6e5537d70ffc55ec8f9192208d718678cb8638585342423020b37f39.js integrity="sha256-JECaT25VN9cP/FXsj5GSII1xhnjLhjhYU0JCMCCzfzk=" crossorigin=anonymous></script><script id=MathJax-script type=text/javascript async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js crossorigin=anonymous></script><script type=text/javascript id=MathJax-script-helper async src=https://dilagluc.github.io/js/mathjax-assistant.min.ca29e9d446b2a6cb6c6e3eb0d47e9693f5c306c146eaccb43047afbf31b07a6f.js integrity="sha256-yinp1Eaypstsbj6w1H6Wk/XDBsFG6sy0MEevvzGwem8=" crossorigin=anonymous></script></body></html>